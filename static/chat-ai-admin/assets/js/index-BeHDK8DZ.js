import{a4 as L,b as V,e as C,B as u,x as O,M as U,N as M,W as h,k as r,S as o,V as f,u as y,Y as v,a0 as D,a1 as J,a2 as T}from"./vue-chunks-DWnFCQSz.js";import{c as Y,i as E}from"./index-DIUiarE3.js";import{A as P}from"./avatar-input-C35niw6w.js";import{b as H,k as b,be as W,bh as $,B as j}from"../../index-UhR4yadr.js";import{t as z}from"./validate-8MtiUsxW.js";import{F as g,_ as G}from"./index-DzuDS3Yk.js";import"./index--Qvpscnx.js";import{I as K}from"./Input-D7W5TJDt.js";import{_ as Q}from"./TextArea-CpTIlaWe.js";import"./index-DzhuYAPB.js";import"./PlusOutlined-CeclvJCi.js";import"./index-BJ4SSG33.js";import"./partition-CNXo-yhR.js";import"./Trigger-DcWVD-r5.js";import"./Password-XreinKYD.js";import"./inputProps-CiDWLiIl.js";import"./index-kKxyythX.js";import"./colors-BiofrUQp.js";import"./CheckOutlined-B_iCQ6FL.js";import"./useRefs-CH9tJ50T.js";import"./collapseMotion-ByInPrfq.js";import"./FormItemContext-BJa1evck.js";import"./axios-Cm0UX6qg.js";import"./qs-De-rn6vz.js";import"./crypto-js-U6t3rvpm.js";import"./dayjs-BI1HIvBC.js";import"./isPlainObject-BeqP4IC7.js";import"./responsiveObserve-Bs6--9PQ.js";import"./QuestionCircleOutlined-CV_adx6X.js";import"./index-DmSlXGTl.js";import"./Search-BRb_v-2B.js";import"./SearchOutlined-bV5WeZB5.js";import"./statusUtils--roYFmJe.js";import"./index-DXeZ5ybK.js";const X=s=>(J("data-v-20603eee"),s=s(),T(),s),Z={class:"add-library-page"},ee={class:"form-box"},ae=X(()=>h("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),te={__name:"index",setup(s){b.config({duration:2});const m=L(),l=V(()=>1),x=g.useForm,n=C(!1),A=l.value==0?W:$,e=u({type:l.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:A,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:l.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),q=u({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:I,validateInfos:d}=x(e,q),k=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},S=()=>{m.back()},w=()=>{I().then(()=>{N()}).catch(a=>{})},N=()=>{let a=new FormData,t=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",t.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(z(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),n.value=!0,Y(a).then(_=>{b.success("创建成功"),B(_.data.id)}).catch(()=>{n.value=!1})},B=a=>{E({id:a}).then(t=>{n.value=!1,m.replace({path:"/public-library/config",query:{library_id:t.data.id,library_key:t.data.library_key}})}).catch(()=>{n.value=!1})};return O(()=>{}),(a,t)=>{const _=K,p=G,F=Q,c=j,R=g;return U(),M("div",Z,[h("div",ee,[r(R,{"label-col":{span:5}},{default:o(()=>[r(p,f({ref:"name",label:"知识库名称"},y(d).library_name),{default:o(()=>[r(_,{value:e.library_name,"onUpdate:value":t[0]||(t[0]=i=>e.library_name=i),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),r(p,{label:"知识库简介"},{default:o(()=>[r(F,{value:e.library_intro,"onUpdate:value":t[1]||(t[1]=i=>e.library_intro=i),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(p,f({ref:"name",label:"知识库封面"},y(d).avatar),{default:o(()=>[r(P,{value:e.avatar,"onUpdate:value":t[2]||(t[2]=i=>e.avatar=i),onChange:k},null,8,["value"]),ae]),_:1},16),r(p,{"wrapper-col":{span:14,offset:4}},{default:o(()=>[r(c,{onClick:S},{default:o(()=>[v("取 消")]),_:1}),r(c,{type:"primary",style:{"margin-left":"16px"},loading:n.value,onClick:D(w,["prevent"])},{default:o(()=>[v("下一步")]),_:1},8,["loading"])]),_:1})]),_:1})])])}}},Me=H(te,[["__scopeId","data-v-20603eee"]]);export{Me as default};
