import{k as W,b as I,d as j,bs as Z,B as G,bt as K,bu as X,bv as tt}from"../../index-BYXP5-K6.js";import{e as g,B as L,x as N,w as et,M as u,N as c,W as t,k as o,S as b,F as z,a0 as F,u as E,Q as B,Y as x,Z as _,a3 as st,a7 as M,a1 as R,a2 as T,a4 as J}from"./vue-chunks-DKljrDvA.js";import{a as y}from"./dayjs-BpZi_McX.js";import{a as at,_ as ot}from"./RadioButton-D6KxmP_c.js";import{R as nt}from"./dayjs-CMMYMRu0.js";import{_ as lt}from"./index-h0nX1Hl6.js";import{S as it,a as ct}from"./index-ChLzCBr1.js";import{_ as dt}from"./index-ifJinQLe.js";import{_ as _t,a as rt}from"./index-DHPFv2fi.js";import"./axios-BZ84_VUH.js";import"./qs-DB0tj3pA.js";import"./crypto-js-fJpLWOEv.js";import"./FormItemContext-BbeLgxF6.js";import"./Checkbox-DoUvt9dJ.js";import"./index-CX89AYWF.js";import"./index-DE8nMz1m.js";import"./colors-BsGfXzR0.js";import"./CheckOutlined-tNTNjiBd.js";import"./Trigger-DAizGHX4.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./shallowequal-CthuG9FU.js";import"./index-DxTO0j69.js";import"./move-BNsvENtF.js";import"./slide-C8pAsQDb.js";import"./index-2d7y8GiQ.js";import"./DownOutlined-BfzuAtqc.js";import"./SearchOutlined-BAHqMa3J.js";import"./index-CHnEDbAe.js";import"./useMaxLevel-C1O2TwYp.js";import"./collapseMotion-CxHtxgWr.js";import"./CaretDownFilled-BzXYTSEq.js";import"./index-Did3xK-p.js";import"./responsiveObserve-DRuL2_me.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-B7oz8JPj.js";import"./LeftOutlined-Dpm3sl41.js";import"./RightOutlined-D_XHCIbp.js";import"./index-C9HKvTtP.js";import"./index-CkWGTpL1.js";import"./index-CYLnLfoe.js";import"./dropdown-QXBOTlLU.js";import"./index-DcQhmA5K.js";import"./index-BNZqkHuq.js";import"./CaretDownOutlined-DGGt9FQx.js";import"./index-CcC8Vz_q.js";import"./Input-Bfzy8tJK.js";import"./inputProps-B3PFVydJ.js";import"./Search-1aGcXLAr.js";import"./isPlainObject-BRAWLrZZ.js";import"./TextArea-Dnm7usWJ.js";import"./Password-CPQYqxS0.js";const pt={class:"zm-date"},ut={class:"date-btn"},mt={class:"date-content"},vt={__name:"date",props:{datekey:{type:String,default:"1"}},emits:["dateChange"],setup(f,{emit:D}){const C=f,m=g(1),s=D;let $=L([{label:"今日",value:!0,key:2,start_time:y().startOf("day"),end_time:y().endOf("day")},{label:"昨日",value:!1,key:3,start_time:y().subtract(1,"day").startOf("day"),end_time:y().startOf("day").subtract(1,"millisecond")},{label:"近7日",value:!1,key:4,start_time:y().subtract(6,"day").startOf("day"),end_time:y().endOf("day").subtract(1,"millisecond")}]);const e=g(null),n=g(null),r=g([]),l=a=>a>=y().subtract(0,"day"),i=()=>{let a=m.value,p=null;$.forEach(d=>{d.key==a&&(p=d)}),p?(r.value=[p.start_time,p.end_time],e.value=p.start_time.format("YYYY-MM-DD"),n.value=p.end_time.format("YYYY-MM-DD")):(r.value=[],e.value=null,n.value=null),O()},Y=a=>{const p=y(a[0]).startOf("day");if(y(a[1]).endOf("day").diff(p,"days")>29)r.value[0]=a[0].startOf("day"),r.value[1]=p.add(29,"days").endOf("day"),e.value=r.value[0].format("YYYY-MM-DD"),n.value=r.value[1].format("YYYY-MM-DD"),W.error("最多只能选择30天");else{const k=y(a[0]).startOf("day").format("YYYY-MM-DD"),w=y(a[1]).endOf("day").format("YYYY-MM-DD");r.value=a,e.value=k,n.value=w}m.value=1,O()},O=()=>{s("dateChange",{start_date:e.value,end_date:n.value})};return N(()=>{m.value=parseInt(C.datekey),i()}),et(()=>C.datekey,(a,p)=>{m.value=parseInt(C.datekey.split("-")[0]),i()}),(a,p)=>{const d=at,k=ot,w=nt;return c(),u("div",pt,[t("div",ut,[o(k,{value:m.value,"onUpdate:value":p[0]||(p[0]=h=>m.value=h),onChange:i},{default:b(()=>[(c(!0),u(z,null,F(E($),h=>(c(),B(d,{class:"date-btn-button",value:h.key,key:h.key},{default:b(()=>[x(_(h.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),t("div",mt,[o(w,{value:r.value,"onUpdate:value":p[1]||(p[1]=h=>r.value=h),onChange:Y,format:"YYYY-MM-DD",disabledDate:l,allowClear:!1},null,8,["value"])])])}}},S=f=>(R("data-v-39a2df20"),f=f(),T(),f),ft={class:"feedbacks-log-content"},ht={class:"feedbacks-log-items"},bt=S(()=>t("div",{class:"feedbacks-log-label"},[t("span",null,"问题 ")],-1)),yt={class:"feedbacks-log-item"},kt={class:"feedbacks-log-items"},gt=S(()=>t("div",{class:"feedbacks-log-label"},[t("span",null,"回答 ")],-1)),xt={class:"feedbacks-log-item"},Ct={class:"feedbacks-log-items"},$t=S(()=>t("div",{class:"feedbacks-log-label"},[t("span",null,"反馈 ")],-1)),Yt={class:"feedbacks-log-item"},wt={key:0,class:"item-type"},Dt={key:1,class:"item-type"},Ot={class:"feedbacks-log-label"},Mt={class:"feedbacks-log-item"},qt={class:"quotes-box"},St={key:0,class:"document-content"},zt={key:1},Ft={class:"document-content"},It={class:"document-content"},jt=["onClick"],Lt={class:"feedbacks-log-items"},Nt=S(()=>t("div",{class:"feedbacks-log-label"},[t("span",null,"聊天模式 ")],-1)),Bt={class:"feedbacks-log-item"},Rt={key:0},Tt={key:1},At={key:2},Qt={class:"feedbacks-log-items"},Vt=S(()=>t("div",{class:"feedbacks-log-label"},[t("span",null,"使用模型 ")],-1)),Ut={class:"feedbacks-log-item"},Et={__name:"feedbacks-log-alert",setup(f,{expose:D}){const C=st(),m=g(!1),s=L({question:"",library:[],context_qa:[],cur_question:"",cur_answer:"",error:""}),$=()=>{m.value=!1},e=()=>{s.question="",s.library=[],s.context_qa=[],s.cur_question="",s.cur_answer="",s.error=""},n=l=>{e();for(const i in l)s[i]=l[i],i=="robot"&&(s[i]=JSON.parse(l[i])),i=="quotes"&&(s[i]=JSON.parse(l[i]));m.value=!0},r=l=>{C.push("/library/preview?id="+l.FileId)};return D({open:n}),(l,i)=>{const Y=j,O=lt;return c(),B(O,{class:"feedbacks-log-alert",open:m.value,"onUpdate:open":i[0]||(i[0]=a=>m.value=a),title:"反馈详情",placement:"right",width:"746px",closable:!1},{extra:b(()=>[t("span",{class:"close-btn",onClick:$},[o(E(Z))])]),default:b(()=>[t("div",ft,[t("div",ht,[bt,t("div",yt,[t("p",null,_(s.question),1)])]),t("div",kt,[gt,t("div",xt,[t("p",null,_(s.answer),1)])]),t("div",Ct,[$t,t("div",Yt,[s.type=="1"?(c(),u("div",wt,[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"like-active"}),x("点赞")])):M("",!0),s.type=="2"?(c(),u("div",Dt,[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"dislike-active"}),x("点踩")])):M("",!0),t("p",null,_(s.content),1)])]),(c(!0),u(z,null,F(s.quotes,(a,p)=>(c(),u("div",{class:"feedbacks-log-items",key:a.FileId},[t("div",Ot,[t("span",null,"参考内容"+_(p+1),1)]),t("div",Mt,[t("div",qt,[a.Type==1?(c(),u("div",St,_(a.Content),1)):a.Type==2?(c(),u("div",zt,[t("div",Ft,"Q："+_(a.Question),1),t("div",It,"A："+_(a.Answer),1)])):M("",!0),t("div",{class:"quotes-title",onClick:d=>r(a)},[o(Y,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"quotes"}),x(_(a.FileName),1)],8,jt)])])]))),128)),t("div",Lt,[Nt,t("div",Bt,[s.robot.chat_type=="1"?(c(),u("p",Rt,"仅知识库")):s.robot.chat_type=="2"?(c(),u("p",Tt,"直连")):s.robot.chat_type=="3"?(c(),u("p",At,"混合")):M("",!0)])]),t("div",Qt,[Vt,t("div",Ut,[t("p",null,_(s.robot.use_model)+"("+_(s.robot.corp_name)+")",1)])])])]),_:1},8,["open"])}}},Jt=I(Et,[["__scopeId","data-v-39a2df20"]]),A=f=>(R("data-v-0618887c"),f=f(),T(),f),Ht={class:"team-members-pages"},Pt={class:"total"},Wt=A(()=>t("div",{class:"label total-label"},"共计：",-1)),Zt={class:"total-num"},Gt={class:"set-model"},Kt=A(()=>t("div",{class:"label set-model-label"},"类型：",-1)),Xt={class:"set-model-body"},te={class:"set-date"},ee=A(()=>t("div",{class:"label set-date-label"},[t("span",null,"日期：")],-1)),se={class:"set-date-body"},ae={class:"set-reset"},oe={class:"list-box"},ne={class:"user-box"},le={class:"name-info"},ie={class:"user-name"},ce={class:"user-info"},de={key:0,class:"item-type"},_e={key:1,class:"item-type"},re={class:"item-content"},pe={class:"item-date"},ue={__name:"qa-feedback",setup(f){const D=g(null),C=J(),m=g("1"),s=C.query,$=g([{key:"all",id:"all",label:"全部类型",title:"全部类型"},{key:"1",id:"1",label:"点赞",title:"点赞"},{key:"2",id:"2",label:"点踩",title:"点踩"}]),e=L({robot_id:s.id,page:1,size:20,total:0,type:"all",start_date:"",end_date:""}),n=d=>{e.start_date=d.start_date,e.end_date=d.end_date,Y()},r=async d=>{const k=await K({id:d.id});D.value.open(k.data)},l=()=>{e.type="all",e.start_date="",e.end_date="",m.value="1-"+Math.random()},i=d=>{e.page=d.current,e.size=d.pageSize,a()},Y=()=>{e.page=1,a()},O=g([]),a=()=>{let d={robot_id:e.robot_id,page:e.page,size:e.size,start_date:e.start_date,end_date:e.end_date};e.type!="all"&&(d.type=e.type),X(d).then(k=>{let w=k.data.list;w.forEach(h=>{h.create_time=h.create_time>0?y(h.create_time*1e3).format("YYYY-MM-DD HH:mm"):"--",h.content=h.content?h.content:"--"}),O.value=w,e.total=+k.data.total})},p=d=>{e.type=d,Y()};return N(()=>{}),(d,k)=>{const w=ct,h=it,Q=G,V=dt,q=_t,U=j,P=rt;return c(),u("div",Ht,[o(V,{justify:"flex-end"},{default:b(()=>[t("div",Pt,[Wt,t("div",Zt,_(e.total)+"条",1)]),t("div",Gt,[Kt,t("div",Xt,[o(h,{value:e.type,"onUpdate:value":k[0]||(k[0]=v=>e.type=v),placeholder:"全部类型",onChange:p,style:{width:"130px"}},{default:b(()=>[(c(!0),u(z,null,F($.value,v=>(c(),B(w,{key:v.key,value:v.id},{default:b(()=>[t("span",null,_(v.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",te,[ee,t("div",se,[o(vt,{onDateChange:n,datekey:m.value},null,8,["datekey"])])]),t("div",ae,[o(Q,{onClick:l},{default:b(()=>[x("重置")]),_:1})])]),_:1}),t("div",oe,[o(P,{"data-source":O.value,pagination:e.total>e.size?{current:e.page,total:e.total,pageSize:e.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}:!1,onChange:i},{default:b(()=>[o(q,{title:"问答","data-index":"question",width:"411px"},{default:b(({record:v})=>[t("div",ne,[t("div",le,[t("div",ie,_(v.question),1),t("div",ce,_(v.answer),1)])])]),_:1}),o(q,{title:"回答反馈","data-index":"type",width:"160px"},{default:b(({record:v})=>[v.type=="1"?(c(),u("div",de,[o(U,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),x("点赞")])):M("",!0),v.type=="2"?(c(),u("div",_e,[o(U,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),x("点踩")])):M("",!0)]),_:1}),o(q,{title:"反馈内容","data-index":"content",width:"264px"},{default:b(({record:v})=>[t("div",re,_(v.content),1)]),_:1}),o(q,{title:"时间","data-index":"create_time",width:"200px"},{default:b(({record:v})=>[t("div",pe,_(v.create_time),1)]),_:1}),o(q,{title:"操作","data-index":"action",width:"88px"},{default:b(({record:v})=>[o(V,{gap:16,class:"action-box"},{default:b(()=>[o(Q,{type:"link",onClick:$e=>r(v)},{default:b(()=>[x("查看详情")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),o(Jt,{ref_key:"feedbacksLogAlertRef",ref:D},null,512)])}}},me=I(ue,[["__scopeId","data-v-0618887c"]]),H=f=>(R("data-v-646107c5"),f=f(),T(),f),ve={class:"user-model-page"},fe=H(()=>t("div",{class:"page-title"},"数据概览",-1)),he={class:"overview-box"},be={class:"item-info"},ye={class:"item-icon-content item-like"},ke={class:"item-icon-content item-dislike"},ge=H(()=>t("div",{class:"page-title"},"反馈记录",-1)),xe={class:"list-wrapper"},Ce={__name:"index",setup(f){const C=J().query,m=g([]),s=e=>{let n={title:"",id:0};switch(e){case"today_stats":n.title="今日",n.id=1;break;case"yesterday_stats":n.title="昨日",n.id=2;break;case"week_stats":n.title="近7日",n.id=3;break;case"total_stats":n.title="总计",n.id=4;break}return n},$=()=>{let e={robot_id:C.id};tt(e).then(n=>{const r=[];for(const l in n.data){const i=n.data[l];r.push({key:l,dislike:i.dislike,like_count:i.like_count,titleObj:s(l)})}m.value=r.sort((l,i)=>l.titleObj.id-i.titleObj.id)})};return N(()=>{$()}),(e,n)=>{const r=j;return c(),u("div",ve,[fe,t("div",he,[(c(!0),u(z,null,F(m.value,l=>(c(),u("div",{class:"item-box",key:l.titleObj.id},[t("div",be,_(l.titleObj.title),1),t("div",ye,[o(r,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),x(_(l.like_count),1)]),t("div",ke,[o(r,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),x(_(l.dislike),1)])]))),128))]),ge,t("div",xe,[o(me)])])}}},Cs=I(Ce,[["__scopeId","data-v-646107c5"]]);export{Cs as default};
