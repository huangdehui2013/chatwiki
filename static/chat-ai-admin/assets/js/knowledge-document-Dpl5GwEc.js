import{C as Vt}from"./cu-scroll-8SQNC6_m.js";import{aN as K,bC as Qt,aS as ue,aU as tt,bD as _e,bE as Yt,A as ct,b as be,bF as ge,k as ee,d as rt,M as oe,bG as Jt,f as dt,B as pt,bH as ye,bI as Wt,bB as Xt,e as Zt,bJ as Kt,bt as eo,L as to,bd as Ce,be as ve,E as oo,bK as ao,bL as no,bM as so,bN as lo,bO as io,aa as uo}from"../../index-CuFzRDH0.js";import{f as ot,e as y,k as e,a4 as Le,a5 as Pe,B as te,M as o,N as i,S as a,W as t,V as _o,u as D,a7 as c,Q as T,F as E,$ as ce,a6 as mt,Z as $,aa as Fe,Y as r,a1 as Ie,a2 as Ue,b as xe,x as co,D as ro,ai as po,G as at,a0 as Oe,H as mo}from"./vue-chunks-DkYK5AuX.js";import{a as nt}from"./dayjs-CHX5mXCJ.js";import{U as ft}from"./upload-input-C_1bYOZ7.js";import{t as st}from"./validate-8MtiUsxW.js";import{F as ke,_ as De}from"./index-CKa8nflF.js";import"./index-5PrSJtCq.js";import{I as we}from"./Input-DlD3j6GW.js";import"./index-NJlqtEGH.js";import{R as fo,_ as vo}from"./RadioButton-ouyuU7LQ.js";import{M as ho}from"./model-select-CidLVLk0.js";import{O as go}from"./open-grapg-modal-BRd59mAh.js";import{D as yo}from"./DownOutlined-xHwfZhzl.js";import{U as ko}from"./UpOutlined-CmeybyPL.js";import{_ as bo}from"./index-B58k5Ecy.js";import{S as Te,_ as Me}from"./index-B9b8kVtF.js";import{R as wo}from"./rename-modal-DxjRGuRF.js";import{_ as Co}from"./page-alert-Bt4HLQNk.js";import{C as xo}from"./index-CvnBYLiG.js";import{g as Oo,c as lt,d as $o,r as So,a as qo}from"./index-DtO8wbUi.js";import{u as it}from"./FormItemContext-CG4o3aCY.js";import{M as Fo}from"./MoreOutlined-B6i0Yk0c.js";import{_ as Lo,M as Po}from"./index-D2p2Kdi5.js";import"./index-DmWi8Hkf.js";import{D as Io}from"./dropdown-aM3tBgR4.js";import{g as Uo}from"./index-CR3o8wp3.js";import{S as Do}from"./index-YK7vZYdC.js";import{_ as To}from"./index-mQ-jomi6.js";import{P as Mo}from"./PlusOutlined-C1-JNsax.js";import{S as Ro}from"./SearchOutlined-2-sBVYkv.js";import{C as $e}from"./ClockCircleFilled-vGTbBwA5.js";import{S as No}from"./SyncOutlined-_wzD1Bbw.js";import{_ as Ho}from"./index-B3CceHui.js";import{_ as zo}from"./index-D2ta3gNn.js";import{_ as Eo}from"./index-q1RY3Bas.js";import{_ as Bo}from"./index-DVObnatt.js";import{a as jo}from"./index-CaI5udhb.js";import{_ as Go}from"./TextArea-DnYx9N6z.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-g-qVsYXK.js";import"./crypto-js-CsNcoEfj.js";import"./InboxOutlined-uzEUQpc-.js";import"./Trigger-qqJEyN1K.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-B3m2dvNk.js";import"./responsiveObserve-nm9aPAMw.js";import"./collapseMotion-D38MKU2V.js";import"./QuestionCircleOutlined-DySDEe_b.js";import"./index-DpON8wvi.js";import"./Search-BjDfM7wD.js";import"./inputProps-CIG3Q6HA.js";import"./Password-B-_rMC_p.js";import"./Checkbox-CHV8yuJS.js";import"./index-njT3lQ6A.js";import"./slide--PTaLm6c.js";import"./index-CNYsll_x.js";import"./CheckOutlined-Nu5wJEo2.js";import"./move-CfeIRdjT.js";import"./index-DncdWYWk.js";import"./index-_b6N6Mhe.js";import"./colors-TmzmwKXv.js";import"./shallowequal-CCVEH32S.js";import"./Dropdown-DNhcw7uk.js";import"./RightOutlined-C7Gymx4e.js";import"./DownloadOutlined-CpROJx0R.js";import"./index-D0OvhCrn.js";import"./useMaxLevel-iyEeLMuD.js";import"./CaretDownFilled-P6q1_Q4R.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-BL6rtvtT.js";import"./CaretDownOutlined-BxctymRA.js";const Se=()=>({format:String,showNow:_e(),showHour:_e(),showMinute:_e(),showSecond:_e(),use12Hours:_e(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:_e(),popupClassName:String,status:Yt()});function Ao(d){const g=Oo(d,K(K({},Se()),{order:{type:Boolean,default:!0}})),{TimePicker:w,RangePicker:S}=g,m=ot({name:"ATimePicker",inheritAttrs:!1,props:K(K(K(K({},lt()),$o()),Se()),{addon:{type:Function}}),slots:Object,setup(P,H){let{slots:q,expose:F,emit:f,attrs:_}=H;const C=P,N=it();Qt(!(q.addon||C.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const I=y();F({focus:()=>{var s;(s=I.value)===null||s===void 0||s.focus()},blur:()=>{var s;(s=I.value)===null||s===void 0||s.blur()}});const R=(s,z)=>{f("update:value",s),f("change",s,z),N.onFieldChange()},k=s=>{f("update:open",s),f("openChange",s)},x=s=>{f("focus",s)},X=s=>{f("blur",s),N.onFieldBlur()},h=s=>{f("ok",s)};return()=>{const{id:s=N.id.value}=C;return e(w,ue(ue(ue({},_),tt(C,["onUpdate:value","onUpdate:open"])),{},{id:s,dropdownClassName:C.popupClassName,mode:void 0,ref:I,renderExtraFooter:C.addon||q.addon||C.renderExtraFooter||q.renderExtraFooter,onChange:R,onOpenChange:k,onFocus:x,onBlur:X,onOk:h}),q)}}}),W=ot({name:"ATimeRangePicker",inheritAttrs:!1,props:K(K(K(K({},lt()),So()),Se()),{order:{type:Boolean,default:!0}}),slots:Object,setup(P,H){let{slots:q,expose:F,emit:f,attrs:_}=H;const C=P,N=y(),I=it();F({focus:()=>{var v;(v=N.value)===null||v===void 0||v.focus()},blur:()=>{var v;(v=N.value)===null||v===void 0||v.blur()}});const R=(v,j)=>{f("update:value",v),f("change",v,j),I.onFieldChange()},k=v=>{f("update:open",v),f("openChange",v)},x=v=>{f("focus",v)},X=v=>{f("blur",v),I.onFieldBlur()},h=(v,j)=>{f("panelChange",v,j)},s=v=>{f("ok",v)},z=(v,j,Q)=>{f("calendarChange",v,j,Q)};return()=>{const{id:v=I.id.value}=C;return e(S,ue(ue(ue({},_),tt(C,["onUpdate:open","onUpdate:value"])),{},{id:v,dropdownClassName:C.popupClassName,picker:"time",mode:void 0,ref:N,onChange:R,onOpenChange:k,onFocus:x,onBlur:X,onPanelChange:h,onOk:s,onCalendarChange:z}),q)}}});return{TimePicker:m,TimeRangePicker:W}}const{TimePicker:he,TimeRangePicker:qe}=Ao(qo),vt=K(he,{TimePicker:he,TimeRangePicker:qe,install:d=>(d.component(he.name,he),d.component(qe.name,qe),d)});var Vo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const Qo=Vo;function ut(d){for(var g=1;g<arguments.length;g++){var w=arguments[g]!=null?Object(arguments[g]):{},S=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(S=S.concat(Object.getOwnPropertySymbols(w).filter(function(m){return Object.getOwnPropertyDescriptor(w,m).enumerable}))),S.forEach(function(m){Yo(d,m,w[m])})}return d}function Yo(d,g,w){return g in d?Object.defineProperty(d,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[g]=w,d}var Re=function(g,w){var S=ut({},g,w.attrs);return e(ct,ut({},S,{icon:Qo}),null)};Re.displayName="CopyOutlined";Re.inheritAttrs=!1;const Jo=Re;var Wo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};const Xo=Wo;function _t(d){for(var g=1;g<arguments.length;g++){var w=arguments[g]!=null?Object(arguments[g]):{},S=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(S=S.concat(Object.getOwnPropertySymbols(w).filter(function(m){return Object.getOwnPropertyDescriptor(w,m).enumerable}))),S.forEach(function(m){Zo(d,m,w[m])})}return d}function Zo(d,g,w){return g in d?Object.defineProperty(d,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[g]=w,d}var Ne=function(g,w){var S=_t({},g,w.attrs);return e(ct,_t({},S,{icon:Xo}),null)};Ne.displayName="HourglassFilled";Ne.inheritAttrs=!1;const Ko=Ne,ea={class:"form-box"},ta={class:"upload-document-type-box"},oa=["onClick"],aa={class:"right-block"},na={class:"title-block"},sa={class:"title-text"},la={class:"desc"},ia={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(d,{expose:g,emit:w}){const S=Le(),m=Pe(),W=ke.useForm,P=y(!1),H=y("添加自定义文档"),q=d,F=te({library_id:m.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),f=y([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),_=h=>{F.qa_index_type=h},C=te({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:N,validate:I,validateInfos:R}=W(F,C),k=()=>{P.value=!0,N(),F.file_name="",F.is_qa_doc=0,F.qa_index_type=1,q.libraryInfo.type==2&&(F.is_qa_doc=1)},x=y(!1),X=()=>{I().then(()=>{let h={...Fe(F)};x.value=!0,ge(h).then(s=>{ee.success(`${H.value}成功`),P.value=!1,S.push("/library/preview?id="+s.data.file_ids[0])}).finally(()=>{x.value=!1})})};return g({add:k}),(h,s)=>{const z=we,v=De,j=fo,Q=vo,U=rt,b=ke,re=oe;return o(),i("div",null,[e(re,{open:P.value,"onUpdate:open":s[2]||(s[2]=B=>P.value=B),title:H.value,onOk:X,width:"472px",confirmLoading:x.value},{default:a(()=>[t("div",ea,[e(b,{layout:"vertical"},{default:a(()=>[e(v,_o({label:"文档名称"},D(R).file_name),{default:a(()=>[e(z,{type:"text",placeholder:"请输入文档名称",value:F.file_name,"onUpdate:value":s[0]||(s[0]=B=>F.file_name=B)},null,8,["value"])]),_:1},16),c("",!0),F.is_qa_doc==1?(o(),T(v,{key:1,label:"索引方式",required:""},{default:a(()=>[t("div",ta,[(o(!0),i(E,null,ce(f.value,B=>(o(),i("div",{class:mt(["type-item",{active:F.qa_index_type==B.value}]),key:B.value,onClick:ze=>_(B.value)},[t("div",aa,[t("div",na,[e(U,{name:F.qa_index_type==B.value?B.iconNameActive:B.iconName},null,8,["name"]),t("div",sa,$(B.title),1)]),t("div",la,$(B.desc),1)]),F.qa_index_type==B.value?(o(),T(U,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):c("",!0)],10,oa))),128))])]),_:1})):c("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},ua=be(ia,[["__scopeId","data-v-0fbc9294"]]),ae=d=>(Ie("data-v-64d599b8"),d=d(),Ue(),d),_a={class:"alert-box"},ca=ae(()=>t("div",null,[r(" 通过word或者EXce形式导入问答对，建议您参考"),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),r("  "),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),r("创建导入文档 ")],-1)),ra=ae(()=>t("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)),da={class:"upload-file-box"},pa={key:0,class:"hight-set"},ma={key:0,class:"set-box"},fa={class:"form-item"},va=ae(()=>t("div",{class:"form-item-label"},"问题所在列：",-1)),ha={class:"form-item-body"},ga={class:"form-item"},ya=ae(()=>t("div",{class:"form-item-label"},"相似问法所在列：",-1)),ka={class:"form-item-body"},ba={class:"form-item"},wa=ae(()=>t("div",{class:"form-item-label"},"答案所在列：",-1)),Ca={class:"form-item-body"},xa={key:1,class:"set-box"},Oa={class:"form-item"},$a=ae(()=>t("div",{class:"form-item-label"},"问题开始标识符：",-1)),Sa={class:"form-item-body"},qa={class:"form-item"},Fa=ae(()=>t("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),La={class:"form-item-body"},Pa={class:"form-item"},Ia=ae(()=>t("div",{class:"form-item-label"},"答案开始标识符：",-1)),Ua={class:"form-item-body"},Da={__name:"qa-upload-modal",emits:["ok"],setup(d,{expose:g,emit:w}){const S=Le(),W=Pe().query,P=y(!1),H=y(!1),q=y([]),F=w,f=y([]),_=te({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),C=y(!0),N=()=>{P.value=!0},I=()=>{let h=new FormData;q.value.forEach(s=>{h.append("library_files",s)}),Jt(h).then(s=>{let z=[];for(let v in s.data)z.push({lable:s.data[v],value:v});f.value=z})},R=()=>{if(q.value.length==0){ee.error("请选择文件");return}H.value=!0;let h=new FormData;h.append("library_id",W.id);let s=!1;q.value.forEach(z=>{(z.name.includes(".xlsx")||z.name.includes(".csv"))&&(s=!0),h.append("library_files",z)}),s?(h.append("question_column",_.question_column),h.append("answer_column",_.answer_column),_.similar_column&&h.append("similar_column",_.similar_column)):(h.append("question_lable",_.question_lable),h.append("answer_lable",_.answer_lable),h.append("similar_label",_.similar_label)),h.append("is_qa_doc",1),ge(h).then(z=>{F("ok"),P.value=!1,q.value=[],H.value=!1,s&&S.push("/library/document-segmentation?document_id="+z.data.file_ids[0])}).catch(()=>{H.value=!1})},k=()=>{q.value=[]},x=y(1),X=h=>{_.question_column=void 0,_.answer_column=void 0,_.similar_column=void 0,_.question_lable="问题：",_.answer_lable="答案：",_.similar_label="相似问题：",q.value=h,h&&h.length>0&&(h[0].type.includes(".document")?x.value=2:(x.value=1,I()))};return g({show:N}),(h,s)=>{const z=bo,v=Te,j=Me,Q=we,U=oe;return o(),i("div",null,[e(U,{width:680,open:P.value,"onUpdate:open":s[8]||(s[8]=b=>P.value=b),"confirm-loading":H.value,maskClosable:!1,title:"上传文档",onOk:R,onCancel:k},{default:a(()=>[t("div",_a,[e(z,{"show-icon":""},{message:a(()=>[ca,ra]),_:1})]),t("div",da,[e(ft,{type:2,value:q.value,"onUpdate:value":s[0]||(s[0]=b=>q.value=b),onChange:X},null,8,["value"])]),q.value.length>0?(o(),i("div",pa,[t("a",{onClick:s[1]||(s[1]=b=>C.value=!C.value)},[r("高级设置： "),C.value?(o(),T(D(ko),{key:1})):(o(),T(D(yo),{key:0}))]),C.value?(o(),i(E,{key:0},[x.value==1?(o(),i("div",ma,[t("div",fa,[va,t("div",ha,[e(j,{value:_.question_column,"onUpdate:value":s[2]||(s[2]=b=>_.question_column=b),placeholder:"请选择列名",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,ce(f.value,b=>(o(),T(v,{value:b.value,key:b.value},{default:a(()=>[r($(b.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",ga,[ya,t("div",ka,[e(j,{value:_.similar_column,"onUpdate:value":s[3]||(s[3]=b=>_.similar_column=b),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,ce(f.value,b=>(o(),T(v,{value:b.value,key:b.value},{default:a(()=>[r($(b.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",ba,[wa,t("div",Ca,[e(j,{value:_.answer_column,"onUpdate:value":s[4]||(s[4]=b=>_.answer_column=b),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(E,null,ce(f.value,b=>(o(),T(v,{value:b.value,key:b.value},{default:a(()=>[r($(b.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):c("",!0),x.value==2?(o(),i("div",xa,[t("div",Oa,[$a,t("div",Sa,[e(Q,{placeholder:"请输入标识符",value:_.question_lable,"onUpdate:value":s[5]||(s[5]=b=>_.question_lable=b)},null,8,["value"])])]),t("div",qa,[Fa,t("div",La,[e(Q,{placeholder:"请输入标识符",value:_.similar_label,"onUpdate:value":s[6]||(s[6]=b=>_.similar_label=b)},null,8,["value"])])]),t("div",Pa,[Ia,t("div",Ua,[e(Q,{placeholder:"请输入标识符",value:_.answer_lable,"onUpdate:value":s[7]||(s[7]=b=>_.answer_lable=b)},null,8,["value"])])])])):c("",!0)],64)):c("",!0)])):c("",!0)]),_:1},8,["open","confirm-loading"])])}}},Ta=be(Da,[["__scopeId","data-v-64d599b8"]]),Ma="/assets/img/guide-image-DSu20zRj.png",He=d=>(Ie("data-v-d94a3a33"),d=d(),Ue(),d),Ra={class:"container"},Na={class:"guide-content"},Ha=He(()=>t("img",{src:Ma,alt:"操作引导",class:"guide-image"},null,-1)),za={class:"content-box"},Ea=He(()=>t("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),Ba=He(()=>t("div",{class:"content-check"},"不再显示此提示",-1)),ja={__name:"guide-learning-tips",setup(d,{expose:g}){const w=dt(),S=y(!1),m=y(!1),W=y(""),P=()=>{setTimeout(()=>{S.value=!0},500)},H=()=>{w.setGuideLearningTips(m.value),S.value=!1},q=()=>{w.setGuideLearningTips(m.value),S.value=!1};return g({show:P}),(F,f)=>{const _=xo,C=pt,N=oe;return o(),i("div",Ra,[e(N,{open:S.value,"onUpdate:open":f[1]||(f[1]=I=>S.value=I),title:W.value,onOk:H,onCancel:q,width:"472px"},{footer:a(()=>[e(C,{type:"primary",onClick:H},{default:a(()=>[r("我知道了")]),_:1})]),default:a(()=>[t("div",Na,[Ha,t("div",za,[Ea,e(_,{checked:m.value,"onUpdate:checked":f[0]||(f[0]=I=>m.value=I)},{default:a(()=>[Ba]),_:1},8,["checked"])])])]),_:1},8,["open","title"])])}}},Ga=be(ja,[["__scopeId","data-v-d94a3a33"]]),Aa={__name:"edit-online-doc",emits:["ok"],setup(d,{expose:g,emit:w}){const S=w,m=te({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),W=y({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),P=y(!1),H=_=>{_=JSON.parse(JSON.stringify(_)),m.id=_.id||"",m.file_name=_.file_name||"",m.doc_auto_renew_frequency=+_.doc_auto_renew_frequency||1,_.doc_auto_renew_minute>0&&(m.doc_auto_renew_minute=ye(_.doc_auto_renew_minute)),P.value=!0},q=y(!1),F=y(null),f=()=>{F.value.validate().then(()=>{q.value=!0,Wt({...m,doc_auto_renew_minute:m.doc_auto_renew_minute?ye(m.doc_auto_renew_minute):0}).then(()=>{P.value=!1,q.value=!1,S("ok")})}).catch(()=>{q.value=!1})};return g({show:H}),(_,C)=>{const N=we,I=De,R=Te,k=Me,x=vt,X=ke,h=oe;return o(),i("div",null,[e(h,{open:P.value,"onUpdate:open":C[3]||(C[3]=s=>P.value=s),"confirm-loading":q.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:f},{default:a(()=>[e(X,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:F,model:m,rules:W.value},{default:a(()=>[e(I,{name:"file_name",label:"文件名称"},{default:a(()=>[e(N,{value:m.file_name,"onUpdate:value":C[0]||(C[0]=s=>m.file_name=s),placeholder:"请输入"},null,8,["value"])]),_:1}),e(I,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:a(()=>[e(k,{value:m.doc_auto_renew_frequency,"onUpdate:value":C[1]||(C[1]=s=>m.doc_auto_renew_frequency=s),style:{width:"100%"}},{default:a(()=>[e(R,{value:1},{default:a(()=>[r("不自动更新")]),_:1}),e(R,{value:2},{default:a(()=>[r("每天")]),_:1}),e(R,{value:3},{default:a(()=>[r("每3天")]),_:1}),e(R,{value:4},{default:a(()=>[r("每7天")]),_:1}),e(R,{value:5},{default:a(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),m.doc_auto_renew_frequency>1?(o(),T(I,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(x,{valueFormat:"HH:mm",value:m.doc_auto_renew_minute,"onUpdate:value":C[2]||(C[2]=s=>m.doc_auto_renew_minute=s),format:"HH:mm"},null,8,["value"])]),_:1})):c("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},V=d=>(Ie("data-v-9dddd452"),d=d(),Ue(),d),Va={class:"details-library-page"},Qa={class:"list-tools"},Ya={class:"tools-items"},Ja={class:"tool-item"},Wa={class:"dropdown-btn-menu"},Xa=V(()=>t("div",{class:"title"},"本地文档",-1)),Za={key:0,class:"desc"},Ka={key:1,class:"desc"},en={class:"dropdown-btn-menu"},tn=V(()=>t("div",{class:"title"},"在线数据",-1)),on=V(()=>t("div",{class:"desc"},"获取在线网页内容",-1)),an={class:"dropdown-btn-menu"},nn=V(()=>t("div",{class:"title"},"自定义文档",-1)),sn=V(()=>t("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1)),ln=V(()=>t("span",null,"添加内容",-1)),un=V(()=>t("span",null,"嵌入模型：",-1)),_n=V(()=>t("span",null,"生成知识图谱：",-1)),cn={class:"right-box"},rn={key:0,class:"status-box"},dn={class:"status-item"},pn=V(()=>t("div",{class:"status-label"},"已学习：",-1)),mn={class:"status-content"},fn={class:"status-item"},vn=V(()=>t("div",{class:"status-label"},"，未学习：",-1)),hn={class:"status-content content-tip"},gn={class:"status-item"},yn=V(()=>t("div",{class:"status-label"},"，学习失败：",-1)),kn={class:"status-content content-tip"},bn={key:1,class:"status-select-box"},wn={class:"tool-item"},Cn=V(()=>t("div",null,[t("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),t("p",null,"2、未学习的文档数据不会被检索到。")],-1)),xn={class:"list-content"},On={key:0,class:"doc-name-td"},$n=["href"],Sn=["onClick"],qn={key:0},Fn={key:1},Ln=["onClick"],Pn={key:0},In={key:1},Un={key:2,class:"url-remark"},Dn=["onClick"],Tn={key:0,class:"pdf-progress-box"},Mn={class:"progress-title"},Rn={class:"status-box"},Nn=["onClick"],Hn={class:"progress-bar"},zn={class:"num-box"},En={key:0,class:"status-tag running"},Bn={key:2,class:"status-tag running"},jn={key:3,class:"status-tag complete"},Gn={class:"status-tag status-error"},An=["onClick"],Vn={class:"status-tag status-error"},Qn={class:"status-tag"},Yn=["onClick"],Jn={key:7,class:"status-tag"},Wn={key:8,class:"status-tag running"},Xn={class:"status-tag error"},Zn={key:10,class:"status-tag cancel"},Kn={class:"status-tag"},es=["onClick"],ts={key:1,class:"status-tag running"},os={key:2,class:"status-tag complete"},as={class:"status-tag error"},ns=["onClick"],ss={class:"zm-line1 reason-text"},ls={key:4,class:"status-tag running"},is={class:"status-tag warning"},us={class:"reason-text"},_s=["onClick"],cs={key:0},rs={key:1},ds={key:0,class:"text-block"},ps={class:"time-content-box"},ms={key:0},fs={key:1},vs={key:2},hs={key:3},gs={key:4},ys={key:5,class:"ml4"},ks={key:6},bs=["onClick"],ws=V(()=>t("a",{class:"ml4 btn-hover-block"},"更新",-1)),Cs={key:1},xs={key:0},Os={key:1},$s=["onClick"],Ss=["onClick"],qs=["onClick"],Fs=V(()=>t("span",null,"删除",-1)),Ls={class:"upload-file-box"},Ps={class:"select-card-box"},Is=["onClick"],Us={class:"card-title"},Ds={key:0,class:"card-switch-box"},Ts={class:"card-desc"},Ms={key:0,class:"card-switch"},Rs={__name:"knowledge-document",setup(d){const{setStorage:g}=uo("localStorage"),w=Xt(),{changeGraphSwitch:S}=w,m=Zt(),W=xe(()=>{var l;return((l=m.companyInfo)==null?void 0:l.neo4j_status)=="true"}),P=xe(()=>{var l;return((l=m.companyInfo)==null?void 0:l.ali_ocr_switch)=="1"}),H=dt(),q=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"},{key:4,title:"阿里云OCR解析",icon:"ali-ocr",desc:"通过阿里云文档智能接口解析提取图片和文字"}],F=Pe(),f=Le(),_=F.query,C=y(!1),N=y(null),I=y(null),R=y(!1),k=y({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});te({selectedRowKeys:[]});const x=te({use_model:"",model_config_id:""}),X=(l,u)=>{let O=u.modelName,G=u.modelId;j.value.length>0?oe.confirm({title:`确定切换模型为${O}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){x.use_model=O,x.model_config_id=G,h()},onCancel(){}}):(x.use_model=O,x.model_config_id=G,h())},h=(l=!0,u=null)=>{ao({...Fe(k.value),use_model:x.use_model,model_config_id:x.model_config_id}).then(()=>{k.value.use_model=x.use_model,k.value.model_config_id=x.model_config_id,typeof u=="function"&&u(),l&&ee.success("保存成功")})},s=y([]),z=l=>{s.value=l,v()},v=()=>{if(!k.value.id){setTimeout(()=>{v()},100);return}if(s.value.length>0&&!k.value.use_model){let l=null,u=null;for(let O of s.value)if(O.model_define==="chatwiki"){l=O;for(let G of l.children)if(G.name==="text-embedding-v2"){u=G;break}break}l||(l=s.value[0],u=l.children[0]),l&&(x.use_model=u.name,x.model_config_id=u.model_config_id,h(!1))}},j=y([]),Q=te({learned_err_count:0,learned_count:0,learned_wait_count:0}),U=te({library_id:_.id,file_name:void 0,status:"",page:1,size:10,total:0}),b=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],re=y([]),B=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],ze=l=>{ne()},ht=l=>{U.page=l.current,U.size=l.pageSize,Y()},ne=()=>{U.page=1,Y()};let Ee=!1;const gt=({id:l})=>{j.value.length==1&&(Ee=!0),no({id:l}).then(()=>{Ee&&U.page>1&&U.page--,Y(),ee.success("删除成功")})},se=(l,u={})=>{if(l.status=="4")return f.push({path:"/library/document-segmentation",query:{document_id:l.id,page:U.page}});if(l.status=="3"&&k.value.type!=2)return ee.error("学习失败,不可预览");if(l.status=="0")return ee.error("转换中,稍候可预览");if(l.status=="6")return ee.error("获取中,不可预览");if(l.status=="7")return ee.error("获取失败,不可预览");f.push({name:"libraryPreview",query:{id:l.id,...u}})},Y=()=>{let l=Fe(U);l.status==0&&(l.status=""),C.value=!0,Kt(l).then(u=>{let O=u.data.info;!x.use_model&&x.use_model!=O.use_model&&(x.use_model=O.use_model,x.model_config_id=O.model_config_id),k.value={...O},R.value=O.graph_switch==1,O.graph_switch=="0"||!W.value?re.value=B.filter(J=>!["graph_status","graph_entity_count"].includes(J.key)):re.value=B;let G=u.data.list||[],Z=u.data.count_data||{};U.total=u.data.total,Q.learned_count=Z.learned_count,Q.learned_err_count=Z.learned_err_count,Q.learned_wait_count=Z.learned_wait_count;let le=!1;j.value=G.map(J=>(["1","6","0","5"].includes(J.status)&&(le=!0),J.file_size_str=eo(J.file_size),J.update_time=nt(J.update_time*1e3).format("YYYY-MM-DD HH:mm"),J.doc_last_renew_time_desc=J.doc_last_renew_time>0?nt(J.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",J)),le&&yt(),!le&&clearInterval(de.value)}).finally(()=>{C.value=!1})},de=y(null),yt=()=>{clearInterval(de.value),de.value=setInterval(()=>{Y()},1e3*5)},Be=y(null),kt=l=>{if(s.value.length==0){oe.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){f.push({path:"/user/model"})}});return}let{key:u}=l;u==1&&xt(),u==2&&bt(),u==3&&Be.value.add()},L=te({open:!1,urls:"",library_id:_.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(l,u)=>st(u)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),bt=()=>{L.open=!0,L.confirmLoading=!1,L.urls="",L.doc_auto_renew_minute="02:00",L.doc_auto_renew_frequency=1},je=y(null),wt=()=>{je.value.validate().then(()=>{L.confirmLoading=!0,ge({library_id:L.library_id,urls:JSON.stringify(st(L.urls)),doc_auto_renew_frequency:L.doc_auto_renew_frequency,doc_auto_renew_minute:ye(L.doc_auto_renew_minute),doc_type:2}).then(()=>{L.open=!1,L.confirmLoading=!1,ne()})}).catch(()=>{L.confirmLoading=!1})},Ct=()=>{L.open=!1},M=te({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),Ge=xe(()=>M.fileList.filter(l=>l.type==="application/pdf").length>0),Ae=y(null),xt=()=>{if(k.value.type==2){Ae.value.show();return}M.fileList=[],M.open=!0},Ot=()=>{M.fileList=[]},$t=l=>{M.fileList=l},St=()=>{if(N.value&&!H.getGuideLearningTips&&M.fileList.length>1&&N.value.show(),M.fileList.length==0){ee.error("请选择文件");return}M.confirmLoading=!0;let l=new FormData;l.append("library_id",U.library_id);let u=!1;M.fileList.forEach(O=>{(O.name.includes(".xlsx")||O.name.includes(".csv"))&&(u=!0),l.append("library_files",O)}),Ge.value&&l.append("pdf_parse_type",M.pdf_parse_type),ge(l).then(O=>{Y(),M.open=!1,M.fileList=[],M.confirmLoading=!1,u&&O.data.file_ids.length==1&&f.push("/library/document-segmentation?document_id="+O.data.file_ids[0])}).catch(()=>{M.confirmLoading=!1})},Ve=y(null),qt=l=>{Ve.value.show(l)},Ft=l=>{f.push({path:"/library/document-segmentation",query:{document_id:l.id}})},Qe=l=>{so({id:l.id}).then(()=>{Y()})},Lt=()=>{if(R.value){R.value=!1;let l={graph_model_config_id:k.value.graph_model_config_id,graph_use_model:k.value.graph_use_model};if((!l.graph_model_config_id||!l.graph_use_model)&&s.value.length>0){let O=s.value[0].children[0];l.graph_use_model=O.name,l.graph_model_config_id=O.model_config_id}I.value.show(l)}else k.value.graph_switch=0,h(!1,()=>{Y(),S(0)})},Pt=l=>{R.value=!0,k.value.graph_switch=1,k.value.graph_model_config_id=l.graph_model_config_id,k.value.graph_use_model=l.graph_use_model,h(!1,()=>{Y(),S(1)})},It=l=>{if(l.key==4&&!P.value)return!1;M.pdf_parse_type=l.key},Ut=()=>{window.open("#/user/aliocr")},Ye=y(null),Je=l=>{Ye.value.show({...l})},Dt=l=>{lo({id:l.id}).then(u=>{ee.success("更新成功"),Y()})},Tt=l=>{oe.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){io({id:l.id}).then(u=>{ee.success("取消成功"),Y()})}})},Mt=l=>{g("graph:autoOpenFileId",l.id),f.push({path:"/library/details/knowledge-graph",query:{id:_.id}})};return co(()=>{_.page&&(U.page=+_.page),Y()}),ro(()=>{de.value&&clearInterval(de.value)}),(l,u)=>{const O=rt,G=Ho,Z=Lo,le=Po,J=pt,We=Io,Rt=zo,ie=Te,Xe=Me,Nt=we,Ht=Eo,zt=Uo,fe=Do,pe=Bo,Ze=To,Et=jo,Bt=Vt,me=De,Ke=ke,et=oe,jt=Go,Gt=vt,At=po("copy");return o(),i("div",Va,[e(Bt,{scrollbar:!1},{default:a(()=>[t("div",Qa,[t("div",Ya,[t("div",Ja,[e(We,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:a(()=>[e(le,{onClick:kt},{default:a(()=>[(o(),T(Z,{key:1},{default:a(()=>[t("div",Wa,[e(G,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"doc-icon"}),Xa]),_:1}),k.value.type==2?(o(),i("div",Za," 上传本地 docx/csv/xlsx 等格式文件 ")):(o(),i("div",Ka," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),k.value.type!=2?(o(),T(Z,{key:2},{default:a(()=>[t("div",en,[e(G,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"link-icon"}),tn]),_:1}),on])]),_:1})):c("",!0),(o(),T(Z,{key:3},{default:a(()=>[t("div",an,[e(G,{class:"title-block",gap:4},{default:a(()=>[e(O,{name:"cu-doc-icon"}),nn]),_:1}),sn])]),_:1}))]),_:1})]),default:a(()=>[e(J,{type:"primary"},{icon:a(()=>[e(D(Mo))]),default:a(()=>[ln]),_:1})]),_:1})]),at(e(G,{align:"center",class:"tool-item custom-select-box"},{default:a(()=>[un,e(ho,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:x.use_model,modeId:x.model_config_id,style:{width:"240px"},onChange:X,onLoaded:z},null,8,["modeName","modeId"])]),_:1},512),[[mo,!1]]),W.value?(o(),T(G,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:a(()=>[_n,e(Rt,{checked:R.value,"onUpdate:checked":u[0]||(u[0]=p=>R.value=p),onChange:Lt,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):c("",!0)]),t("div",cn,[k.value.type==0?(o(),i("div",rn,[t("div",dn,[pn,t("div",mn,$(Q.learned_count),1)]),t("div",fn,[vn,t("div",hn,$(Q.learned_wait_count),1)]),t("div",gn,[yn,t("div",kn,$(Q.learned_err_count),1)])])):c("",!0),k.value.type==0?(o(),i("div",bn,[e(Xe,{value:U.status,"onUpdate:value":u[1]||(u[1]=p=>U.status=p),style:{width:"150px"},placeholder:"请选择",onChange:ze},{default:a(()=>[(o(),i(E,null,ce(b,p=>e(ie,{key:p.id,value:p.id},{default:a(()=>[r($(p.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):c("",!0),t("div",wn,[e(Nt,{style:{width:"282px"},value:U.file_name,"onUpdate:value":u[2]||(u[2]=p=>U.file_name=p),placeholder:"请输入文档名称搜索",onChange:ne},{suffix:a(()=>[e(D(Ro),{onClick:ne,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),k.value.type==0?(o(),T(Co,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:a(()=>[Cn]),_:1})):c("",!0),t("div",xn,[e(Et,{columns:re.value,"data-source":j.value,scroll:{x:1e3},"row-key":"id",pagination:{current:U.page,total:U.total,pageSize:U.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:ht},{bodyCell:a(({column:p,record:n})=>[p.key==="file_name"?(o(),i("div",On,[n.doc_type==2?(o(),T(Ht,{key:0,title:null},{content:a(()=>[r(" 原链接："),t("a",{href:n.doc_url,target:"_blank"},$(n.doc_url),9,$n),at(e(D(Jo),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[At,`${n.doc_url}`]])]),default:a(()=>[t("a",{onClick:A=>se(n)},[["5","6","7"].includes(n.status)?(o(),i("span",qn,$(n.doc_url),1)):(o(),i("span",Fn,$(n.file_name),1))],8,Sn)]),_:2},1024)):(o(),i("a",{key:1,onClick:A=>se(n)},[["5","6","7"].includes(n.status)?(o(),i("span",Pn,$(n.doc_url),1)):(o(),i("span",In,$(n.file_name),1))],8,Ln)),n.doc_type==2&&n.remark?(o(),i("div",Un," 备注："+$(n.remark),1)):c("",!0)])):c("",!0),p.key==="graph_entity_count"?(o(),i("a",{key:1,onClick:A=>Mt(n)},$(n.graph_entity_count),9,Dn)):c("",!0),p.key==="status"?(o(),i(E,{key:2},[n.file_ext=="pdf"&&n.pdf_parse_type>=2?(o(),i(E,{key:0},[n.status==0?(o(),i("div",Tn,[t("div",Mn,[t("span",Rn,[e(D(to)),r("文档解析中")]),t("a",{onClick:A=>Tt(n)},"取消",8,Nn)]),t("div",Hn,[e(zt,{size:"small",class:"progress-bar-box",percent:parseInt(n.ocr_pdf_index/n.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),t("div",zn,$(n.ocr_pdf_index)+" / "+$(n.ocr_pdf_total),1)])])):c("",!0)],64)):(o(),i(E,{key:1},[n.status==0?(o(),i("span",En,[e(fe,{size:"small"}),r(" 转换中")])):c("",!0)],64)),n.status==1?(o(),i("span",Bn,[e(fe,{size:"small"}),r(" 学习中")])):c("",!0),n.status==2?(o(),i("span",jn,[e(D(Ce)),r(" 学习完成")])):c("",!0),n.status==3?(o(),T(pe,{key:4,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",Gn,[e(D(ve)),r(" 转换失败")]),k.value.type==2?(o(),i("a",{key:0,class:"ml8",onClick:A=>se(n)},"学习",8,An)):c("",!0)])]),_:2},1024)):c("",!0),n.status==8?(o(),T(pe,{key:5,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",Vn,[e(D(ve)),r(" 转化异常")])])]),_:2},1024)):c("",!0),n.status==4?(o(),i(E,{key:6},[t("span",Qn,[e(D($e)),r(" 待学习")]),t("a",{class:"ml8",onClick:A=>se(n)},"学习",8,Yn)],64)):c("",!0),n.status==5?(o(),i("span",Jn,[e(D($e)),r(" 待获取")])):c("",!0),n.status==6?(o(),i("span",Wn,[e(fe,{size:"small"}),r(" 获取中")])):c("",!0),n.status==7?(o(),T(pe,{key:9,placement:"top"},{title:a(()=>[t("span",null,$(n.errmsg),1)]),default:a(()=>[t("span",Xn,[e(D(ve)),r(" 获取失败")])]),_:2},1024)):c("",!0),n.status==9?(o(),i("span",Zn,[e(D(oo)),r(" 取消解析")])):c("",!0)],64)):c("",!0),p.key==="graph_status"?(o(),i(E,{key:3},[n.graph_status==0?(o(),i(E,{key:0},[t("span",Kn,[e(D($e)),r(" 待生成")]),t("a",{class:"ml8",onClick:A=>Qe(n)},"生成",8,es)],64)):n.graph_status==1?(o(),i("span",ts,[e(D(Ko)),r(" 排队中")])):n.graph_status==2?(o(),i("span",os,[e(D(Ce)),r(" 生成完成")])):n.graph_status==3?(o(),i(E,{key:3},[t("span",as,[e(D(ve)),r(" 生成失败")]),t("a",{class:"ml8",onClick:A=>Qe(n)},"生成",8,ns),n.graph_err_msg?(o(),T(pe,{key:0,title:n.graph_err_msg},{default:a(()=>[t("div",ss,"原因："+$(n.graph_err_msg),1)]),_:2},1032,["title"])):c("",!0)],64)):n.graph_status==4?(o(),i("span",ls,[e(fe,{size:"small"}),r(" 生成中")])):n.graph_status==5?(o(),i(E,{key:5},[t("span",is,[e(D(Ce)),r(" 部分成功")]),t("div",us,[r(" 失败数："+$(n.graph_err_count||0)+" ",1),t("a",{class:"ml8",onClick:A=>se(n,{graph_status:3})},"详情",8,_s)])],64)):c("",!0)],64)):c("",!0),p.key==="file_size"?(o(),i(E,{key:4},[n.doc_type==3?(o(),i("span",cs,"-")):(o(),i("span",rs,$(n.file_size_str),1))],64)):c("",!0),p.key==="doc_auto_renew_frequency"?(o(),i(E,{key:5},[n.doc_type==2?(o(),i("div",ds,[t("div",ps,[n.doc_auto_renew_frequency==1?(o(),i("span",ms,"不自动更新")):c("",!0),n.doc_auto_renew_frequency==2?(o(),i("span",fs,"每天")):c("",!0),n.doc_auto_renew_frequency==3?(o(),i("span",vs,"每3天")):c("",!0),n.doc_auto_renew_frequency==4?(o(),i("span",hs,"每7天")):c("",!0),n.doc_auto_renew_frequency==5?(o(),i("span",gs,"每30天")):c("",!0),n.doc_auto_renew_frequency>1&&n.doc_auto_renew_minute>0?(o(),i("span",ys,$(D(ye)(n.doc_auto_renew_minute)),1)):c("",!0),n.doc_auto_renew_frequency>1?(o(),i("span",ks,"更新")):c("",!0),t("a",{class:"ml4 btn-hover-block",onClick:A=>Je(n)},"修改",8,bs)]),e(G,{align:"center"},{default:a(()=>[r(" 最近更新: "+$(n.doc_last_renew_time_desc)+" ",1),e(Ze,{title:"确认更新?",onConfirm:A=>Dt(n)},{default:a(()=>[ws]),_:2},1032,["onConfirm"])]),_:2},1024)])):(o(),i("div",Cs,"--"))],64)):c("",!0),p.key==="paragraph_count"?(o(),i(E,{key:6},[n.status==0||n.status==1?(o(),i("span",xs,"-")):(o(),i("span",Os,$(n.paragraph_count),1))],64)):c("",!0),p.key==="action"?(o(),T(G,{key:7,gap:8},{default:a(()=>[e(pe,null,{title:a(()=>[r("重新分段")]),default:a(()=>[e(D(No),{class:"btn-hover-block",onClick:A=>Ft(n)},null,8,["onClick"])]),_:2},1024),e(We,null,{overlay:a(()=>[e(le,null,{default:a(()=>[n.doc_type==2?(o(),T(Z,{key:0},{default:a(()=>[t("div",{onClick:A=>Je(n)},"编辑",8,$s)]),_:2},1024)):c("",!0),e(Z,{disabled:n.status==6||n.status==7||n.status==0},{default:a(()=>[t("div",{onClick:A=>se(n)},"预览",8,Ss)]),_:2},1032,["disabled"]),e(Z,null,{default:a(()=>[t("div",{onClick:A=>qt(n)},"重命名",8,qs)]),_:2},1024),e(Z,null,{default:a(()=>[e(Ze,{title:"确定要删除吗?",onConfirm:A=>gt(n)},{default:a(()=>[Fs]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:a(()=>[t("div",{class:"table-btn",onClick:u[3]||(u[3]=Oe(()=>{},["prevent"]))},[e(D(Fo),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):c("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),e(et,{open:M.open,"onUpdate:open":u[5]||(u[5]=p=>M.open=p),"confirm-loading":M.confirmLoading,maskClosable:!1,title:"上传文档",onOk:St,onCancel:Ot,width:"740px"},{default:a(()=>[e(Ke,{class:"mt24"},{default:a(()=>[e(me,{required:"",label:""},{default:a(()=>[t("div",Ls,[e(ft,{type:k.value.type,maxCount:20,value:M.fileList,"onUpdate:value":u[4]||(u[4]=p=>M.fileList=p),onChange:$t},null,8,["type","value"])])]),_:1}),Ge.value?(o(),T(me,{key:0,required:"",label:"PDF解析模式",class:"select-card-main"},{default:a(()=>[t("div",Ps,[(o(),i(E,null,ce(q,p=>t("div",{key:p.key,class:mt(["select-card-item",{active:M.pdf_parse_type==p.key},{disabled:p.key==4&&!P.value}]),onClick:Oe(n=>It(p),["stop"])},[e(O,{class:"check-arrow",name:"check-arrow-filled"}),t("div",Us,[e(O,{name:p.icon,style:{"font-size":"16px"}},null,8,["name"]),r(" "+$(p.title)+" ",1),p.key==4&&!P.value?(o(),i("div",Ds,"未开启")):c("",!0)]),t("div",Ts,$(p.desc),1),p.key==4&&!P.value?(o(),i("div",Ms,[r(" 未开启阿里云OCR "),t("div",{class:"card-switch-btn",onClick:Oe(Ut,["stop"])},"去开启")])):c("",!0)],10,Is)),64))])]),_:1})):c("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),e(Ta,{onOk:Y,ref_key:"qaUploadModalRef",ref:Ae},null,512),e(et,{open:L.open,"onUpdate:open":u[9]||(u[9]=p=>L.open=p),"confirm-loading":L.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:wt,onCancel:Ct},{default:a(()=>[e(Ke,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:je,model:L,rules:L.rules},{default:a(()=>[e(me,{name:"urls",label:"网页链接"},{default:a(()=>[e(jt,{style:{height:"120px"},value:L.urls,"onUpdate:value":u[6]||(u[6]=p=>L.urls=p),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),e(me,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:a(()=>[e(Xe,{value:L.doc_auto_renew_frequency,"onUpdate:value":u[7]||(u[7]=p=>L.doc_auto_renew_frequency=p),style:{width:"100%"}},{default:a(()=>[e(ie,{value:1},{default:a(()=>[r("不自动更新")]),_:1}),e(ie,{value:2},{default:a(()=>[r("每天")]),_:1}),e(ie,{value:3},{default:a(()=>[r("每3天")]),_:1}),e(ie,{value:4},{default:a(()=>[r("每7天")]),_:1}),e(ie,{value:5},{default:a(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),L.doc_auto_renew_frequency>1?(o(),T(me,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(Gt,{valueFormat:"HH:mm",value:L.doc_auto_renew_minute,"onUpdate:value":u[8]||(u[8]=p=>L.doc_auto_renew_minute=p),format:"HH:mm"},null,8,["value"])]),_:1})):c("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),e(ua,{libraryInfo:k.value,onOk:ne,ref_key:"addCustomDocumentRef",ref:Be},null,8,["libraryInfo"]),e(wo,{onOk:ne,ref_key:"renameModalRef",ref:Ve},null,512),e(go,{onOk:Pt,ref_key:"openGrapgModalRef",ref:I},null,512),e(Ga,{ref_key:"guideLearningTipsRef",ref:N},null,512),e(Aa,{onOk:Y,ref_key:"editOnlineDocRef",ref:Ye},null,512)])}}},si=be(Rs,[["__scopeId","data-v-9dddd452"]]);export{si as default};
