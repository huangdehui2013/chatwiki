import{K as Ae,p as $e,q as Q,t as ca,v as ua,w as jt,x as et,P as je,y as _a,z as Ft,A as pa,C as ut,F as va,G as ma,H as fa,J as ha,L as Vt,N as ga,O as _t,Q as pt,S as ya,T as ba,U as ka,b as he,f as wa,V as xa,M as fe,k as oe,W as Ut,n as Ve,X as kt,Y as Ca,r as Sa,Z as Ht,B as tt,E as qe,$ as $a,a0 as Bt,d as Ia,a1 as La,a2 as Da,a3 as Oa,a4 as Ta,a5 as Pa,a6 as Va,a7 as Ea,a8 as Ra}from"../../index-BdYv4pbp.js";import{b as Ka,p as Ma,f as wt,e as C,d as G,w as Re,s as ye,k as t,z as Ze,aa as we,j as xt,af as Ee,ag as Na,M as D,N as y,F as _e,a0 as Qe,a6 as zt,Z as j,u as W,S as l,Q as se,W as r,a1 as Ke,a2 as Me,B as pe,V as ge,Y as O,a7 as te,$ as Xe,x as Aa}from"./vue-chunks-Dagx-vSq.js";import{_ as ja}from"./cu-scroll-BvD9XPVC.js";import{g as Wt}from"./index-CwlGBMSn.js";import{g as Yt}from"./index-BOf_F41n.js";import{v as Jt}from"./validate-8MtiUsxW.js";import{F as Ie,_ as at}from"./index-CbmBRnKK.js";import{P as lt}from"./PlusOutlined-BEhntgqt.js";import{_ as Fa}from"./index-DtgLQTOT.js";import{d as ht}from"./role_avatar-DL0r08JY.js";import{g as nt,a as qt,b as Ua,s as Ha,d as Ba,c as za,e as Wa,f as Ya,h as Ja}from"./index-DQctwWcD.js";import"./index-B11WLJj_.js";import{I as Ct}from"./Input-C2qOGQ_1.js";import{u as qa,b as Qa,c as Ga,d as Xa,e as Za,t as Et,B as el,f as tl,g as al,h as ll,S as Qt,a as Gt}from"./index-BddIR2yb.js";import{T as nl,g as sl,r as ol,_ as il}from"./index-DNsujCXu.js";import{c as rl,a as gt,u as dl}from"./useMaxLevel-B54cygJO.js";import{u as Rt,C as vt}from"./CheckOutlined-Zj7x0G_2.js";import{u as cl,F as ul}from"./FormItemContext-Cdyd-mYe.js";import{g as _l,a as pl}from"./index-ffqjZvit.js";import{g as vl}from"./index-_xQpb7Ga.js";import"./index-TeHk_coF.js";import{_ as St,R as Xt,a as ml}from"./RadioButton-CKy5Sstn.js";import{D as fl}from"./dayjs-BgW8aCpT.js";import{_ as Zt,E as hl}from"./Password-D2_IM1Jy.js";import{_ as ea}from"./index-CzzmSx3J.js";import{a as st,_ as $t}from"./index-p8d_9U1-.js";import{_ as It}from"./Search-B65y9BZx.js";import"./index-Dq7HAFaD.js";import{D as ta}from"./dropdown-BiE8xfl_.js";import{M as gl}from"./MoreOutlined-D2HKzNS9.js";import{M as aa,_ as la}from"./index-CJ0orYu6.js";import{C as yl}from"./CaretDownOutlined-Ch0ng0P7.js";import{_ as na}from"./index-CCsePsqL.js";import{_ as bl}from"./index-7XEwOeX1.js";import{D as kl}from"./DownOutlined-bF62ZcFO.js";import{U as wl}from"./UserOutlined-BscmVZKR.js";import{E as xl}from"./EditOutlined-CAMBbdOo.js";import{Q as mt}from"./QuestionCircleOutlined-BY31qbwb.js";import{_ as Cl}from"./index-DdBHG-A3.js";import{_ as Lt}from"./index-B6ctIxYh.js";import{_ as Sl}from"./TextArea-DRJIYohD.js";import{_ as $l,C as Il}from"./index-Dzb8yElx.js";import{_ as Ll,a as Dl}from"./index-CnEKerRj.js";import"./axios-BZ84_VUH.js";import"./qs-CSiAN3u4.js";import"./crypto-js-DN0vhd75.js";import"./dayjs-CZ5VaChI.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./Trigger-DWEODdVI.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-BUQ58MPT.js";import"./responsiveObserve-YIOA4WXQ.js";import"./collapseMotion-D5mGic4t.js";import"./DownloadOutlined-B8UItTFz.js";import"./inputProps-BIa77Hqy.js";import"./slide-4EGAbcnD.js";import"./index-p3MxSJUT.js";import"./SearchOutlined-C-SKizIr.js";import"./move-Du4Gi3iM.js";import"./CaretDownFilled-7_Xowb8a.js";import"./Checkbox-B2wqz-LK.js";import"./index-BpCazXL4.js";import"./index-BlBB-sRM.js";import"./colors-CJx9DhIW.js";import"./shallowequal-CI97GdPH.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-BITuwxer.js";import"./LeftOutlined-DfhC6gKx.js";import"./RightOutlined-Dc3RESo2.js";function Ol(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Tl(e){const{label:_,value:g,children:s}=e||{},i=g||"value";return{_title:_?[_]:["title","label"],value:i,key:i,children:s||"children"}}function yt(e){return e.disabled||e.disableCheckbox||e.checkable===!1}function Pl(e,_){const g=[];function s(i){i.forEach(n=>{g.push(n[_.value]);const o=n[_.children];o&&s(o)})}return s(e),g}function Kt(e){return e==null}const sa=Symbol("TreeSelectContextPropsKey");function Vl(e){return Ma(sa,e)}function El(){return Ka(sa,{})}const Rl={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Kl=wt({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(e,_){let{slots:g,expose:s}=_;const i=qa(),n=Qa(),o=El(),a=C(),w=Ga(()=>o.treeData,[()=>i.open,()=>o.treeData],d=>d[0]),u=G(()=>{const{checkable:d,halfCheckedKeys:p,checkedKeys:R}=n;return d?{checked:R,halfChecked:p}:null});Re(()=>i.open,()=>{Ze(()=>{var d;i.open&&!i.multiple&&n.checkedKeys.length&&((d=a.value)===null||d===void 0||d.scrollTo({key:n.checkedKeys[0]}))})},{immediate:!0,flush:"post"});const f=G(()=>String(i.searchValue).toLowerCase()),$=d=>f.value?String(d[n.treeNodeFilterProp]).toLowerCase().includes(f.value):!1,k=ye(n.treeDefaultExpandedKeys),S=ye(null);Re(()=>i.searchValue,()=>{i.searchValue&&(S.value=Pl(we(o.treeData),we(o.fieldNames)))},{immediate:!0});const P=G(()=>n.treeExpandedKeys?n.treeExpandedKeys.slice():i.searchValue?S.value:k.value),h=d=>{var p;k.value=d,S.value=d,(p=n.onTreeExpand)===null||p===void 0||p.call(n,d)},v=d=>{d.preventDefault()},c=(d,p)=>{let{node:R}=p;var M,F;const{checkable:x,checkedKeys:L}=n;x&&yt(R)||((M=o.onSelect)===null||M===void 0||M.call(o,R.key,{selected:!L.includes(R.key)}),i.multiple||(F=i.toggleOpen)===null||F===void 0||F.call(i,!1))},V=C(null),E=G(()=>n.keyEntities[V.value]),H=d=>{V.value=d};return s({scrollTo:function(){for(var d,p,R=arguments.length,M=new Array(R),F=0;F<R;F++)M[F]=arguments[F];return(p=(d=a.value)===null||d===void 0?void 0:d.scrollTo)===null||p===void 0?void 0:p.call(d,...M)},onKeydown:d=>{var p;const{which:R}=d;switch(R){case Ae.UP:case Ae.DOWN:case Ae.LEFT:case Ae.RIGHT:(p=a.value)===null||p===void 0||p.onKeydown(d);break;case Ae.ENTER:{if(E.value){const{selectable:M,value:F}=E.value.node||{};M!==!1&&c(null,{node:{key:V.value},selected:!n.checkedKeys.includes(F)})}break}case Ae.ESC:i.toggleOpen(!1)}},onKeyup:()=>{}}),()=>{var d;const{prefixCls:p,multiple:R,searchValue:M,open:F,notFoundContent:x=(d=g.notFoundContent)===null||d===void 0?void 0:d.call(g)}=i,{listHeight:L,listItemHeight:b,virtual:T,dropdownMatchSelectWidth:N,treeExpandAction:B}=o,{checkable:X,treeDefaultExpandAll:q,treeIcon:m,showTreeIcon:Z,switcherIcon:xe,treeLine:A,loadData:J,treeLoadedKeys:ie,treeMotion:K,onTreeLoad:ee,checkedKeys:ce}=n;if(w.value.length===0)return t("div",{role:"listbox",class:`${p}-empty`,onMousedown:v},[x]);const Ce={fieldNames:o.fieldNames};return ie&&(Ce.loadedKeys=ie),P.value&&(Ce.expandedKeys=P.value),t("div",{onMousedown:v},[E.value&&F&&t("span",{style:Rl,"aria-live":"assertive"},[E.value.node.value]),t(nl,$e($e({ref:a,focusable:!1,prefixCls:`${p}-tree`,treeData:w.value,height:L,itemHeight:b,virtual:T!==!1&&N!==!1,multiple:R,icon:m,showIcon:Z,switcherIcon:xe,showLine:A,loadData:M?null:J,motion:K,activeKey:V.value,checkable:X,checkStrictly:!0,checkedKeys:u.value,selectedKeys:X?[]:ce,defaultExpandAll:q},Ce),{},{onActiveChange:H,onSelect:c,onCheck:c,onExpand:h,onLoad:ee,filterTreeNode:$,expandAction:B}),Q(Q({},g),{checkable:n.customSlots.treeCheckable}))])}}}),Ml="SHOW_ALL",oa="SHOW_PARENT",Dt="SHOW_CHILD";function Mt(e,_,g,s){const i=new Set(e);return _===Dt?e.filter(n=>{const o=g[n];return!(o&&o.children&&o.children.some(a=>{let{node:w}=a;return i.has(w[s.value])})&&o.children.every(a=>{let{node:w}=a;return yt(w)||i.has(w[s.value])}))}):_===oa?e.filter(n=>{const o=g[n],a=o?o.parent:null;return!(a&&!yt(a.node)&&i.has(a.key))}):e}const Fe=()=>null;Fe.inheritAttrs=!1;Fe.displayName="ATreeSelectNode";Fe.isTreeSelectNode=!0;var Nl=function(e,_){var g={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&_.indexOf(s)<0&&(g[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)_.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(g[s[i]]=e[s[i]]);return g};function Al(e){return e&&e.type&&e.type.isTreeSelectNode}function jl(e){function _(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ca(g).map(s=>{var i,n,o;if(!Al(s))return null;const a=s.children||{},w=s.key,u={};for(const[R,M]of Object.entries(s.props))u[ua(R)]=M;const{isLeaf:f,checkable:$,selectable:k,disabled:S,disableCheckbox:P}=u,h={isLeaf:f||f===""||void 0,checkable:$||$===""||void 0,selectable:k||k===""||void 0,disabled:S||S===""||void 0,disableCheckbox:P||P===""||void 0},v=Q(Q({},u),h),{title:c=(i=a.title)===null||i===void 0?void 0:i.call(a,v),switcherIcon:V=(n=a.switcherIcon)===null||n===void 0?void 0:n.call(a,v)}=u,E=Nl(u,["title","switcherIcon"]),H=(o=a.default)===null||o===void 0?void 0:o.call(a),d=Q(Q(Q({},E),{title:c,switcherIcon:V,key:w,isLeaf:f}),h),p=_(H);return p.length&&(d.children=p),d})}return _(e)}function bt(e){if(!e)return e;const _=Q({},e);return"props"in _||Object.defineProperty(_,"props",{get(){return _}}),_}function Fl(e,_,g,s,i,n){let o=null,a=null;function w(){function u(f){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return f.map((S,P)=>{const h=`${$}-${P}`,v=S[n.value],c=g.includes(v),V=u(S[n.children]||[],h,c),E=t(Fe,S,{default:()=>[V.map(H=>H.node)]});if(_===v&&(o=E),c){const H={pos:h,node:E,children:V};return k||a.push(H),H}return null}).filter(S=>S)}a||(a=[],u(s),a.sort((f,$)=>{let{node:{props:{value:k}}}=f,{node:{props:{value:S}}}=$;const P=g.indexOf(k),h=g.indexOf(S);return P-h}))}Object.defineProperty(e,"triggerNode",{get(){return w(),o}}),Object.defineProperty(e,"allCheckedNodes",{get(){return w(),i?a:a.map(u=>{let{node:f}=u;return f})}})}function Ul(e,_){let{id:g,pId:s,rootPId:i}=_;const n={},o=[];return e.map(w=>{const u=Q({},w),f=u[g];return n[f]=u,u.key=u.key||f,u}).forEach(w=>{const u=w[s],f=n[u];f&&(f.children=f.children||[],f.children.push(w)),(u===i||!f&&i===null)&&o.push(w)}),o}function Hl(e,_,g){const s=ye();return Re([g,e,_],()=>{const i=g.value;e.value?s.value=g.value?Ul(we(e.value),Q({id:"id",pId:"pId",rootPId:null},i!==!0?i:{})):we(e.value).slice():s.value=jl(we(_.value))},{immediate:!0,deep:!0}),s}const Bl=e=>{const _=ye({valueLabels:new Map}),g=ye();return Re(e,()=>{g.value=we(e.value)},{immediate:!0}),[G(()=>{const{valueLabels:i}=_.value,n=new Map,o=g.value.map(a=>{var w;const{value:u}=a,f=(w=a.label)!==null&&w!==void 0?w:i.get(u);return n.set(u,f),Q(Q({},a),{label:f})});return _.value.valueLabels=n,o})]},zl=(e,_)=>{const g=ye(new Map),s=ye({});return xt(()=>{const i=_.value,n=rl(e.value,{fieldNames:i,initWrapper:o=>Q(Q({},o),{valueEntities:new Map}),processEntity:(o,a)=>{const w=o.node[i.value];a.valueEntities.set(w,o)}});g.value=n.valueEntities,s.value=n.keyEntities}),{valueEntities:g,keyEntities:s}},Wl=(e,_,g,s,i,n)=>{const o=ye([]),a=ye([]);return xt(()=>{let w=e.value.map($=>{let{value:k}=$;return k}),u=_.value.map($=>{let{value:k}=$;return k});const f=w.filter($=>!s.value[$]);g.value&&({checkedKeys:w,halfCheckedKeys:u}=gt(w,!0,s.value,i.value,n.value)),o.value=Array.from(new Set([...f,...w])),a.value=u}),[o,a]},Yl=(e,_,g)=>{let{treeNodeFilterProp:s,filterTreeNode:i,fieldNames:n}=g;return G(()=>{const{children:o}=n.value,a=_.value,w=s==null?void 0:s.value;if(!a||i.value===!1)return e.value;let u;if(typeof i.value=="function")u=i.value;else{const $=a.toUpperCase();u=(k,S)=>{const P=S[w];return String(P).toUpperCase().includes($)}}function f($){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=[];for(let P=0,h=$.length;P<h;P++){const v=$[P],c=v[o],V=k||u(a,bt(v)),E=f(c||[],V);(V||E.length)&&S.push(Q(Q({},v),{[o]:E}))}return S}return f(e.value)})};function ia(){return Q(Q({},et(tl(),["mode"])),{prefixCls:String,id:String,value:{type:[String,Number,Object,Array]},defaultValue:{type:[String,Number,Object,Array]},onChange:{type:Function},searchValue:String,inputValue:String,onSearch:{type:Function},autoClearSearchValue:{type:Boolean,default:void 0},filterTreeNode:{type:[Boolean,Function],default:void 0},treeNodeFilterProp:String,onSelect:Function,onDeselect:Function,showCheckedStrategy:{type:String},treeNodeLabelProp:String,fieldNames:{type:Object},multiple:{type:Boolean,default:void 0},treeCheckable:{type:Boolean,default:void 0},treeCheckStrictly:{type:Boolean,default:void 0},labelInValue:{type:Boolean,default:void 0},treeData:{type:Array},treeDataSimpleMode:{type:[Boolean,Object],default:void 0},loadData:{type:Function},treeLoadedKeys:{type:Array},onTreeLoad:{type:Function},treeDefaultExpandAll:{type:Boolean,default:void 0},treeExpandedKeys:{type:Array},treeDefaultExpandedKeys:{type:Array},onTreeExpand:{type:Function},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,onDropdownVisibleChange:{type:Function},treeLine:{type:[Boolean,Object],default:void 0},treeIcon:je.any,showTreeIcon:{type:Boolean,default:void 0},switcherIcon:je.any,treeMotion:je.any,children:Array,treeExpandAction:String,showArrow:{type:Boolean,default:void 0},showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:je.any,maxTagPlaceholder:{type:Function},dropdownPopupAlign:je.any,customSlots:Object})}function Jl(e){return!e||typeof e!="object"}const ql=wt({compatConfig:{MODE:3},name:"TreeSelect",inheritAttrs:!1,props:jt(ia(),{treeNodeFilterProp:"value",autoClearSearchValue:!0,showCheckedStrategy:Dt,listHeight:200,listItemHeight:20,prefixCls:"vc-tree-select"}),setup(e,_){let{attrs:g,expose:s,slots:i}=_;const n=Xa(Ee(e,"id")),o=G(()=>e.treeCheckable&&!e.treeCheckStrictly),a=G(()=>e.treeCheckable||e.treeCheckStrictly),w=G(()=>e.treeCheckStrictly||e.labelInValue),u=G(()=>a.value||e.multiple),f=G(()=>Tl(e.fieldNames)),[$,k]=Rt("",{value:G(()=>e.searchValue!==void 0?e.searchValue:e.inputValue),postState:U=>U||""}),S=U=>{var z;k(U),(z=e.onSearch)===null||z===void 0||z.call(e,U)},P=Hl(Ee(e,"treeData"),Ee(e,"children"),Ee(e,"treeDataSimpleMode")),{keyEntities:h,valueEntities:v}=zl(P,f),c=U=>{const z=[],Y=[];return U.forEach(le=>{v.value.has(le)?Y.push(le):z.push(le)}),{missingRawValues:z,existRawValues:Y}},V=Yl(P,$,{fieldNames:f,treeNodeFilterProp:Ee(e,"treeNodeFilterProp"),filterTreeNode:Ee(e,"filterTreeNode")}),E=U=>{if(U){if(e.treeNodeLabelProp)return U[e.treeNodeLabelProp];const{_title:z}=f.value;for(let Y=0;Y<z.length;Y+=1){const le=U[z[Y]];if(le!==void 0)return le}}},H=U=>Ol(U).map(Y=>Jl(Y)?{value:Y}:Y),d=U=>H(U).map(Y=>{let{label:le}=Y;const{value:de,halfChecked:ne}=Y;let ae;const re=v.value.get(de);return re&&(le=le??E(re.node),ae=re.node.disabled),{label:le,value:de,halfChecked:ne,disabled:ae}}),[p,R]=Rt(e.defaultValue,{value:Ee(e,"value")}),M=G(()=>H(p.value)),F=ye([]),x=ye([]);xt(()=>{const U=[],z=[];M.value.forEach(Y=>{Y.halfChecked?z.push(Y):U.push(Y)}),F.value=U,x.value=z});const L=G(()=>F.value.map(U=>U.value)),{maxLevel:b,levelEntities:T}=dl(h),[N,B]=Wl(F,x,o,h,b,T),X=G(()=>{const Y=Mt(N.value,e.showCheckedStrategy,h.value,f.value).map(ne=>{var ae,re,Se;return(Se=(re=(ae=h.value[ne])===null||ae===void 0?void 0:ae.node)===null||re===void 0?void 0:re[f.value.value])!==null&&Se!==void 0?Se:ne}).map(ne=>{const ae=F.value.find(re=>re.value===ne);return{value:ne,label:ae==null?void 0:ae.label}}),le=d(Y),de=le[0];return!u.value&&de&&Kt(de.value)&&Kt(de.label)?[]:le.map(ne=>{var ae;return Q(Q({},ne),{label:(ae=ne.label)!==null&&ae!==void 0?ae:ne.value})})}),[q]=Bl(X),m=(U,z,Y)=>{const le=d(U);if(R(le),e.autoClearSearchValue&&k(""),e.onChange){let de=U;o.value&&(de=Mt(U,e.showCheckedStrategy,h.value,f.value).map(Pe=>{const Ge=v.value.get(Pe);return Ge?Ge.node[f.value.value]:Pe}));const{triggerValue:ne,selected:ae}=z||{triggerValue:void 0,selected:void 0};let re=de;if(e.treeCheckStrictly){const ke=x.value.filter(Pe=>!de.includes(Pe.value));re=[...re,...ke]}const Se=d(re),Oe={preValue:F.value,triggerValue:ne};let Te=!0;(e.treeCheckStrictly||Y==="selection"&&!ae)&&(Te=!1),Fl(Oe,ne,U,P.value,Te,f.value),a.value?Oe.checked=ae:Oe.selected=ae;const be=w.value?Se:Se.map(ke=>ke.value);e.onChange(u.value?be:be[0],w.value?null:Se.map(ke=>ke.label),Oe)}},Z=(U,z)=>{let{selected:Y,source:le}=z;var de,ne,ae;const re=we(h.value),Se=we(v.value),Oe=re[U],Te=Oe==null?void 0:Oe.node,be=(de=Te==null?void 0:Te[f.value.value])!==null&&de!==void 0?de:U;if(!u.value)m([be],{selected:!0,triggerValue:be},"option");else{let ke=Y?[...L.value,be]:N.value.filter(Pe=>Pe!==be);if(o.value){const{missingRawValues:Pe,existRawValues:Ge}=c(ke),Pt=Ge.map(ct=>Se.get(ct).key);let dt;Y?{checkedKeys:dt}=gt(Pt,!0,re,b.value,T.value):{checkedKeys:dt}=gt(Pt,{halfCheckedKeys:B.value},re,b.value,T.value),ke=[...Pe,...dt.map(ct=>re[ct].node[f.value.value])]}m(ke,{selected:Y,triggerValue:be},le||"option")}Y||!u.value?(ne=e.onSelect)===null||ne===void 0||ne.call(e,be,bt(Te)):(ae=e.onDeselect)===null||ae===void 0||ae.call(e,be,bt(Te))},xe=U=>{if(e.onDropdownVisibleChange){const z={};Object.defineProperty(z,"documentClickClose",{get(){return!1}}),e.onDropdownVisibleChange(U,z)}},A=(U,z)=>{const Y=U.map(le=>le.value);if(z.type==="clear"){m(Y,{},"selection");return}z.values.length&&Z(z.values[0].value,{selected:!1,source:"selection"})},{treeNodeFilterProp:J,loadData:ie,treeLoadedKeys:K,onTreeLoad:ee,treeDefaultExpandAll:ce,treeExpandedKeys:Ce,treeDefaultExpandedKeys:Be,onTreeExpand:Le,virtual:ze,listHeight:ve,listItemHeight:ue,treeLine:De,treeIcon:We,showTreeIcon:Ye,switcherIcon:I,treeMotion:me,customSlots:it,dropdownMatchSelectWidth:Je,treeExpandAction:rt}=Na(e);Za(Et({checkable:a,loadData:ie,treeLoadedKeys:K,onTreeLoad:ee,checkedKeys:N,halfCheckedKeys:B,treeDefaultExpandAll:ce,treeExpandedKeys:Ce,treeDefaultExpandedKeys:Be,onTreeExpand:Le,treeIcon:We,treeMotion:me,showTreeIcon:Ye,switcherIcon:I,treeLine:De,treeNodeFilterProp:J,keyEntities:h,customSlots:it})),Vl(Et({virtual:ze,listHeight:ve,listItemHeight:ue,treeData:V,fieldNames:f,onSelect:Z,dropdownMatchSelectWidth:Je,treeExpandAction:rt}));const Ne=C();return s({focus(){var U;(U=Ne.value)===null||U===void 0||U.focus()},blur(){var U;(U=Ne.value)===null||U===void 0||U.blur()},scrollTo(U){var z;(z=Ne.value)===null||z===void 0||z.scrollTo(U)}}),()=>{var U;const z=et(e,["id","prefixCls","customSlots","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"]);return t(el,$e($e($e({ref:Ne},g),z),{},{id:n,prefixCls:e.prefixCls,mode:u.value?"multiple":void 0,displayValues:q.value,onDisplayValuesChange:A,searchValue:$.value,onSearch:S,OptionList:Kl,emptyOptions:!P.value.length,onDropdownVisibleChange:xe,tagRender:e.tagRender||i.tagRender,dropdownMatchSelectWidth:(U=e.dropdownMatchSelectWidth)!==null&&U!==void 0?U:!0}),i)}}}),Ql=e=>{const{componentCls:_,treePrefixCls:g,colorBgElevated:s}=e,i=`.${g}`;return[{[`${_}-dropdown`]:[{padding:`${e.paddingXS}px ${e.paddingXS/2}px`},sl(g,Ft(e,{colorBgContainer:s})),{[i]:{borderRadius:0,"&-list-holder-inner":{alignItems:"stretch",[`${i}-treenode`]:{[`${i}-node-content-wrapper`]:{flex:"auto"}}}}},vl(`${g}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${i}-switcher${i}-switcher_close`]:{[`${i}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Gl(e,_){return _a("TreeSelect",g=>{const s=Ft(g,{treePrefixCls:_.value});return[Ql(s)]})(e)}const Nt=(e,_,g)=>g!==void 0?g:`${e}-${_}`;function Xl(){return Q(Q({},et(ia(),["showTreeIcon","treeMotion","inputIcon","getInputElement","treeLine","customSlots"])),{suffixIcon:je.any,size:pt(),bordered:ka(),treeLine:ba([Boolean,Object]),replaceFields:ya(),placement:pt(),status:pt(),popupClassName:String,dropdownClassName:String,"onUpdate:value":_t(),"onUpdate:treeExpandedKeys":_t(),"onUpdate:searchValue":_t()})}const ft=wt({compatConfig:{MODE:3},name:"ATreeSelect",inheritAttrs:!1,props:jt(Xl(),{choiceTransitionName:"",listHeight:256,treeIcon:!1,listItemHeight:26,bordered:!0}),slots:Object,setup(e,_){let{attrs:g,slots:s,expose:i,emit:n}=_;pa(!(e.treeData===void 0&&s.default)),ut(e.multiple!==!1||!e.treeCheckable,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true"),ut(e.replaceFields===void 0,"TreeSelect","`replaceFields` is deprecated, please use fieldNames instead"),ut(!e.dropdownClassName,"TreeSelect","`dropdownClassName` is deprecated. Please use `popupClassName` instead.");const o=cl(),a=ul.useInject(),w=G(()=>_l(a.status,e.status)),{prefixCls:u,renderEmpty:f,direction:$,virtual:k,dropdownMatchSelectWidth:S,size:P,getPopupContainer:h,getPrefixCls:v,disabled:c}=va("select",e),{compactSize:V,compactItemClassnames:E}=ma(u,$),H=G(()=>V.value||P.value),d=fa(),p=G(()=>{var K;return(K=c.value)!==null&&K!==void 0?K:d.value}),R=G(()=>v()),M=G(()=>e.placement!==void 0?e.placement:$.value==="rtl"?"bottomRight":"bottomLeft"),F=G(()=>Nt(R.value,ha(M.value),e.transitionName)),x=G(()=>Nt(R.value,"",e.choiceTransitionName)),L=G(()=>v("select-tree",e.prefixCls)),b=G(()=>v("tree-select",e.prefixCls)),[T,N]=al(u),[B]=Gl(b,L),X=G(()=>Vt(e.popupClassName||e.dropdownClassName,`${b.value}-dropdown`,{[`${b.value}-dropdown-rtl`]:$.value==="rtl"},N.value)),q=G(()=>!!(e.treeCheckable||e.multiple)),m=G(()=>e.showArrow!==void 0?e.showArrow:e.loading||!q.value),Z=C();i({focus(){var K,ee;(ee=(K=Z.value).focus)===null||ee===void 0||ee.call(K)},blur(){var K,ee;(ee=(K=Z.value).blur)===null||ee===void 0||ee.call(K)}});const xe=function(){for(var K=arguments.length,ee=new Array(K),ce=0;ce<K;ce++)ee[ce]=arguments[ce];n("update:value",ee[0]),n("change",...ee),o.onFieldChange()},A=K=>{n("update:treeExpandedKeys",K),n("treeExpand",K)},J=K=>{n("update:searchValue",K),n("search",K)},ie=K=>{n("blur",K),o.onFieldBlur()};return()=>{var K,ee;const{notFoundContent:ce=(K=s.notFoundContent)===null||K===void 0?void 0:K.call(s),prefixCls:Ce,bordered:Be,listHeight:Le,listItemHeight:ze,multiple:ve,treeIcon:ue,treeLine:De,showArrow:We,switcherIcon:Ye=(ee=s.switcherIcon)===null||ee===void 0?void 0:ee.call(s),fieldNames:I=e.replaceFields,id:me=o.id.value}=e,{isFormItemInput:it,hasFeedback:Je,feedbackIcon:rt}=a,{suffixIcon:Ne,removeIcon:U,clearIcon:z}=ll(Q(Q({},e),{multiple:q.value,showArrow:m.value,hasFeedback:Je,feedbackIcon:rt,prefixCls:u.value}),s);let Y;ce!==void 0?Y=ce:Y=f("Select");const le=et(e,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon","bordered","status","onUpdate:value","onUpdate:treeExpandedKeys","onUpdate:searchValue"]),de=Vt(!Ce&&b.value,{[`${u.value}-lg`]:H.value==="large",[`${u.value}-sm`]:H.value==="small",[`${u.value}-rtl`]:$.value==="rtl",[`${u.value}-borderless`]:!Be,[`${u.value}-in-form-item`]:it},pl(u.value,w.value,Je),E.value,g.class,N.value),ne={};return e.treeData===void 0&&s.default&&(ne.children=ga(s.default())),T(B(t(ql,$e($e($e($e({},g),le),{},{disabled:p.value,virtual:k.value,dropdownMatchSelectWidth:S.value,id:me,fieldNames:I,ref:Z,prefixCls:u.value,class:de,listHeight:Le,listItemHeight:ze,treeLine:!!De,inputIcon:Ne,multiple:ve,removeIcon:U,clearIcon:z,switcherIcon:ae=>ol(L.value,Ye,ae,s.leafIcon,De),showTreeIcon:ue,notFoundContent:Y,getPopupContainer:h==null?void 0:h.value,treeMotion:null,dropdownClassName:X.value,choiceTransitionName:x.value,onChange:xe,onBlur:ie,onSearch:J,onTreeExpand:A},ne),{},{transitionName:F.value,customSlots:Q(Q({},s),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}),maxTagPlaceholder:e.maxTagPlaceholder||s.maxTagPlaceholder,placement:M.value,showArrow:Je||We}),Q(Q({},s),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}))))}}}),At=Fe,Ot=Q(ft,{TreeNode:Fe,SHOW_ALL:Ml,SHOW_PARENT:oa,SHOW_CHILD:Dt,install:e=>(e.component(ft.name,ft),e.component(At.displayName,At),e)}),Zl={class:"page-tabs"},en=["onClick"],tn={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(e,{emit:_}){const{t:g}=wa(),s=_,i=e,n=C([{value:1,title:g("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"},{value:0,title:g("views.user.model.rolePermissions"),langKey:"views.user.model.rolePermissions"}]),o=a=>{s("update:value",a),s("change",a)};return(a,w)=>(y(),D("div",Zl,[(y(!0),D(_e,null,Qe(n.value,u=>(y(),D("div",{class:zt(["tab-item",{active:i.value==u.value}]),onClick:f=>o(u.value),key:u.value},j(W(g)(u.langKey)),11,en))),128))]))}},an=he(tn,[["__scopeId","data-v-924c1ece"]]),ln=e=>(Ke("data-v-662035a2"),e=e(),Me(),e),nn={class:"avatar-uploader"},sn=["src"],on={key:1},rn=ln(()=>r("div",{class:"ant-upload-text"},"上传照片",-1)),dn=["src"],cn={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(e,{emit:_}){function g(v){return new Promise((c,V)=>{const E=new FileReader;E.readAsDataURL(v),E.onload=()=>c(E.result),E.onerror=H=>V(H)})}const s=_,i=e,n=C([]),o=C(!1),a=C("");Re(()=>i.value,v=>{a.value=v},{immediate:!0});const w=Ie.useInjectFormItemContext(),u=()=>{let v={imageUrl:a.value,file:n.value[0].originFileObj};s("change",v),s("update:value",v.imageUrl),w.onFieldChange()},f=v=>v.type==="image/jpeg"||v.type==="image/png"?v.size/1024<1024?(n.value=[v],g(v).then(E=>{a.value=E,o.value=!1,u()}),!1):(oe.error("成员头像图片大小不能超过1M"),!1):(oe.error("机器人头像只支持JPG、PNG格式的图片"),!1),$=C(!1),k=C(""),S=C(""),P=()=>{$.value=!1,S.value=""},h=async v=>{!v.url&&!v.preview&&(v.preview=await g(v.originFileObj)),k.value=v.url||v.preview,$.value=!0,S.value=v.name||v.url.substring(v.url.lastIndexOf("/")+1)};return(v,c)=>{const V=Fa,E=fe;return y(),D("div",nn,[t(V,{"file-list":n.value,"onUpdate:fileList":c[0]||(c[0]=H=>n.value=H),"list-type":"picture-card","show-upload-list":!1,"before-upload":f,accept:".jpg,.png,.jpeg",onPreview:h},{default:l(()=>[a.value?(y(),D("img",{key:0,class:"avatar",src:a.value,alt:"avatar"},null,8,sn)):(y(),D("div",on,[o.value?(y(),se(W(xa),{key:0})):(y(),se(W(lt),{key:1})),rn]))]),_:1},8,["file-list"]),t(E,{open:$.value,title:S.value,footer:null,onCancel:P},{default:l(()=>[r("img",{alt:"example",style:{width:"100%"},src:k.value},null,8,dn)]),_:1},8,["open","title"])])}}},un=he(cn,[["__scopeId","data-v-662035a2"]]),_n=e=>(Ke("data-v-e2c6d008"),e=e(),Me(),e),pn={class:"form-box"},vn={class:"avatar-box"},mn=_n(()=>r("div",{class:"tip"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1)),fn={class:"flex-item-box"},hn={class:"flex-item-box"},gn={class:"flex-item-box"},yn={class:"flex-item-box"},bn={key:0,style:{"margin-top":"4px"}},kn={__name:"add-team-members",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C(!1),o=C("添加团队成员"),a=pe({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",department_ids:[],expire_time_type:0,expire_time:"",id:""}),w=C([]),u=()=>{nt({}).then(d=>{let p=d.data||[];w.value=kt(p)})},f=d=>{a.avatar=d.file},$=C([]);Ut({page:1,size:200,search:""}).then(d=>{let p=d.data.list||[];$.value=p.filter(R=>R.id!="1"&&R.role_type!=1)});const k=pe({user_name:[{message:"请输入登录账号",required:!0},{validator:async(d,p)=>!/^[a-zA-Z0-9_.-]+$/.test(p)&&p?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(d,p)=>!Jt(p)&&p?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(d,p)=>p!=a.password&&p?Promise.reject("两次输入的密码不一致"):Promise.resolve()}],expire_time:[{validator:async(d,p)=>a.expire_time_type==1&&!p?Promise.reject("请选择指定日期"):Promise.resolve()}],department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:S,validate:P,validateInfos:h}=i(a,k),v=d=>{o.value="添加团队成员",n.value=!0,S(),a.user_name="",a.nick_name="",a.avatar="",a.avatar_url=ht,a.user_roles="3",a.password="",a.check_password="",a.expire_time_type=0,a.expire_time="",a.department_ids=d?[d]:[],a.id="",u()},c=d=>{o.value="编辑团队成员",a.user_name=d.user_name,a.nick_name=d.nick_name,a.avatar_url=d.avatar||ht,a.avatar="",a.user_roles=d.user_roles,a.password="",a.check_password="",a.id=d.id,d.expire_time>0?(a.expire_time_type=1,a.expire_time=Ve(d.expire_time*1e3)):(a.expire_time_type=0,a.expire_time=""),a.department_ids=d.departments.map(p=>+p.id),delete k.password,delete k.check_password,n.value=!0,u()},V=C(!1),E=()=>{P().then(()=>{let d={...we(a)};d.expire_time_type==1?d.expire_time=Ve(d.expire_time).unix():d.expire_time=0,d.department_ids=a.department_ids.join(","),delete d.avatar_url,V.value=!0,Ca(d).then(p=>{oe.success(`${o.value}成功`),n.value=!1,s("ok")}).finally(()=>{V.value=!1})})},H=d=>d&&d<Ve().startOf("day");return _({add:v,edit:c}),(d,p)=>{const R=Ct,M=at,F=Gt,x=Qt,L=Ot,b=Zt,T=Xt,N=St,B=fl,X=Ie,q=fe;return y(),D("div",null,[t(q,{open:n.value,"onUpdate:open":p[9]||(p[9]=m=>n.value=m),title:o.value,onOk:E,width:"746px"},{default:l(()=>[r("div",pn,[r("div",vn,[t(un,{value:a.avatar_url,"onUpdate:value":p[0]||(p[0]=m=>a.avatar_url=m),onChange:f},null,8,["value"]),mn]),t(X,{layout:"vertical",autocomplete:"off"},{default:l(()=>[r("div",fn,[t(M,ge({label:"成员昵称"},W(h).nick_name),{default:l(()=>[t(R,{maxlength:100,type:"text",placeholder:"请输入昵称",value:a.nick_name,"onUpdate:value":p[1]||(p[1]=m=>a.nick_name=m)},null,8,["value"])]),_:1},16),t(M,ge({label:"登录账号"},W(h).user_name),{default:l(()=>[t(R,{disabled:a.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:a.user_name,"onUpdate:value":p[2]||(p[2]=m=>a.user_name=m)},null,8,["disabled","value"])]),_:1},16)]),r("div",hn,[t(M,ge({label:"成员角色"},W(h).user_roles),{default:l(()=>[t(x,{value:a.user_roles,"onUpdate:value":p[3]||(p[3]=m=>a.user_roles=m),style:{width:"100%"},placeholder:"请选择成员角色"},{default:l(()=>[(y(!0),D(_e,null,Qe($.value,m=>(y(),se(F,{key:m.id,value:m.id},{default:l(()=>[O(j(m.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),t(M,ge({label:"选择部门"},W(h).department_ids,{name:"department_ids"}),{default:l(()=>[t(L,{value:a.department_ids,"onUpdate:value":p[4]||(p[4]=m=>a.department_ids=m),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":w.value,"tree-node-filter-prop":"label"},{title:l(({value:m,label:Z})=>[r("div",null,j(Z),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),r("div",gn,[a.id?te("",!0):(y(),se(M,ge({key:0,label:"登录密码"},W(h).password),{default:l(()=>[t(b,{value:a.password,"onUpdate:value":p[5]||(p[5]=m=>a.password=m),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),a.id?te("",!0):(y(),se(M,ge({key:1,label:"确认密码"},W(h).check_password),{default:l(()=>[t(b,{value:a.check_password,"onUpdate:value":p[6]||(p[6]=m=>a.check_password=m),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),r("div",yn,[t(M,ge({label:"过期时间"},W(h).expire_time,{required:""}),{default:l(()=>[t(N,{value:a.expire_time_type,"onUpdate:value":p[7]||(p[7]=m=>a.expire_time_type=m)},{default:l(()=>[t(T,{value:0},{default:l(()=>[O("永久有效")]),_:1}),t(T,{value:1},{default:l(()=>[O("指定时间")]),_:1})]),_:1},8,["value"]),a.expire_time_type==1?(y(),D("div",bn,[t(B,{showNow:!1,format:"YYYY-MM-DD HH:mm","disabled-date":H,value:a.expire_time,"onUpdate:value":p[8]||(p[8]=m=>a.expire_time=m),"show-time":{defaultValue:W(Ve)("00:00","HH:mm")}},null,8,["value","show-time"])])):te("",!0)]),_:1},16)])]),_:1})])]),_:1},8,["open","title"])])}}},wn=he(kn,[["__scopeId","data-v-e2c6d008"]]),xn={class:"form-box"},Cn={__name:"reset-password",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C(!1),o=C("重置登录密码"),a=pe({password:"",check_password:"",id:""}),w=pe({password:[{message:"请输入登录密码",required:!0},{validator:async(P,h)=>!Jt(h)&&h?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(P,h)=>h!=a.password&&h?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:u,validate:f,validateInfos:$}=i(a,w),k=P=>{P.id,n.value=!0,u(),a.password="",a.check_password="",a.id=P.id},S=()=>{f().then(()=>{Sa({...we(a)}).then(P=>{oe.success("修改成功"),n.value=!1,s("ok")})})};return _({open:k}),(P,h)=>{const v=Zt,c=at,V=Ie,E=fe;return y(),D("div",null,[t(E,{open:n.value,"onUpdate:open":h[2]||(h[2]=H=>n.value=H),title:o.value,onOk:S,width:"476px"},{default:l(()=>[r("div",xn,[t(V,{layout:"vertical"},{default:l(()=>[t(c,ge({label:"登录密码"},W($).password),{default:l(()=>[t(v,{value:a.password,"onUpdate:value":h[0]||(h[0]=H=>a.password=H),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(c,ge({label:"确认密码"},W($).check_password),{default:l(()=>[t(v,{value:a.check_password,"onUpdate:value":h[1]||(h[1]=H=>a.check_password=H),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},Sn=he(Cn,[["__scopeId","data-v-d0706fa4"]]),$n={key:0,class:"form-wrapper"},In={class:"select"},Ln={class:"tools-wrapper"},Dn=["src"],On={class:"item-name"},Tn={key:1,class:"form-wrapper"},Pn={class:"main-tabs-box"},Vn={class:"select"},En={class:"tools-wrapper"},Rn={class:"item-name"},Kn={class:"tools-wrapper"},Mn={class:"item-name"},Nn={key:2,class:"form-wrapper"},An={class:"select"},jn={class:"tools-wrapper"},Fn={class:"item-name"},Un={__name:"see-model-alert",props:{robotList:{type:Array,default:()=>[]},libraryList:{type:Array,default:()=>[]},formList:{type:Array,default:()=>[]}},emits:["save","ok"],setup(e,{expose:_,emit:g}){const s=g,i=e,n=C([]),o=C(""),a=C(!1),w=C([]),u=C([]),f=x=>{const L=[];return x.map(b=>{L.push(b.id)}),L},$=x=>{n.value=x},k=C(1),S=[{value:2,payload:{title:"部门知识库"}},{value:1,payload:{title:"成员知识库"}}],P=C(S);let h=null;const v=C(1),c=C(1),V=C(),E=async(x,L,b)=>{n.value=[],v.value=x,c.value=1,k.value=1,h=JSON.parse(JSON.stringify(b)),V.value=h.id,b=JSON.parse(JSON.stringify(b)),P.value=S,b.managed_robot_list=b.managed_robot_list||[],b.managed_library_list=b.managed_library_list||[],b.managed_form_list=b.managed_form_list||[];let T=[];x==1?(o.value="添加成员管理的机器人",T=i.robotList,T.forEach(N=>{let B=b.managed_robot_list.filter(X=>X.id==N.id);B.length?N.operate_rights=B[0].operate_rights:N.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的机器人",n.value=f(b.managed_robot_list))):x==2?(o.value="添加成员管理的知识库",T=i.libraryList,T.forEach(N=>{let B=b.managed_library_list.filter(X=>X.id==N.id);B.length?N.operate_rights=B[0].operate_rights:N.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的知识库",n.value=f(b.managed_library_list))):x==3&&(o.value="添加成员管理的数据库",T=i.formList,T.forEach(N=>{let B=b.managed_form_list.filter(X=>X.id==N.id);B.length?N.operate_rights=B[0].operate_rights:N.operate_rights="4"}),L&&L=="edit"&&(o.value="编辑成员管理的数据库",n.value=f(b.managed_form_list))),w.value=T,a.value=!0},H=()=>{qt({object_type:v.value,identity_type:c.value,identity_id:V.value,tab:c.value}).then(x=>{u.value=x.data||[]})},d=()=>{k.value==2&&H()},p=(x,L)=>{n.value=[],c.value=1,k.value=1,v.value=x,V.value=L;let b=[];x==1?(o.value="批量修改成员管理的机器人",b=i.robotList):x==2?(o.value="批量修改成员管理的知识库",b=i.libraryList):x==3&&(o.value="批量修改成员管理的数据库",b=i.formList),b.forEach(T=>{T.operate_rights="4"}),w.value=b,a.value=!0},R=(x,L,b)=>{n.value=[],L.is_user?c.value=1:c.value=2,V.value=L.id,P.value=[{value:2,payload:{title:c.value==1?"部门知识库":"上级知识库"}},{value:1,payload:{title:c.value==1?"成员知识库":"部门知识库"}}],k.value=1,v.value=x;let T=[];x==1?(o.value=`添加${c==1?"成员":"部门"}管理的机器人`,T=i.robotList):x==2?(o.value=`添加${c==1?"成员":"部门"}管理的知识库`,T=i.libraryList):x==3&&(o.value=`添加${c==1?"成员":"部门"}管理的数据库`,T=i.formList),T.forEach(N=>{let B=b.filter(X=>X.object_id==N.id);B.length?N.operate_rights=B[0].operate_rights:N.operate_rights="4"}),n.value=b.map(N=>N.object_id),w.value=T,a.value=!0},M=()=>{let x={identity_ids:V.value,identity_type:c.value,object_type:v.value},L=[];w.value.forEach(b=>{n.value.includes(b.id)&&L.push({object_id:+b.id,object_type:+v.value,operate_rights:+b.operate_rights})}),x.object_array=JSON.stringify(L),Ua(x).then(b=>{a.value=!1,oe.success("保存成功"),s("ok")})},F=()=>{};return _({open:E,handleBatchOpen:p,handleDepartmentOpen:R}),(x,L)=>{const b=$t,T=Xt,N=St,B=st,X=ea,q=fe;return y(),se(q,{class:"add-model-alert",width:"800px",open:a.value,"onUpdate:open":L[1]||(L[1]=m=>a.value=m),title:o.value,onOk:M,onCancel:F},{default:l(()=>[v.value==1?(y(),D("div",$n,[r("div",In,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"机器人","data-index":"robot_name",width:350},{default:l(({record:m})=>[r("div",Ln,[r("img",{class:"model-logo",src:m.robot_avatar,alt:""},null,8,Dn),r("div",On,j(m.robot_name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(N,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):v.value==2?(y(),D("div",Tn,[r("div",Pn,[t(X,{value:k.value,"onUpdate:value":L[0]||(L[0]=m=>k.value=m),options:P.value,onChange:d},{label:l(({payload:m})=>[O(j(m.title),1)]),_:1},8,["value","options"])]),k.value==1?(y(),D(_e,{key:0},[r("div",Vn,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"知识库","data-index":"library_name",width:350},{default:l(({record:m})=>[r("div",En,[r("div",Rn,j(m.library_name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(N,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])],64)):(y(),se(B,{key:1,"data-source":u.value,pagination:!1,scroll:{y:500},"row-key":"id"},{default:l(()=>[t(b,{title:"知识库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",Kn,[r("div",Mn,j(m.name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(N,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z,disabled:""},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source"]))])):v.value==3?(y(),D("div",Nn,[r("div",An,"已选择("+j(n.value.length)+")",1),t(B,{"data-source":w.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:n.value,onChange:$}},{default:l(()=>[t(b,{title:"数据库","data-index":"name",width:350},{default:l(({record:m})=>[r("div",jn,[r("div",Fn,j(m.name),1)])]),_:1}),t(b,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:m})=>[t(N,{value:m.operate_rights,"onUpdate:value":Z=>m.operate_rights=Z},{default:l(()=>[t(T,{value:"4"},{default:l(()=>[O("管理")]),_:1}),t(T,{value:"2"},{default:l(()=>[O("编辑")]),_:1}),t(T,{value:"1"},{default:l(()=>[O("查看")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):te("",!0)]),_:1},8,["open","title"])}}},ra=he(Un,[["__scopeId","data-v-0706de39"]]),da=e=>(Ke("data-v-0fb87f68"),e=e(),Me(),e),Hn={class:"form-box"},Bn={class:"form-item"},zn=da(()=>r("div",{class:"form-label"},"部门名称",-1)),Wn={class:"form-content"},Yn={key:0,class:"form-item"},Jn=da(()=>r("div",{class:"form-label"},"所属部门",-1)),qn={class:"form-content"},Qn={__name:"add-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=g,n=pe({department_name:"",id:"",pid:""}),o=C(""),a=k=>{n.id="",n.pid=k.id>0?k.id||"":void 0,n.department_name="",o.value="添加部门",s.value=!0,f()},w=k=>{n.id=k.id||"",n.pid=k.pid||"",n.department_name=k.title||"",o.value="重命名",s.value=!0},u=C([]),f=()=>{nt({}).then(k=>{let S=k.data||[];u.value=kt(S)})},$=()=>{if(!n.department_name)return oe.error("请输入部门名称");if(!n.id&&!n.pid)return oe.error("请选择所属部门");Ha({...n}).then(k=>{oe.success("修改成功"),s.value=!1,i("ok")})};return _({show:a,rename:w}),(k,S)=>{const P=Ct,h=Ot,v=fe;return y(),D("div",null,[t(v,{open:s.value,"onUpdate:open":S[2]||(S[2]=c=>s.value=c),title:o.value,onOk:$,width:472},{default:l(()=>[r("div",Hn,[r("div",Bn,[zn,r("div",Wn,[t(P,{maxLength:10,value:n.department_name,"onUpdate:value":S[0]||(S[0]=c=>n.department_name=c),placeholder:"请输入部门名称"},null,8,["value"])])]),n.id?te("",!0):(y(),D("div",Yn,[Jn,r("div",qn,[t(h,{value:n.pid,"onUpdate:value":S[1]||(S[1]=c=>n.pid=c),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":u.value,"tree-node-filter-prop":"label"},{title:l(({value:c,label:V})=>[r("div",null,j(V),1)]),_:1},8,["value","tree-data"])])]))])]),_:1},8,["open","title"])])}}},Gn=he(Qn,[["__scopeId","data-v-0fb87f68"]]),ot=e=>(Ke("data-v-de653ece"),e=e(),Me(),e),Xn={class:"del-box"},Zn={class:"icon-box"},es=ot(()=>r("div",{class:"top-title"},"删除部门",-1)),ts=ot(()=>r("div",{class:"content"}," 确认删除部门么？直接删除后，该部门成员归属到默认部门或设置新的部门 ",-1)),as={class:"footer-btn"},ls={class:"set-box"},ns=ot(()=>r("div",{class:"set-desc"},"删除之前请先将之前部门的成员换到其他团队",-1)),ss={class:"set-item"},os=ot(()=>r("div",{class:"set-label"},"所属部门",-1)),is={__name:"del-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=C(!1),n=g,o=pe({id:"",new_department_id:void 0});let a=[];const w=h=>{if(a=[],a=u(h),o.new_department_id=void 0,o.id=h.id,h.children.length==0){fe.confirm({title:"提示",icon:t(qe),content:"确定删除该部门",onOk(){k()}});return}s.value=!0,P()};function u(h){let v=[h.id];if(h.children&&h.children.length>0)for(const c of h.children)v=v.concat(u(c));return v}const f=()=>{i.value=!0},$=()=>{o.new_department_id="",k()},k=()=>{Ba({...o}).then(h=>{i.value=!1,s.value=!1,oe.success("删除成功"),n("ok",o.id)})},S=C([]),P=()=>{za().then(h=>{let v=h.data||[];S.value=v.filter(c=>!a.includes(+c.id))})};return _({show:w}),(h,v)=>{const c=tt,V=fe,E=Gt,H=Qt;return y(),D("div",null,[t(V,{open:s.value,"onUpdate:open":v[1]||(v[1]=d=>s.value=d),title:null,footer:null,width:480,closable:!1},{default:l(()=>[r("div",Xn,[r("div",Zn,[t(W(Ht))]),es,ts,r("div",as,[t(c,{onClick:v[0]||(v[0]=d=>s.value=!1)},{default:l(()=>[O("关闭")]),_:1}),t(c,{danger:"",onClick:$},{default:l(()=>[O("直接删除")]),_:1}),t(c,{type:"primary",onClick:f},{default:l(()=>[O("删除并设置")]),_:1})])])]),_:1},8,["open"]),t(V,{open:i.value,"onUpdate:open":v[3]||(v[3]=d=>i.value=d),title:"设置部门",width:472,onOk:k},{default:l(()=>[r("div",ls,[ns,r("div",ss,[os,r("div",null,[t(H,{value:o.new_department_id,"onUpdate:value":v[2]||(v[2]=d=>o.new_department_id=d),style:{width:"100%"},placeholder:"请选择"},{default:l(()=>[(y(!0),D(_e,null,Qe(S.value,d=>(y(),se(E,{key:d.id,value:d.id},{default:l(()=>[O(j(d.department_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])]),_:1},8,["open"])])}}},rs=he(is,[["__scopeId","data-v-de653ece"]]),Tt=e=>(Ke("data-v-f461874a"),e=e(),Me(),e),ds={class:"department-tree-search"},cs={class:"flex-block"},us={class:"tree-list-box"},_s={style:{"margin-right":"4px"}},ps={class:"action-btn toggle-btn"},vs={class:"doc-item"},ms={key:0,class:"tree-title"},fs={style:{color:"#f50"}},hs={style:{color:"#f50"}},gs={key:1,class:"tree-title"},ys={class:"use-num"},bs={key:2,class:"doc-action-box"},ks=Tt(()=>r("span",{class:"menu-name"},"添加子部门",-1)),ws=Tt(()=>r("span",{class:"menu-name"},"重命名",-1)),xs=Tt(()=>r("span",{class:"menu-name",style:{color:"#fb363f"}},"删 除",-1)),Cs={__name:"department-tree",emits:["select","save","refresh"],setup(e,{expose:_,emit:g}){const s=g;let i=[];const n=[],o=(x,L)=>{let b;for(let T=0;T<L.length;T++){const N=L[T];N.children&&(N.children.some(B=>B.key===x)?b=N.key:o(x,N.children)&&(b=o(x,N.children)))}return b},a=C([]),w=C([]),u=C(""),f=C(!0),$=C([]);let k="",S={};const P=x=>{a.value=x,f.value=!1};Re(u,x=>{const L=n.map(b=>b.title.indexOf(x)>-1?o(b.key,$.value):null).filter((b,T,N)=>b&&N.indexOf(b)===T);a.value=L,u.value=x,f.value=!0});const h=x=>{for(let L=0;L<x.length;L++){const b=x[L],T=b.key;n.push({key:T,title:b.title}),b.children&&h(b.children)}},v=x=>{nt({}).then(L=>{let b=L.data||[];i=[],i=$a(b),h(i),$.value=i,x&&(b.forEach(T=>{T.is_default==1&&(k=T.id,S=T)}),Ze(()=>{k&&(w.value=[k],s("select",S))}))})};v(!0);let c={};const V=x=>{w.value[0]==x?Ze(()=>{k&&(w.value=[k],s("select",S))}):s("refresh"),v()},E=C(),H=x=>{E.value.show(x)},d=x=>{E.value.rename(x)},p=(x,L)=>{L.node.is_user,L.node.id,L.selected||Ze(()=>{w.value=[L.node.id]}),c={...L.node},s("select",c)},R=C(null),M=x=>{R.value.show(x)},F=()=>{v(),s("refresh")};return _({getLists:v}),(x,L)=>{const b=It,T=na,N=la,B=aa,X=ta,q=il;return y(),D(_e,null,[r("div",ds,[r("div",cs,[t(b,{value:u.value,"onUpdate:value":L[0]||(L[0]=m=>u.value=m),placeholder:"搜索部门",style:{flex:"1"}},null,8,["value"]),r("div",{class:"add-btn-box",onClick:L[1]||(L[1]=m=>H({}))},[t(W(lt))])]),r("div",us,[t(q,{"expanded-keys":a.value,selectedKeys:w.value,"onUpdate:selectedKeys":L[3]||(L[3]=m=>w.value=m),"auto-expand-parent":f.value,onSelect:p,"tree-data":$.value,blockNode:"",onExpand:P},{switcherIcon:l(({switcherCls:m})=>[r("div",_s,[r("span",ps,[t(W(yl),{style:{"font-size":"12px"},class:zt(m)},null,8,["class"])])])]),title:l(m=>[r("div",vs,[m.title.indexOf(u.value)>-1&&u.value?(y(),D("span",ms,[m.title.length>3&&m.level>3?(y(),se(T,{key:0},{title:l(()=>[O(j(m.title),1)]),default:l(()=>[O(" "+j(m.title.substring(0,m.title.indexOf(u.value)))+" ",1),r("span",fs,j(u.value),1),O(" "+j(m.title.substring(m.title.indexOf(u.value)+u.value.length)),1)]),_:2},1024)):(y(),D(_e,{key:1},[O(j(m.title.substring(0,m.title.indexOf(u.value)))+" ",1),r("span",hs,j(u.value),1),O(" "+j(m.title.substring(m.title.indexOf(u.value)+u.value.length)),1)],64))])):(y(),D("span",gs,[m.title.length>3&&m.level>3?(y(),se(T,{key:0},{title:l(()=>[O(j(m.title),1)]),default:l(()=>[O(" "+j(m.title),1)]),_:2},1024)):(y(),D(_e,{key:1},[O(j(m.title),1)],64))])),r("div",ys,j(m.children_nums),1),m.is_user?te("",!0):(y(),D("div",bs,[t(X,null,{overlay:l(()=>[t(B,null,{default:l(()=>[t(N,{key:"addDoc",onClick:Xe(Z=>H(m),["stop","prevent"])},{default:l(()=>[ks]),_:2},1032,["onClick"]),t(N,{key:"importDoc",onClick:Xe(Z=>d(m),["stop","prevent"])},{default:l(()=>[ws]),_:2},1032,["onClick"]),m.is_default!=1?(y(),se(N,{key:"del",onClick:Xe(Z=>M(m),["stop","prevent"])},{default:l(()=>[xs]),_:2},1032,["onClick"])):te("",!0)]),_:2},1024)]),default:l(()=>[r("span",{class:"action-btn",onClick:L[2]||(L[2]=Xe(()=>{},["stop"]))},[t(W(gl))])]),_:2},1024)]))])]),_:1},8,["expanded-keys","selectedKeys","auto-expand-parent","tree-data"])])]),t(Gn,{ref_key:"addDepartmentRef",ref:E,onOk:F},null,512),t(rs,{ref_key:"delDepartmentRef",ref:R,onOk:V},null,512)],64)}}},Ss=he(Cs,[["__scopeId","data-v-f461874a"]]),Ue=e=>(Ke("data-v-d9967a89"),e=e(),Me(),e),$s={class:"main-content-box"},Is={style:{"margin-top":"12px"}},Ls={key:0},Ds={key:1},Os={key:2},Ts={class:"list-content"},Ps={key:0},Vs={key:1},Es={key:2},Rs={key:0,class:"user-block"},Ks={class:"role-menu-box"},Ms=["onClick"],Ns={class:"menu-header"},As=Ue(()=>r("span",{class:"title"},"管理",-1)),js=Ue(()=>r("div",{class:"desc"},"可编辑，可删除，可查看",-1)),Fs={key:0,class:"check-box"},Us=["onClick"],Hs={class:"menu-header"},Bs=Ue(()=>r("span",{class:"title"},"编辑",-1)),zs=Ue(()=>r("div",{class:"desc"},"可编辑，可查看",-1)),Ws={key:0,class:"check-box"},Ys=["onClick"],Js={class:"menu-header"},qs=Ue(()=>r("span",{class:"title"},"查看",-1)),Qs=Ue(()=>r("div",{class:"desc"},"仅查看",-1)),Gs={key:0,class:"check-box"},Xs={class:"hover-btn-box"},Zs={key:0},eo={key:1},to={key:2},ao=["onClick"],lo={__name:"knowledge-permissions",props:{treeParmas:{type:Object,default:()=>({})}},setup(e){const _=C("2"),g=C([]),s=e;Re(()=>s.treeParmas,c=>{i()},{deep:!0});const i=()=>{qt({object_type:_.value,identity_type:s.treeParmas.is_user?1:2,identity_id:s.treeParmas.id}).then(c=>{let V=c.data||[];g.value=V})};i();const n=()=>{i()},o=(c,V)=>{let E=V==4?"管理":V==2?"编辑":"查看";fe.confirm({title:"提示?",icon:t(qe),content:"确认修改该数据权限为【"+E+"】",okText:"确认",cancelText:"取消",onOk:()=>{let H=[{object_id:+c.object_id,object_type:+c.object_type,operate_rights:+V}];Wa({identity_ids:c.identity_id,identity_type:2,object_array:JSON.stringify(H)}).then(d=>{oe.success("修改成功"),i()})},onCancel(){}})},a=c=>{fe.confirm({title:"提示?",icon:t(qe),content:"确认删除该条数据",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ya({identity_id:c.identity_id,identity_type:2,object_id:c.object_id,object_type:c.object_type}).then(V=>{oe.success("删除成功"),i()})},onCancel(){}})},w=C([]),u=C([]),f=C([]),$=async()=>{await Wt().then(c=>{w.value=c.data}).catch(()=>{})},k=async()=>{await Bt({type:""}).then(c=>{u.value=c.data}).catch(()=>{})},S=async()=>{await Yt().then(c=>{f.value=c.data}).catch(()=>{})},P=C(null),h=async()=>{if(!s.treeParmas.id)return oe.error("请先选择部门");let c=_.value;c==1?await $():c==2?await k():c==3&&await S(),P.value.handleDepartmentOpen(c,s.treeParmas,g.value)},v=C([{dataIndex:"name",key:"name"},{title:"权限",dataIndex:"role",key:"role"},{title:"操作",dataIndex:"action",key:"action",width:80}]);return(c,V)=>{const E=ml,H=St,d=tt,p=bl,R=st;return y(),D(_e,null,[r("div",$s,[t(H,{value:_.value,"onUpdate:value":V[0]||(V[0]=M=>_.value=M),onChange:n},{default:l(()=>[t(E,{value:"2"},{default:l(()=>[O("知识库")]),_:1}),t(E,{value:"1"},{default:l(()=>[O("机器人")]),_:1}),t(E,{value:"3"},{default:l(()=>[O("数据库")]),_:1})]),_:1},8,["value"]),r("div",Is,[t(d,{type:"primary",onClick:h},{default:l(()=>[_.value==2?(y(),D("span",Ls,"添加知识库权限")):te("",!0),_.value==1?(y(),D("span",Ds,"添加机器人权限")):te("",!0),_.value==3?(y(),D("span",Os,"添加数据库权限")):te("",!0)]),_:1})]),r("div",Ts,[t(R,{columns:v.value,"data-source":g.value,pagination:!1},{headerCell:l(({column:M})=>[M.key==="name"?(y(),D(_e,{key:0},[_.value==2?(y(),D("span",Ps,"知识库")):te("",!0),_.value==1?(y(),D("span",Vs,"机器人")):te("",!0),_.value==3?(y(),D("span",Es,"数据库")):te("",!0)],64)):te("",!0)]),bodyCell:l(({column:M,record:F})=>[M.key==="name"?(y(),D("div",Rs,j(F.name),1)):te("",!0),M.key==="role"?(y(),se(p,{key:1,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:l(()=>[r("div",Ks,[r("div",{class:"role-menu",onClick:x=>o(F,4)},[r("div",Ns,[t(W(wl)),As]),js,F.operate_rights==4?(y(),D("div",Fs,[t(W(vt))])):te("",!0)],8,Ms),r("div",{class:"role-menu",onClick:x=>o(F,2)},[r("div",Hs,[t(W(xl)),Bs]),zs,F.operate_rights==2?(y(),D("div",Ws,[t(W(vt))])):te("",!0)],8,Us),r("div",{class:"role-menu",onClick:x=>o(F,1)},[r("div",Js,[t(W(hl)),qs]),Qs,F.operate_rights==1?(y(),D("div",Gs,[t(W(vt))])):te("",!0)],8,Ys)])]),default:l(()=>[r("div",Xs,[F.operate_rights==4?(y(),D("span",Zs,"管理")):te("",!0),F.operate_rights==2?(y(),D("span",eo,"编辑")):te("",!0),F.operate_rights==1?(y(),D("span",to,"查看")):te("",!0),t(W(kl))])]),_:2},1024)):te("",!0),M.key==="action"?(y(),D("a",{key:2,onClick:x=>a(F)},"删除",8,ao)):te("",!0)]),_:1},8,["columns","data-source"])])]),t(ra,{ref_key:"seeModelAlertRef",ref:P,robotList:w.value,libraryList:u.value,formList:f.value,onOk:i},null,8,["robotList","libraryList","formList"])],64)}}},no=he(lo,[["__scopeId","data-v-d9967a89"]]),so={__name:"batch-edit-department",emits:["ok"],setup(e,{expose:_,emit:g}){const s=C(!1),i=g,n=Ie.useForm,o=pe({user_ids:"",department_ids:[]}),a=pe({department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:w,validate:u,validateInfos:f}=n(o,a),$=v=>{o.user_ids=v,o.department_ids=[],s.value=!0,S()},k=C([]),S=()=>{nt({}).then(v=>{let c=v.data||[];k.value=kt(c)})},P=C(!1),h=()=>{u().then(()=>{let v={...o};v.department_ids=o.department_ids.join(","),P.value=!0,Ja(v).then(c=>{oe.success("批量修改部门成功"),s.value=!1,i("ok")}).finally(()=>{P.value=!1})})};return _({show:$}),(v,c)=>{const V=Ot,E=at,H=Ie,d=fe;return y(),D("div",null,[t(d,{open:s.value,"onUpdate:open":c[1]||(c[1]=p=>s.value=p),title:"批量修改部门",onOk:h,confirmLoading:P.value},{default:l(()=>[t(H,{layout:"vertical",style:{"margin-top":"24px"}},{default:l(()=>[t(E,ge({label:"选择部门"},W(f).department_ids),{default:l(()=>[t(V,{value:o.department_ids,"onUpdate:value":c[0]||(c[0]=p=>o.department_ids=p),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":k.value,"tree-node-filter-prop":"label"},{title:l(({value:p,label:R})=>[r("div",null,j(R),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),_:1})]),_:1},8,["open","confirmLoading"])])}}},He=e=>(Ke("data-v-928accdd"),e=e(),Me(),e),oo={class:"flex-content-box"},io={class:"left-department-box"},ro={class:"team-members-pages"},co={class:"main-tabs-block"},uo={class:"list-box"},_o={class:"user-box"},po=["src"],vo={class:"name-info"},mo={class:"user-name"},fo={class:"nick-name"},ho={key:0,class:"list-content"},go={key:1,class:"list-preview list-content"},yo={style:{display:"inline"}},bo={class:"list-item-box"},ko={class:"list-item"},wo={key:0,class:"list-content"},xo=He(()=>r("div",null,"全部",-1)),Co=[xo],So={key:1,class:"list-content"},$o=["onClick"],Io={key:2,class:"list-preview list-content"},Lo={style:{display:"inline"}},Do={class:"list-item-box"},Oo={class:"list-item"},To=["onClick"],Po={key:0,class:"list-content"},Vo=He(()=>r("div",null,"全部",-1)),Eo=[Vo],Ro={key:1,class:"list-content"},Ko=["onClick"],Mo={key:2,class:"list-preview list-content"},No={style:{display:"inline"}},Ao={class:"list-item-box"},jo={class:"list-item"},Fo=["onClick"],Uo={key:0,class:"list-content"},Ho=He(()=>r("div",null,"全部",-1)),Bo=[Ho],zo={key:1,class:"list-content"},Wo=["onClick"],Yo={key:2,class:"list-preview list-content"},Jo={style:{display:"inline"}},qo={class:"list-item-box"},Qo={class:"list-item"},Go=["onClick"],Xo={key:0,class:"status-block green"},Zo={key:1,class:"status-block yellow"},ei=He(()=>r("span",{class:"disabled"},"编辑",-1)),ti=He(()=>r("span",{class:"disabled"},"重置密码",-1)),ai=He(()=>r("span",{class:"disabled"},"删除",-1)),li=["onClick"],ni=["onClick"],si=["onClick"],oi={__name:"team-members",setup(e){const _=C(1),g=[{value:1,payload:{title:"团队成员"}},{value:2,payload:{title:"知识库权限"}}],s=pe({page:1,size:10,total:0,search:""}),i=C([]),n=C([]),o=C([]),a=C(null),w=A=>{s.page=A.current,s.size=A.pageSize,h()},u=pe({id:""}),f=A=>{Object.assign(u,{...A}),_.value==1&&$()},$=()=>{s.page=1,h()},k=C([]),S=A=>{let J=[];return A.map(ie=>{J.push(ie.name||ie.department_name)}),J.join(", ")},P=C(!1),h=()=>{let A={page:s.page,size:s.size,search:s.search};u.id&&u.is_default!=1&&(A.department_id=u.id),P.value=!0,Da(A).then(J=>{let ie=J.data.list;ie.forEach(K=>{K.create_time=Ve(K.create_time*1e3).format("YYYY-MM-DD HH:mm"),K.expire_time_desc=K.expire_time=="0"?"永久有效":Ve(K.expire_time*1e3).format("YYYY-MM-DD HH:mm"),K.expire_status=0,(K.expire_time=="0"||Ve().unix()<K.expire_time)&&(K.expire_status=1),K.managed_robot_list=K.managed_robot_list?JSON.parse(K.managed_robot_list):[],K.managed_library_list=K.managed_library_list?JSON.parse(K.managed_library_list):[],K.managed_form_list=K.managed_form_list?JSON.parse(K.managed_form_list):[],K.departments=K.departments?JSON.parse(K.departments):[]}),k.value=ie,E.selectedRowKeys=[],s.total=+J.data.total}).finally(()=>{P.value=!1})},v=()=>{_.value==1&&$()},c=C(null),V=()=>{h(),c.value.getLists()},E=pe({selectedRowKeys:[]}),H=A=>{E.selectedRowKeys=A},d=A=>({disabled:A.role_type==1}),p=A=>{Oa({user_id:A.id}).then(J=>{oe.success(A.login_switch==1?"关闭成功":"开启成功"),h()})},R=C(null),M=()=>{R.value.add(u.id)},F=A=>{R.value.edit(A)},x=C(null),L=A=>{x.value.open(A)},b=A=>{fe.confirm({title:"提示?",icon:t(qe),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ta({id:A.id}).then(J=>{oe.success("删除成功"),h()})},onCancel(){}})},T=async()=>{await Wt().then(A=>{i.value=A.data}).catch(()=>{})},N=async()=>{await Bt({type:""}).then(A=>{n.value=A.data}).catch(()=>{})},B=async()=>{await Yt().then(A=>{o.value=A.data}).catch(()=>{})},X=async A=>{let J=[];if(E.selectedRowKeys.forEach(ie=>{k.value.filter(ee=>ee.id==ie)[0].role_type==1||J.push(ie)}),E.selectedRowKeys=J,E.selectedRowKeys.length==0)return oe.error("请选择要修改的成员");A==1?await T():A==2?await N():A==3&&await B(),a.value.handleBatchOpen(A,E.selectedRowKeys.join(","))},q=C(null),m=()=>{if(E.selectedRowKeys.length==0)return oe.error("请选择要修改的成员");q.value.show(E.selectedRowKeys.join(","))},Z=async(A,J)=>{A==1?await T():A==2?await N():A==3&&await B(),a.value.open(A,"add",J)},xe=async(A,J)=>{A==1?await T():A==2?await N():A==3&&await B(),a.value.open(A,"edit",J)};return(A,J)=>{const ie=ja,K=ea,ee=tt,ce=la,Ce=aa,Be=ta,Le=Lt,ze=It,ve=na,ue=$t,De=Ia,We=Cl,Ye=st;return y(),D("div",oo,[r("div",io,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[t(Ss,{ref_key:"departmentTreeRef",ref:c,onSelect:f,onRefresh:h},null,512)]),_:1})]),r("div",ro,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[r("div",co,[t(K,{value:_.value,"onUpdate:value":J[0]||(J[0]=I=>_.value=I),options:g,onChange:v},{label:l(({payload:I})=>[O(j(I.title),1)]),_:1},8,["value"])]),_.value==1?(y(),D(_e,{key:0},[t(Le,{justify:"space-between"},{default:l(()=>[t(Le,{gap:8},{default:l(()=>[t(ee,{type:"primary",onClick:M},{icon:l(()=>[t(W(lt))]),default:l(()=>[O(" 添加团队成员 ")]),_:1}),t(Be,null,{overlay:l(()=>[t(Ce,null,{default:l(()=>[t(ce,{onClick:J[1]||(J[1]=I=>X(1))},{default:l(()=>[O(" 修改机器人 ")]),_:1}),t(ce,{onClick:J[2]||(J[2]=I=>X(2))},{default:l(()=>[O(" 修改知识库 ")]),_:1}),t(ce,{onClick:J[3]||(J[3]=I=>X(3))},{default:l(()=>[O(" 修改数据库 ")]),_:1})]),_:1})]),default:l(()=>[t(ee,null,{default:l(()=>[O("批量修改权限")]),_:1})]),_:1}),t(ee,{onClick:m},{default:l(()=>[O("批量修改部门")]),_:1})]),_:1}),t(ze,{value:s.search,"onUpdate:value":J[4]||(J[4]=I=>s.search=I),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:$},null,8,["value"])]),_:1}),r("div",uo,[t(Ye,{"data-source":k.value,scroll:{x:1100},loading:P.value,"row-key":"id","row-selection":{selectedRowKeys:E.selectedRowKeys,onChange:H,getCheckboxProps:d},pagination:{current:s.page,total:s.total,pageSize:s.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:w},{default:l(()=>[t(ue,{title:"成员名称","data-index":"user_name",width:"190px"},{default:l(({record:I})=>[r("div",_o,[r("img",{src:I.avatar||W(ht),alt:""},null,8,po),r("div",vo,[r("div",mo,[I.user_name&&I.user_name.length>7?(y(),se(ve,{key:0,title:I.user_name},{default:l(()=>[O(j(I.user_name),1)]),_:2},1032,["title"])):(y(),D(_e,{key:1},[O(j(I.user_name),1)],64))]),r("div",fo,[I.nick_name&&I.nick_name.length>7?(y(),se(ve,{key:0,title:I.nick_name},{default:l(()=>[O(j(I.nick_name),1)]),_:2},1032,["title"])):(y(),D(_e,{key:1},[O(j(I.nick_name),1)],64))])])])]),_:1}),t(ue,{title:"角色","data-index":"role_name",width:"100px"},{default:l(({record:I})=>[O(j(I.role_name),1)]),_:1}),t(ue,{"data-index":"departments",width:"200px"},{title:l(()=>[O(" 部门 ")]),default:l(({record:I})=>[I.departments&&I.departments.length==0?(y(),D("div",ho," -- ")):(y(),D("div",go,[t(ve,null,{title:l(()=>[r("div",yo,j(S(I.departments)),1)]),default:l(()=>[r("div",bo,[r("div",ko,j(S(I.departments)),1)])]),_:2},1024)]))]),_:1}),t(ue,{"data-index":"managed_robot_list",width:"200px"},{title:l(()=>[O(" 管理的机器人 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部机器人，成员只能管理分配的机器人。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",wo,Co)):I.managed_robot_list?(y(),D("div",Io,[t(ve,null,{title:l(()=>[r("div",Lo,j(S(I.managed_robot_list)),1)]),default:l(()=>[r("div",Do,[r("div",Oo,j(S(I.managed_robot_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(1,I)},[t(De,{name:"edit"})],8,To)])):(y(),D("div",So,[r("div",{class:"list-highlight",onClick:me=>Z(1,I)},"添加",8,$o)]))]),_:1}),t(ue,{"data-index":"managed_library_list",width:"200px"},{title:l(()=>[O(" 管理的知识库 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部知识库，成员只能管理分配的知识库。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",Po,Eo)):I.managed_library_list?(y(),D("div",Mo,[t(ve,null,{title:l(()=>[r("div",No,j(S(I.managed_library_list)),1)]),default:l(()=>[r("div",Ao,[r("div",jo,j(S(I.managed_library_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(2,I)},[t(De,{name:"edit"})],8,Fo)])):(y(),D("div",Ro,[r("div",{class:"list-highlight",onClick:me=>Z(2,I)},"添加",8,Ko)]))]),_:1}),t(ue,{"data-index":"managed_form_list",width:"200px"},{title:l(()=>[O(" 管理的数据库 "),t(ve,null,{title:l(()=>[O("所有者和管理员可以创建和管理全部数据库，成员只能管理分配的数据库。")]),default:l(()=>[t(W(mt))]),_:1})]),default:l(({record:I})=>[I.role_type==1?(y(),D("div",Uo,Bo)):I.managed_form_list?(y(),D("div",Yo,[t(ve,null,{title:l(()=>[r("div",Jo,j(S(I.managed_form_list)),1)]),default:l(()=>[r("div",qo,[r("div",Qo,j(S(I.managed_form_list)),1)])]),_:2},1024),r("div",{class:"list-highlight edit",onClick:me=>xe(3,I)},[t(De,{name:"edit"})],8,Go)])):(y(),D("div",zo,[r("div",{class:"list-highlight",onClick:me=>Z(3,I)},"添加",8,Wo)]))]),_:1}),t(ue,{title:"状态","data-index":"expire_status",width:"120px"},{default:l(({record:I})=>[I.expire_status==1?(y(),D("div",Xo,[t(W(La)),O("生效中 ")])):te("",!0),I.expire_status==0?(y(),D("div",Zo,[t(W(Ht)),O("已过期 ")])):te("",!0)]),_:1}),t(ue,{title:"过期时间","data-index":"expire_time_desc",width:"130px"},{default:l(({record:I})=>[O(j(I.expire_time_desc),1)]),_:1}),t(ue,{title:"登录","data-index":"login_switch",width:"90px",fixed:"right"},{default:l(({record:I})=>[t(We,{onChange:me=>p(I),checked:I.login_switch=="1",disabled:I.role_type=="1","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked","disabled"])]),_:1}),t(ue,{title:"操作","data-index":"action",width:"176px",fixed:"right"},{default:l(({record:I})=>[I.role_type=="1"?(y(),se(Le,{key:0,gap:16},{default:l(()=>[ei,ti,ai]),_:1})):(y(),se(Le,{key:1,gap:16},{default:l(()=>[r("a",{onClick:me=>F(I)},"编辑",8,li),r("a",{onClick:me=>L(I)},"重置密码",8,ni),r("a",{onClick:me=>b(I)},"删除",8,si)]),_:2},1024))]),_:1})]),_:1},8,["data-source","loading","row-selection","pagination"])])],64)):(y(),se(no,{key:1,treeParmas:u},null,8,["treeParmas"]))]),_:1}),t(wn,{ref_key:"addTeamMembersRef",ref:R,onOk:V},null,512),t(Sn,{ref_key:"resetPasswordRef",ref:x,onOk:h},null,512),t(ra,{ref_key:"seeModelAlertRef",ref:a,robotList:i.value,libraryList:n.value,formList:o.value,onOk:h},null,8,["robotList","libraryList","formList"]),t(so,{ref_key:"batchEditDepartmentRef",ref:q,onOk:V},null,512)])])}}},ii=he(oi,[["__scopeId","data-v-928accdd"]]),ri={class:"form-box"},di={class:"title-row"},ci={class:"check-num"},ui={__name:"add-role",emits:["ok"],setup(e,{expose:_,emit:g}){const s=g,i=Ie.useForm,n=C([]),o=C({}),a=C(!1),w=C("添加角色"),u=C(""),f=pe({name:"",mark:"",role_type:""}),$=pe({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:k,validate:S,validateInfos:P}=i(f,$),h=async()=>{await Pa().then(d=>{n.value=d.data;for(let p=0;p<d.data.length;p++){const R=d.data[p];o.value[R.uni_key]=[]}})},v=async()=>{await h(),w.value="添加角色",u.value="",a.value=!0,f.name="",f.mark="",k()},c=d=>{w.value="编辑角色",u.value=d.id,Va({id:d.id}).then(p=>{let R=p.data,M=R.role_permission||[];f.name=R.name,f.mark=R.mark,f.role_type=R.role_type,o.value=V(n.value,M),a.value=!0})},V=(d,p)=>{let R={};return d.forEach(M=>{R[M.uni_key]=[];for(let F=0;F<M.children.length;F++){const x=M.children[F];p.includes(x.uni_key)&&R[M.uni_key].push(x.uni_key)}}),R},E=d=>{let p=[];for(let R in d)d[R].map(F=>{p.push(F)});return p},H=()=>{S().then(()=>{let d=E(o.value),p={id:u.value,mark:f.mark};f.role_type==0&&(p.name=f.name,p.role_type=f.role_type,p.uni_keys=d.join(",")),Ea(p).then(R=>{a.value=!1,oe.success("保存成功"),s("ok")})})};return Aa(()=>{h()}),_({add:v,edit:c}),(d,p)=>{const R=Ct,M=at,F=Sl,x=Lt,L=Il,b=Dl,T=Ll,N=$l,B=Ie,X=fe;return y(),D("div",null,[t(X,{open:a.value,"onUpdate:open":p[2]||(p[2]=q=>a.value=q),title:w.value,onOk:H,width:"746px"},{default:l(()=>[r("div",ri,[t(B,{layout:"vertical"},{default:l(()=>[t(M,ge({label:"角色名称"},W(P).name),{default:l(()=>[t(R,{type:"text",maxlength:100,disabled:f.role_type>0,placeholder:"请输入角色名称",value:f.name,"onUpdate:value":p[0]||(p[0]=q=>f.name=q)},null,8,["disabled","value"])]),_:1},16),t(M,{label:"角色备注"},{default:l(()=>[t(F,{value:f.mark,"onUpdate:value":p[1]||(p[1]=q=>f.mark=q),placeholder:"请输入角色备注"},null,8,["value"])]),_:1}),t(M,{label:"角色权限"},{default:l(()=>[(y(!0),D(_e,null,Qe(n.value,q=>(y(),D("div",{class:"role-check-box",key:q.uni_key},[t(x,{class:"title-boock",justify:"space-between"},{default:l(()=>[r("div",di,j(q.name),1),r("div",ci,j(o.value[q.uni_key].length)+"/"+j(q.children.length),1)]),_:2},1024),t(N,{value:o.value[q.uni_key],"onUpdate:value":m=>o.value[q.uni_key]=m,style:{width:"100%"}},{default:l(()=>[t(T,{gutter:[0,12]},{default:l(()=>[(y(!0),D(_e,null,Qe(q.children,m=>(y(),se(b,{span:6,key:m.uni_key},{default:l(()=>[t(L,{disabled:f.role_type>0,value:m.uni_key},{default:l(()=>[O(j(m.name),1)]),_:2},1032,["disabled","value"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])]))),128))]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},_i=he(ui,[["__scopeId","data-v-bb48065b"]]),pi={class:"team-members-pages"},vi={class:"list-box"},mi={__name:"role-permissions",setup(e){C("");const _=pe({page:1,size:10,total:0,search:""}),g=C([{}]),s=f=>{_.page=f.current,_.size=f.pageSize,n()},i=()=>{_.page=1,n()},n=()=>{let f={page:_.page,size:_.size,search:_.search};Ut(f).then($=>{let k=$.data.list;k.forEach(S=>{S.update_time=Ve(S.update_time*1e3).format("YYYY-MM-DD HH:mm")}),g.value=k,_.total=+$.data.total})};i();const o=C(null),a=()=>{o.value.add()},w=f=>{o.value.edit(f)},u=f=>{fe.confirm({title:"提示?",icon:t(qe),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ra({id:f.id}).then($=>{oe.success("删除成功"),n()})},onCancel(){}})};return(f,$)=>{const k=tt,S=It,P=Lt,h=$t,v=st;return y(),D("div",pi,[t(P,{justify:"space-between"},{default:l(()=>[t(k,{type:"primary",onClick:a},{icon:l(()=>[t(W(lt))]),default:l(()=>[O(" 添加角色 ")]),_:1}),t(S,{value:_.search,"onUpdate:value":$[0]||($[0]=c=>_.search=c),placeholder:"输入角色名称",style:{width:"288px"},onSearch:i},null,8,["value"])]),_:1}),r("div",vi,[t(v,{"data-source":g.value,pagination:{current:_.page,total:_.total,pageSize:_.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:s},{default:l(()=>[t(h,{title:"角色","data-index":"name",width:"157px"},{default:l(({record:c})=>[O(j(c.name),1)]),_:1}),t(h,{title:"备注","data-index":"mark",width:"480px"},{default:l(({record:c})=>[O(j(c.mark),1)]),_:1}),t(h,{title:"最近修改时间","data-index":"update_time",width:"150px"},{default:l(({record:c})=>[O(j(c.update_time),1)]),_:1}),t(h,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:l(({record:c})=>[O(j(c.operate_name),1)]),_:1}),t(h,{title:"创建人","data-index":"create_name",width:"130px"},{default:l(({record:c})=>[O(j(c.create_name),1)]),_:1}),t(h,{title:"操作","data-index":"action",width:"178px"},{default:l(({record:c})=>[t(P,{gap:16,class:"action-box"},{default:l(()=>[t(k,{type:"link",onClick:V=>w(c)},{default:l(()=>[O("编辑")]),_:2},1032,["onClick"]),t(k,{type:"link",onClick:V=>u(c),disabled:c.role_type<=3&&c.role_type>0},{default:l(()=>[O("删除")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),t(_i,{ref_key:"addRoleRef",ref:o,onOk:n},null,512)])}}},fi=he(mi,[["__scopeId","data-v-e2c92e52"]]),hi={class:"user-model-page"},gi={class:"list-wrapper"},yi={__name:"index",setup(e){const _=C(1),g=()=>{_.value};return(s,i)=>(y(),D("div",hi,[t(an,{value:_.value,"onUpdate:value":i[0]||(i[0]=n=>_.value=n),onChange:g},null,8,["value"]),r("div",gi,[_.value==1?(y(),se(ii,{key:0})):(y(),se(fi,{key:1}))])]))}},Mr=he(yi,[["__scopeId","data-v-752bf84e"]]);export{Mr as default};
