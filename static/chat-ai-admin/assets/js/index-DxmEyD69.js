import{e as C,a4 as V,B as T,M as m,N as f,k as t,S as e,ad as R,ah as B,u as s,Y as i,F as z,a0 as X,Z as _,W as r,a1 as L,a2 as D}from"./vue-chunks-Dagx-vSq.js";import{c as ee,f as te,u as oe,h as ne}from"./index-P937V9jP.js";import{b as E,M as A,k as M,B as ie,E as ae}from"../../index-uZrSGPJ2.js";import{F as U,_ as le}from"./index-BuYscfp6.js";import"./index-Jtlfy8YK.js";import{I as se}from"./Input-CkgxEQH_.js";import{Q as p}from"./QuestionCircleOutlined-DaqtyhFd.js";import{S as re,a as de}from"./index-CbTVyCU8.js";import{_ as J}from"./index-EWP4miKO.js";import{_ as Q}from"./index-BaDCixtO.js";import{P as ue}from"./PlusOutlined-C4d6M8_0.js";import{a as pe,_ as ce}from"./index-ByxtaxSL.js";import{_ as _e}from"./index-CveYuLtq.js";import"./axios-BZ84_VUH.js";import"./qs-CSiAN3u4.js";import"./crypto-js-DN0vhd75.js";import"./dayjs-CZ5VaChI.js";import"./Trigger-DoXVYhN4.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-CAcuZItg.js";import"./responsiveObserve-FU3Dn2XC.js";import"./collapseMotion-D5mGic4t.js";import"./FormItemContext-Cs8-ygLw.js";import"./index-CJgvF6wP.js";import"./Search-B1xKt77Y.js";import"./SearchOutlined--FowkdKA.js";import"./inputProps-CFzerOIV.js";import"./TextArea-CjFwG0DD.js";import"./index-BIs6ICi9.js";import"./Password-DhHqQ7fn.js";import"./slide-BIPMUmGB.js";import"./CheckOutlined-l1N7JgI5.js";import"./DownOutlined-CJyYwwtm.js";import"./move-Cj-Coe07.js";import"./colors-Bq--hzfJ.js";import"./index-Dcu1AEuu.js";import"./useMaxLevel-G_tCMKFf.js";import"./CaretDownFilled-DFwBTbBj.js";import"./index-BQH61rer.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-CM4FzrBV.js";import"./LeftOutlined-q_SFvfQo.js";import"./RightOutlined-BOG0y4Nw.js";import"./index-DvpvmHbh.js";import"./Checkbox-SbuG5kqh.js";import"./index-o3ZFs3wF.js";import"./dropdown-DE5F1xap.js";import"./index-DGr8yI5G.js";import"./shallowequal-CI97GdPH.js";import"./index-BZeZ1Fpr.js";import"./RadioButton-B7NLGGfS.js";import"./CaretDownOutlined-BrBGZpG7.js";const j=d=>(L("data-v-5fc90fd7"),d=d(),D(),d),me={class:"add-data-sheet"},fe=j(()=>r("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1)),he=j(()=>r("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)),ve={__name:"add-field-modal",emits:["ok"],setup(d,{expose:N,emit:b}){const k=C("添加字段"),S=V().query,h=C(!1),q=b,x=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],o=T({name:"",description:"",type:void 0,required:"false",form_id:S.form_id,id:""}),v=n=>{h.value=!0,c(),o.name=n.name||"",o.description=n.description||"",o.type=n.type,o.required=n.required,o.id=n.id||"",k.value=n.id?"编辑字段":"添加字段"},$=T({name:[{required:!0,validator:async(n,a)=>/^[a-z][a-z0-9_]*$/.test(a)?Promise.resolve():Promise.reject("必须以英文字母开头，只能包含小写字母、数字、下划线")}],description:[{required:!0,message:"请输入字段描述"}],type:[{required:!0,message:"请选择数据类型"}]}),u=U.useForm,{resetFields:c,validate:O,validateInfos:g}=u(o,$),I=()=>{O().then(()=>{ee(o).then(n=>{let a=o.id?"修改成功":"新增成功";M.success(a),h.value=!1,q("ok")})})};return N({show:v}),(n,a)=>{const F=J,P=se,w=le,Y=de,Z=re,G=Q,H=U,K=A;return f(),m("div",me,[t(K,{open:h.value,"onUpdate:open":a[4]||(a[4]=l=>h.value=l),title:k.value,onOk:I,width:540},{default:e(()=>[t(H,{layout:"vertical"},{default:e(()=>[t(w,R(B(s(g).name)),{label:e(()=>[i("字段名称  "),t(F,null,{title:e(()=>[i("定义数据表的表头，可以在对应表头下存储相关数据。")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(P,{maxLength:64,value:o.name,"onUpdate:value":a[0]||(a[0]=l=>o.name=l),placeholder:"请输入字段名称"},null,8,["value"])]),_:1},16),t(w,R(B(s(g).description)),{label:e(()=>[i("字段描述  "),t(F,null,{title:e(()=>[i("表头字段的说明，帮助用户或大模型理解表头字段")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(P,{maxLength:64,value:o.description,"onUpdate:value":a[1]||(a[1]=l=>o.description=l),placeholder:"请输入字段描述"},null,8,["value"])]),_:1},16),t(w,R(B(s(g).type)),{label:e(()=>[i("数据类型  "),t(F,null,{title:e(()=>[i("选择存储字段对应的数据类型")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(Z,{value:o.type,"onUpdate:value":a[2]||(a[2]=l=>o.type=l),style:{width:"100%"},placeholder:"请选择数据类型"},{default:e(()=>[(f(),m(z,null,X(x,l=>t(Y,{value:l.value,key:l.value},{default:e(()=>[i(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16),t(w,null,{label:e(()=>[i("是否必要  "),t(F,null,{title:e(()=>[fe,he]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(G,{checked:o.required,"onUpdate:checked":a[3]||(a[3]=l=>o.required=l),"checked-children":"开","un-checked-children":"关",checkedValue:"true",unCheckedValue:"false"},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["open","title"])])}}},ke=E(ve,[["__scopeId","data-v-5fc90fd7"]]),W=d=>(L("data-v-db0f5337"),d=d(),D(),d),ye={class:"field-manage-page"},ge={class:"page-title"},be={class:"table-wrapper customize-scroll-style"},qe={key:0},xe={key:1},Fe={key:0},we={key:1},Ce=W(()=>r("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1)),Se=W(()=>r("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)),$e=["onClick"],Oe=["onClick"],Ie={__name:"index",setup(d){const b=V().query,k=C([]),y=()=>{te({form_id:b.form_id}).then(o=>{k.value=o.data||[]})};y();const S=o=>{oe({id:o.id,form_id:b.form_id,required:o.required=="true"?"false":"true"}).then(v=>{M.success("修改成功"),y()})},h=o=>{A.confirm({title:"删除确认",icon:t(ae),content:`删除后，字段下所有数据将一并删除，删除后不可恢复。确认删除字段${o.name}吗?`,okText:"确 定",okType:"danger",cancelText:"取 消",onOk(){ne({id:o.id}).then(v=>{M.success("删除成功"),y()})},onCancel(){}})},q=C(null),x=(o={})=>{q.value.show(JSON.parse(JSON.stringify(o)))};return(o,v)=>{const $=ie,u=J,c=ce,O=Q,g=_e,I=pe;return f(),m(z,null,[r("div",ye,[r("div",ge,[i(" 字段管理 "),t($,{type:"primary",onClick:v[0]||(v[0]=n=>x())},{icon:e(()=>[t(s(ue))]),default:e(()=>[i(" 添加字段 ")]),_:1})]),r("div",be,[t(I,{pagination:!1,"data-source":k.value},{default:e(()=>[t(c,{key:"name","data-index":"name",width:150},{title:e(()=>[i(" 字段名称 "),t(u,null,{title:e(()=>[i("定义数据表的表头，可以在对应表头下存储相关数据。")]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[n.name.length>50?(f(),m("span",qe,[t(u,null,{title:e(()=>[i(_(n.name),1)]),default:e(()=>[i(" "+_(n.name.slice(0,50)+"..."),1)]),_:2},1024)])):(f(),m("span",xe,_(n.name),1))]),_:1}),t(c,{key:"description","data-index":"description",width:150},{title:e(()=>[i(" 字段描述 "),t(u,null,{title:e(()=>[i("表头字段的说明，帮助用户或大模型理解表头字段")]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[n.description.length>50?(f(),m("span",Fe,[t(u,null,{title:e(()=>[i(_(n.description),1)]),default:e(()=>[i(" "+_(n.description.slice(0,50)+"..."),1)]),_:2},1024)])):(f(),m("span",we,_(n.description),1))]),_:1}),t(c,{key:"type","data-index":"type",width:120},{title:e(()=>[i(" 数据类型 "),t(u,null,{title:e(()=>[i("选择存储字段对应的数据类型")]),default:e(()=>[t(s(p))]),_:1})]),_:1}),t(c,{key:"required","data-index":"required",width:120},{title:e(()=>[i(" 是否必要 "),t(u,null,{title:e(()=>[Ce,Se]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[t(O,{onChange:a=>S(n),checked:n.required=="true","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked"])]),_:1}),t(c,{key:"action",title:"操作",width:90},{default:e(({record:n})=>[r("span",null,[r("a",{onClick:a=>x(n)},"编辑",8,$e),t(g,{type:"vertical"}),r("a",{onClick:a=>h(n)},"删除",8,Oe)])]),_:1})]),_:1},8,["data-source"])])]),t(ke,{onOk:y,ref_key:"addFieldModalRef",ref:q},null,512)],64)}}},It=E(Ie,[["__scopeId","data-v-db0f5337"]]);export{It as default};
