import{_ as Vt}from"./cu-scroll-D6a75u1K.js";import{p as X,O as Gt,T as ue,A as At,o as _e,w as et,I as _t,b as ke,d as rt,M as ne,bQ as he,k as A,bR as Qt,h as ct,B as dt,bS as ge,bT as Yt,bK as Jt,e as Wt,bU as Xt,bG as Zt,U as Kt,a0 as Ce,bp as fe,E as ea,aB as ta,bV as aa,bW as oa,bX as na,bY as sa,bZ as la}from"../../index-BYXP5-K6.js";import{f as tt,e as k,k as e,B as Z,a4 as Le,M as i,N as a,S as n,W as t,a7 as u,Q as T,V as ia,u as R,F as B,a0 as re,a6 as pt,Z as x,a3 as Pe,Y as r,aa as Fe,a1 as Ue,a2 as Ie,d as xe,x as ua,D as _a,ai as ra,G as at,H as ca,$ as Oe}from"./vue-chunks-DKljrDvA.js";import{a as ot}from"./dayjs-BpZi_McX.js";import{U as mt}from"./upload-input-CJdivI19.js";import{t as nt}from"./validate-8MtiUsxW.js";import{F as ye,_ as Re}from"./index-DvGRcWf4.js";import"./index-CcC8Vz_q.js";import{I as be}from"./Input-Bfzy8tJK.js";import"./index-BNZqkHuq.js";import{_ as da,R as pa}from"./RadioButton-D6KxmP_c.js";import{M as ma}from"./model-select-BWeN9_sj.js";import{O as fa}from"./open-grapg-modal-C5oNBaaN.js";import{D as va}from"./DownOutlined-BfzuAtqc.js";import{U as ha}from"./UpOutlined-D0s-TDxk.js";import{S as Te,a as De}from"./index-ChLzCBr1.js";import{_ as ga}from"./index-BIs6VsWm.js";import{R as ya}from"./rename-modal-CrY0LNXe.js";import{_ as ka}from"./page-alert-DCrICB20.js";import{C as ba}from"./index-CkWGTpL1.js";import{g as wa,c as st,d as Ca,r as xa,a as Oa}from"./index-CX89AYWF.js";import{u as lt}from"./FormItemContext-BbeLgxF6.js";import"./index-CYLnLfoe.js";import{D as $a}from"./dropdown-QXBOTlLU.js";import{P as qa}from"./PlusOutlined-wIhQX_dJ.js";import{M as Sa,_ as Fa}from"./index-DcQhmA5K.js";import{S as La}from"./SearchOutlined-BAHqMa3J.js";import{g as Pa}from"./index-BxRniJ5I.js";import{S as Ua}from"./index-B7oz8JPj.js";import{C as $e}from"./ClockCircleFilled-e9ECX9FH.js";import{_ as Ia}from"./index-BbQZiPUc.js";import{S as Ra}from"./SyncOutlined-EOm8z_ub.js";import{M as Ta}from"./MoreOutlined-D7oVfKnU.js";import{_ as Da}from"./index-ifJinQLe.js";import{_ as Ma}from"./index-CSLFuo_b.js";import{a as Na}from"./index-DHPFv2fi.js";import{_ as za}from"./index-cp-3f9TC.js";import{_ as Ha}from"./index-C9HKvTtP.js";import{_ as Ba}from"./TextArea-Dnm7usWJ.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-BZ84_VUH.js";import"./qs-DB0tj3pA.js";import"./crypto-js-fJpLWOEv.js";import"./InboxOutlined-CIe7MHvW.js";import"./Trigger-DAizGHX4.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-BRAWLrZZ.js";import"./responsiveObserve-DRuL2_me.js";import"./collapseMotion-CxHtxgWr.js";import"./QuestionCircleOutlined-DYrN9KdY.js";import"./index-DxTO0j69.js";import"./Search-1aGcXLAr.js";import"./inputProps-B3PFVydJ.js";import"./Password-CPQYqxS0.js";import"./Checkbox-DoUvt9dJ.js";import"./index-C4xOveJ8.js";import"./slide-C8pAsQDb.js";import"./index-2d7y8GiQ.js";import"./CheckOutlined-tNTNjiBd.js";import"./move-BNsvENtF.js";import"./index-Did3xK-p.js";import"./index-DE8nMz1m.js";import"./colors-BsGfXzR0.js";import"./shallowequal-CthuG9FU.js";import"./RightOutlined-D_XHCIbp.js";import"./DownloadOutlined-DBHOL1PL.js";import"./index-CHnEDbAe.js";import"./useMaxLevel-C1O2TwYp.js";import"./CaretDownFilled-BzXYTSEq.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-Dpm3sl41.js";import"./CaretDownOutlined-DGGt9FQx.js";const qe=()=>({format:String,showNow:ue(),showHour:ue(),showMinute:ue(),showSecond:ue(),use12Hours:ue(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:ue(),popupClassName:String,status:Gt()});function Ea(p){const g=wa(p,X(X({},qe()),{order:{type:Boolean,default:!0}})),{TimePicker:b,RangePicker:O}=g,f=tt({name:"ATimePicker",inheritAttrs:!1,props:X(X(X(X({},st()),Ca()),qe()),{addon:{type:Function}}),slots:Object,setup(L,H){let{slots:q,expose:S,emit:v,attrs:_}=H;const w=L,z=lt();At(!(q.addon||w.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const U=k();S({focus:()=>{var s;(s=U.value)===null||s===void 0||s.focus()},blur:()=>{var s;(s=U.value)===null||s===void 0||s.blur()}});const M=(s,N)=>{v("update:value",s),v("change",s,N),z.onFieldChange()},C=s=>{v("update:open",s),v("openChange",s)},P=s=>{v("focus",s)},J=s=>{v("blur",s),z.onFieldBlur()},h=s=>{v("ok",s)};return()=>{const{id:s=z.id.value}=w;return e(b,_e(_e(_e({},_),et(w,["onUpdate:value","onUpdate:open"])),{},{id:s,dropdownClassName:w.popupClassName,mode:void 0,ref:U,renderExtraFooter:w.addon||q.addon||w.renderExtraFooter||q.renderExtraFooter,onChange:M,onOpenChange:C,onFocus:P,onBlur:J,onOk:h}),q)}}}),Y=tt({name:"ATimeRangePicker",inheritAttrs:!1,props:X(X(X(X({},st()),xa()),qe()),{order:{type:Boolean,default:!0}}),slots:Object,setup(L,H){let{slots:q,expose:S,emit:v,attrs:_}=H;const w=L,z=k(),U=lt();S({focus:()=>{var c;(c=z.value)===null||c===void 0||c.focus()},blur:()=>{var c;(c=z.value)===null||c===void 0||c.blur()}});const M=(c,$)=>{v("update:value",c),v("change",c,$),U.onFieldChange()},C=c=>{v("update:open",c),v("openChange",c)},P=c=>{v("focus",c)},J=c=>{v("blur",c),U.onFieldBlur()},h=(c,$)=>{v("panelChange",c,$)},s=c=>{v("ok",c)},N=(c,$,K)=>{v("calendarChange",c,$,K)};return()=>{const{id:c=U.id.value}=w;return e(O,_e(_e(_e({},_),et(w,["onUpdate:open","onUpdate:value"])),{},{id:c,dropdownClassName:w.popupClassName,picker:"time",mode:void 0,ref:z,onChange:M,onOpenChange:C,onFocus:P,onBlur:J,onPanelChange:h,onOk:s,onCalendarChange:N}),q)}}});return{TimePicker:f,TimeRangePicker:Y}}const{TimePicker:ve,TimeRangePicker:Se}=Ea(Oa),ft=X(ve,{TimePicker:ve,TimeRangePicker:Se,install:p=>(p.component(ve.name,ve),p.component(Se.name,Se),p)});var ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};function it(p){for(var g=1;g<arguments.length;g++){var b=arguments[g]!=null?Object(arguments[g]):{},O=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(O=O.concat(Object.getOwnPropertySymbols(b).filter(function(f){return Object.getOwnPropertyDescriptor(b,f).enumerable}))),O.forEach(function(f){Va(p,f,b[f])})}return p}function Va(p,g,b){return g in p?Object.defineProperty(p,g,{value:b,enumerable:!0,configurable:!0,writable:!0}):p[g]=b,p}var Me=function(g,b){var O=it({},g,b.attrs);return e(_t,it({},O,{icon:ja}),null)};Me.displayName="CopyOutlined";Me.inheritAttrs=!1;var Ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};function ut(p){for(var g=1;g<arguments.length;g++){var b=arguments[g]!=null?Object(arguments[g]):{},O=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(O=O.concat(Object.getOwnPropertySymbols(b).filter(function(f){return Object.getOwnPropertyDescriptor(b,f).enumerable}))),O.forEach(function(f){Aa(p,f,b[f])})}return p}function Aa(p,g,b){return g in p?Object.defineProperty(p,g,{value:b,enumerable:!0,configurable:!0,writable:!0}):p[g]=b,p}var Ne=function(g,b){var O=ut({},g,b.attrs);return e(_t,ut({},O,{icon:Ga}),null)};Ne.displayName="HourglassFilled";Ne.inheritAttrs=!1;const Qa={class:"form-box"},Ya={class:"upload-document-type-box"},Ja=["onClick"],Wa={class:"right-block"},Xa={class:"title-block"},Za={class:"title-text"},Ka={class:"desc"},eo={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(p,{expose:g,emit:b}){const O=Pe(),f=Le(),Y=ye.useForm,L=k(!1),H=k("添加自定义文档"),q=p,S=Z({library_id:f.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),v=k([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),_=h=>{S.qa_index_type=h},w=Z({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:z,validate:U,validateInfos:M}=Y(S,w),C=()=>{L.value=!0,z(),S.file_name="",S.is_qa_doc=0,S.qa_index_type=1,q.libraryInfo.type==2&&(S.is_qa_doc=1)},P=k(!1),J=()=>{U().then(()=>{let h={...Fe(S)};P.value=!0,he(h).then(s=>{A.success(`${H.value}成功`),L.value=!1,O.push("/library/preview?id="+s.data.file_ids[0])}).finally(()=>{P.value=!1})})};return g({add:C}),(h,s)=>{const N=be,c=Re,$=pa,K=da,ee=rt,y=ye,we=ne;return a(),i("div",null,[e(we,{open:L.value,"onUpdate:open":s[2]||(s[2]=E=>L.value=E),title:H.value,onOk:J,width:"472px",confirmLoading:P.value},{default:n(()=>[t("div",Qa,[e(y,{layout:"vertical"},{default:n(()=>[e(c,ia({label:"文档名称"},R(M).file_name),{default:n(()=>[e(N,{type:"text",placeholder:"请输入文档名称",value:S.file_name,"onUpdate:value":s[0]||(s[0]=E=>S.file_name=E)},null,8,["value"])]),_:1},16),u("",!0),S.is_qa_doc==1?(a(),T(c,{key:1,label:"索引方式",required:""},{default:n(()=>[t("div",Ya,[(a(!0),i(B,null,re(v.value,E=>(a(),i("div",{class:pt(["type-item",{active:S.qa_index_type==E.value}]),key:E.value,onClick:oe=>_(E.value)},[t("div",Wa,[t("div",Xa,[e(ee,{name:S.qa_index_type==E.value?E.iconNameActive:E.iconName},null,8,["name"]),t("div",Za,x(E.title),1)]),t("div",Ka,x(E.desc),1)]),S.qa_index_type==E.value?(a(),T(ee,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):u("",!0)],10,Ja))),128))])]),_:1})):u("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},to=ke(eo,[["__scopeId","data-v-80f3643f"]]),ae=p=>(Ue("data-v-a625c25c"),p=p(),Ie(),p),ao={class:"alert-box"},oo=ae(()=>t("div",null,[r(" 通过word或者EXce形式导入问答对，建议您参考"),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),r("  "),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),r("创建导入文档 ")],-1)),no=ae(()=>t("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)),so={class:"upload-file-box"},lo={key:0,class:"hight-set"},io={key:0,class:"set-box"},uo={class:"form-item"},_o=ae(()=>t("div",{class:"form-item-label"},"问题所在列：",-1)),ro={class:"form-item-body"},co={class:"form-item"},po=ae(()=>t("div",{class:"form-item-label"},"相似问法所在列：",-1)),mo={class:"form-item-body"},fo={class:"form-item"},vo=ae(()=>t("div",{class:"form-item-label"},"答案所在列：",-1)),ho={class:"form-item-body"},go={key:1,class:"set-box"},yo={class:"form-item"},ko=ae(()=>t("div",{class:"form-item-label"},"问题开始标识符：",-1)),bo={class:"form-item-body"},wo={class:"form-item"},Co=ae(()=>t("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),xo={class:"form-item-body"},Oo={class:"form-item"},$o=ae(()=>t("div",{class:"form-item-label"},"答案开始标识符：",-1)),qo={class:"form-item-body"},So={__name:"qa-upload-modal",emits:["ok"],setup(p,{expose:g,emit:b}){const O=Pe(),Y=Le().query,L=k(!1),H=k(!1),q=k([]),S=b,v=k([]),_=Z({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),w=k(!0),z=()=>{L.value=!0},U=()=>{let h=new FormData;q.value.forEach(s=>{h.append("library_files",s)}),Qt(h).then(s=>{let N=[];for(let c in s.data)N.push({lable:s.data[c],value:c});v.value=N})},M=()=>{if(q.value.length==0){A.error("请选择文件");return}H.value=!0;let h=new FormData;h.append("library_id",Y.id);let s=!1;q.value.forEach(N=>{(N.name.includes(".xlsx")||N.name.includes(".csv"))&&(s=!0),h.append("library_files",N)}),s?(h.append("question_column",_.question_column),h.append("answer_column",_.answer_column),_.similar_column&&h.append("similar_column",_.similar_column)):(h.append("question_lable",_.question_lable),h.append("answer_lable",_.answer_lable),h.append("similar_label",_.similar_label)),h.append("is_qa_doc",1),he(h).then(N=>{S("ok"),L.value=!1,q.value=[],H.value=!1,s&&O.push("/library/document-segmentation?document_id="+N.data.file_ids[0])}).catch(()=>{H.value=!1})},C=()=>{q.value=[]},P=k(1),J=h=>{_.question_column=void 0,_.answer_column=void 0,_.similar_column=void 0,_.question_lable="问题：",_.answer_lable="答案：",_.similar_label="相似问题：",q.value=h,h&&h.length>0&&(h[0].type.includes(".document")?P.value=2:(P.value=1,U()))};return g({show:z}),(h,s)=>{const N=ga,c=De,$=Te,K=be,ee=ne;return a(),i("div",null,[e(ee,{width:680,open:L.value,"onUpdate:open":s[8]||(s[8]=y=>L.value=y),"confirm-loading":H.value,maskClosable:!1,title:"上传文档",onOk:M,onCancel:C},{default:n(()=>[t("div",ao,[e(N,{"show-icon":""},{message:n(()=>[oo,no]),_:1})]),t("div",so,[e(mt,{type:2,value:q.value,"onUpdate:value":s[0]||(s[0]=y=>q.value=y),onChange:J},null,8,["value"])]),q.value.length>0?(a(),i("div",lo,[t("a",{onClick:s[1]||(s[1]=y=>w.value=!w.value)},[r("高级设置： "),w.value?(a(),T(R(ha),{key:1})):(a(),T(R(va),{key:0}))]),w.value?(a(),i(B,{key:0},[P.value==1?(a(),i("div",io,[t("div",uo,[_o,t("div",ro,[e($,{value:_.question_column,"onUpdate:value":s[2]||(s[2]=y=>_.question_column=y),placeholder:"请选择列名",style:{width:"100%"}},{default:n(()=>[(a(!0),i(B,null,re(v.value,y=>(a(),T(c,{value:y.value,key:y.value},{default:n(()=>[r(x(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",co,[po,t("div",mo,[e($,{value:_.similar_column,"onUpdate:value":s[3]||(s[3]=y=>_.similar_column=y),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:n(()=>[(a(!0),i(B,null,re(v.value,y=>(a(),T(c,{value:y.value,key:y.value},{default:n(()=>[r(x(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",fo,[vo,t("div",ho,[e($,{value:_.answer_column,"onUpdate:value":s[4]||(s[4]=y=>_.answer_column=y),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:n(()=>[(a(!0),i(B,null,re(v.value,y=>(a(),T(c,{value:y.value,key:y.value},{default:n(()=>[r(x(y.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):u("",!0),P.value==2?(a(),i("div",go,[t("div",yo,[ko,t("div",bo,[e(K,{placeholder:"请输入标识符",value:_.question_lable,"onUpdate:value":s[5]||(s[5]=y=>_.question_lable=y)},null,8,["value"])])]),t("div",wo,[Co,t("div",xo,[e(K,{placeholder:"请输入标识符",value:_.similar_label,"onUpdate:value":s[6]||(s[6]=y=>_.similar_label=y)},null,8,["value"])])]),t("div",Oo,[$o,t("div",qo,[e(K,{placeholder:"请输入标识符",value:_.answer_lable,"onUpdate:value":s[7]||(s[7]=y=>_.answer_lable=y)},null,8,["value"])])])])):u("",!0)],64)):u("",!0)])):u("",!0)]),_:1},8,["open","confirm-loading"])])}}},Fo=ke(So,[["__scopeId","data-v-a625c25c"]]),Lo="/assets/img/guide-image-DSu20zRj.png",ze=p=>(Ue("data-v-33a87814"),p=p(),Ie(),p),Po={class:"container"},Uo={class:"guide-content"},Io=ze(()=>t("img",{src:Lo,alt:"操作引导",class:"guide-image"},null,-1)),Ro={class:"content-box"},To=ze(()=>t("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),Do=ze(()=>t("div",{class:"content-check"},"不再显示此提示",-1)),Mo={__name:"guide-learning-tips",setup(p,{expose:g}){const b=ct(),O=k(!1),f=k(!1),Y=k(""),L=()=>{setTimeout(()=>{O.value=!0},500)},H=()=>{b.setGuideLearningTips(f.value),O.value=!1},q=()=>{b.setGuideLearningTips(f.value),O.value=!1};return g({show:L}),(S,v)=>{const _=ba,w=dt,z=ne;return a(),i("div",Po,[e(z,{open:O.value,"onUpdate:open":v[1]||(v[1]=U=>O.value=U),title:Y.value,onOk:H,onCancel:q,width:"472px"},{footer:n(()=>[e(w,{type:"primary",onClick:H},{default:n(()=>[r("我知道了")]),_:1})]),default:n(()=>[t("div",Uo,[Io,t("div",Ro,[To,e(_,{checked:f.value,"onUpdate:checked":v[0]||(v[0]=U=>f.value=U)},{default:n(()=>[Do]),_:1},8,["checked"])])])]),_:1},8,["open","title"])])}}},No=ke(Mo,[["__scopeId","data-v-33a87814"]]),zo={__name:"edit-online-doc",emits:["ok"],setup(p,{expose:g,emit:b}){const O=b,f=Z({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),Y=k({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),L=k(!1),H=_=>{_=JSON.parse(JSON.stringify(_)),f.id=_.id||"",f.file_name=_.file_name||"",f.doc_auto_renew_frequency=+_.doc_auto_renew_frequency||1,_.doc_auto_renew_minute>0&&(f.doc_auto_renew_minute=ge(_.doc_auto_renew_minute)),L.value=!0},q=k(!1),S=k(null),v=()=>{S.value.validate().then(()=>{q.value=!0,Yt({...f,doc_auto_renew_minute:f.doc_auto_renew_minute?ge(f.doc_auto_renew_minute):0}).then(()=>{L.value=!1,q.value=!1,O("ok")})}).catch(()=>{q.value=!1})};return g({show:H}),(_,w)=>{const z=be,U=Re,M=De,C=Te,P=ft,J=ye,h=ne;return a(),i("div",null,[e(h,{open:L.value,"onUpdate:open":w[3]||(w[3]=s=>L.value=s),"confirm-loading":q.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:v},{default:n(()=>[e(J,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:S,model:f,rules:Y.value},{default:n(()=>[e(U,{name:"file_name",label:"文件名称"},{default:n(()=>[e(z,{value:f.file_name,"onUpdate:value":w[0]||(w[0]=s=>f.file_name=s),placeholder:"请输入"},null,8,["value"])]),_:1}),e(U,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:n(()=>[e(C,{value:f.doc_auto_renew_frequency,"onUpdate:value":w[1]||(w[1]=s=>f.doc_auto_renew_frequency=s),style:{width:"100%"}},{default:n(()=>[e(M,{value:1},{default:n(()=>[r("不自动更新")]),_:1}),e(M,{value:2},{default:n(()=>[r("每天")]),_:1}),e(M,{value:3},{default:n(()=>[r("每3天")]),_:1}),e(M,{value:4},{default:n(()=>[r("每7天")]),_:1}),e(M,{value:5},{default:n(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),f.doc_auto_renew_frequency>1?(a(),T(U,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:n(()=>[e(P,{valueFormat:"HH:mm",value:f.doc_auto_renew_minute,"onUpdate:value":w[2]||(w[2]=s=>f.doc_auto_renew_minute=s),format:"HH:mm"},null,8,["value"])]),_:1})):u("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},Q=p=>(Ue("data-v-cb5e8606"),p=p(),Ie(),p),Ho={class:"details-library-page"},Bo={class:"list-tools"},Eo={class:"tools-items"},jo={class:"tool-item"},Vo={class:"dropdown-btn-menu"},Go=Q(()=>t("div",{class:"title"},"本地文档",-1)),Ao={key:0,class:"desc"},Qo={key:1,class:"desc"},Yo={class:"dropdown-btn-menu"},Jo=Q(()=>t("div",{class:"title"},"在线数据",-1)),Wo=Q(()=>t("div",{class:"desc"},"获取在线网页内容",-1)),Xo={class:"dropdown-btn-menu"},Zo=Q(()=>t("div",{class:"title"},"自定义文档",-1)),Ko=Q(()=>t("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1)),en=Q(()=>t("span",null,"添加内容",-1)),tn=Q(()=>t("span",null,"生成知识图谱：",-1)),an={class:"right-box"},on={key:0,class:"status-box"},nn={class:"status-item"},sn=Q(()=>t("div",{class:"status-label"},"已学习：",-1)),ln={class:"status-content"},un={class:"status-item"},_n=Q(()=>t("div",{class:"status-label"},"，未学习：",-1)),rn={class:"status-content content-tip"},cn={class:"status-item"},dn=Q(()=>t("div",{class:"status-label"},"，学习失败：",-1)),pn={class:"status-content content-tip"},mn={key:1,class:"status-select-box"},fn={class:"tool-item"},vn=Q(()=>t("div",null,[t("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),t("p",null,"2、未学习的文档数据不会被检索到。")],-1)),hn={class:"list-content"},gn={key:0,class:"doc-name-td"},yn=["href"],kn=["onClick"],bn={key:0},wn={key:1},Cn=["onClick"],xn={key:0},On={key:1},$n={key:2,class:"url-remark"},qn=["onClick"],Sn={key:0,class:"pdf-progress-box"},Fn={class:"progress-title"},Ln={class:"status-box"},Pn=["onClick"],Un={class:"progress-bar"},In={class:"num-box"},Rn={key:0,class:"status-tag running"},Tn={key:2,class:"status-tag running"},Dn={key:3,class:"status-tag complete"},Mn={class:"status-tag status-error"},Nn=["onClick"],zn={class:"status-tag status-error"},Hn={class:"status-tag"},Bn=["onClick"],En={key:7,class:"status-tag"},jn={key:8,class:"status-tag running"},Vn={class:"status-tag error"},Gn={key:10,class:"status-tag cancel"},An={key:11,class:"status-tag subning"},Qn={class:"status-tag"},Yn=["onClick"],Jn={key:1,class:"status-tag running"},Wn={key:2,class:"status-tag complete"},Xn={class:"status-tag error"},Zn=["onClick"],Kn={class:"zm-line1 reason-text"},es={key:4,class:"status-tag running"},ts={class:"status-tag warning"},as={class:"reason-text"},os=["onClick"],ns={key:0},ss={key:1},ls={key:0,class:"text-block"},is={class:"time-content-box"},us={key:0},_s={key:1},rs={key:2},cs={key:3},ds={key:4},ps={key:5,class:"ml4"},ms={key:6},fs=["onClick"],vs=Q(()=>t("a",{class:"ml4 btn-hover-block"},"更新",-1)),hs={key:1},gs={key:0},ys={key:1},ks=["onClick"],bs=["onClick"],ws=["onClick"],Cs=Q(()=>t("span",null,"删除",-1)),xs={class:"upload-file-box"},Os={class:"select-card-box"},$s=["onClick"],qs={class:"card-title"},Ss={key:0,class:"card-switch-box"},Fs={class:"card-desc"},Ls={key:0,class:"card-switch"},Ps={__name:"knowledge-document",setup(p){const{setStorage:g}=ta("localStorage"),b=Jt(),{changeGraphSwitch:O}=b,f=Wt(),Y=xe(()=>{var l;return((l=f.companyInfo)==null?void 0:l.neo4j_status)=="true"}),L=xe(()=>{var l;return((l=f.companyInfo)==null?void 0:l.ali_ocr_switch)=="1"}),H=ct(),q=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"},{key:4,title:"阿里云OCR解析",icon:"ali-ocr",desc:"通过阿里云文档智能接口解析提取图片和文字"}],S=Le(),v=Pe(),_=S.query,w=k(!1),z=k(null),U=k(null),M=k(!1),C=k({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});Z({selectedRowKeys:[]});const P=Z({use_model:"",model_config_id:""}),J=(l=!0,d=null)=>{la({...Fe(C.value),use_model:P.use_model,model_config_id:P.model_config_id}).then(()=>{C.value.use_model=P.use_model,C.value.model_config_id=P.model_config_id,typeof d=="function"&&d(),l&&A.success("保存成功")})},h=k([]),s=l=>{h.value=l},N=k([]),c=Z({learned_err_count:0,learned_count:0,learned_wait_count:0}),$=Z({library_id:_.id,file_name:void 0,status:"",page:1,size:10,total:0}),K=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],ee=k([]),y=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],we=l=>{oe()},E=l=>{$.page=l.current,$.size=l.pageSize,V()},oe=()=>{$.page=1,V()};let He=!1;const vt=({id:l})=>{N.value.length==1&&(He=!0),sa({id:l}).then(()=>{He&&$.page>1&&$.page--,V(),A.success("删除成功")})},se=(l,d={})=>{if(l.status=="4")return v.push({path:"/library/document-segmentation",query:{document_id:l.id,page:$.page}});if(l.status=="3"&&C.value.type!=2)return A.error("学习失败,不可预览");if(l.status=="0")return A.error("转换中,稍候可预览");if(l.status=="1")return A.error("学习中,不可预览");if(l.status=="6")return A.error("获取中,不可预览");if(l.status=="7")return A.error("获取失败,不可预览");if(l.status=="10")return A.error("正在分段,不可预览");v.push({name:"libraryPreview",query:{id:l.id,...d}})},V=()=>{let l=Fe($);l.status==0&&(l.status=""),w.value=!0,Xt(l).then(d=>{let I=d.data.info;!P.use_model&&P.use_model!=I.use_model&&(P.use_model=I.use_model,P.model_config_id=I.model_config_id),C.value={...I},M.value=I.graph_switch==1,I.graph_switch=="0"||!Y.value?ee.value=y.filter(G=>!["graph_status","graph_entity_count"].includes(G.key)):ee.value=y;let te=d.data.list||[],W=d.data.count_data||{};$.total=d.data.total,c.learned_count=W.learned_count,c.learned_err_count=W.learned_err_count,c.learned_wait_count=W.learned_wait_count;let le=!1;N.value=te.map(G=>(["1","6","0","5"].includes(G.status)&&(le=!0),G.file_size_str=Zt(G.file_size),G.update_time=ot(G.update_time*1e3).format("YYYY-MM-DD HH:mm"),G.doc_last_renew_time_desc=G.doc_last_renew_time>0?ot(G.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",G)),le&&ht(),!le&&clearInterval(ce.value)}).finally(()=>{w.value=!1})},ce=k(null),ht=()=>{clearInterval(ce.value),ce.value=setInterval(()=>{V()},1e3*5)},Be=k(null),gt=l=>{if(h.value.length==0){ne.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){v.push({path:"/user/model"})}});return}let{key:d}=l;d==1&&wt(),d==2&&yt(),d==3&&Be.value.add()},F=Z({open:!1,urls:"",library_id:_.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(l,d)=>nt(d)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),yt=()=>{F.open=!0,F.confirmLoading=!1,F.urls="",F.doc_auto_renew_minute="02:00",F.doc_auto_renew_frequency=1},Ee=k(null),kt=()=>{Ee.value.validate().then(()=>{F.confirmLoading=!0,he({library_id:F.library_id,urls:JSON.stringify(nt(F.urls)),doc_auto_renew_frequency:F.doc_auto_renew_frequency,doc_auto_renew_minute:ge(F.doc_auto_renew_minute),doc_type:2}).then(()=>{F.open=!1,F.confirmLoading=!1,oe()})}).catch(()=>{F.confirmLoading=!1})},bt=()=>{F.open=!1},D=Z({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),je=xe(()=>D.fileList.filter(l=>l.type==="application/pdf").length>0),Ve=k(null),wt=()=>{if(C.value.type==2){Ve.value.show();return}D.fileList=[],D.open=!0},Ct=()=>{D.fileList=[]},xt=l=>{D.fileList=l},Ot=()=>{if(z.value&&!H.getGuideLearningTips&&D.fileList.length>1&&z.value.show(),D.fileList.length==0){A.error("请选择文件");return}D.confirmLoading=!0;let l=new FormData;l.append("library_id",$.library_id);let d=!1;D.fileList.forEach(I=>{(I.name.includes(".xlsx")||I.name.includes(".csv"))&&(d=!0),l.append("library_files",I)}),je.value&&l.append("pdf_parse_type",D.pdf_parse_type),he(l).then(I=>{V(),D.open=!1,D.fileList=[],D.confirmLoading=!1,d&&I.data.file_ids.length==1&&v.push("/library/document-segmentation?document_id="+I.data.file_ids[0])}).catch(()=>{D.confirmLoading=!1})},Ge=k(null),$t=l=>{Ge.value.show(l)},qt=l=>{v.push({path:"/library/document-segmentation",query:{document_id:l.id}})},Ae=l=>{oa({id:l.id}).then(()=>{V()})},St=()=>{if(M.value){M.value=!1;let l={graph_model_config_id:C.value.graph_model_config_id,graph_use_model:C.value.graph_use_model};if((!l.graph_model_config_id||!l.graph_use_model)&&h.value.length>0){let I=h.value[0].children[0];l.graph_use_model=I.name,l.graph_model_config_id=I.model_config_id}U.value.show(l)}else C.value.graph_switch=0,J(!1,()=>{V(),O(0)})},Ft=l=>{M.value=!0,C.value.graph_switch=1,C.value.graph_model_config_id=l.graph_model_config_id,C.value.graph_use_model=l.graph_use_model,J(!1,()=>{V(),O(1)})},Lt=l=>{if(l.key==4&&!L.value)return!1;D.pdf_parse_type=l.key},Pt=()=>{window.open("#/user/aliocr")},Qe=k(null),Ye=l=>{Qe.value.show({...l})},Ut=l=>{na({id:l.id}).then(d=>{A.success("更新成功"),V()})},It=l=>{ne.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){aa({id:l.id}).then(d=>{A.success("取消成功"),V()})}})},Rt=l=>{g("graph:autoOpenFileId",l.id),v.push({path:"/library/details/knowledge-graph",query:{id:_.id}})};return ua(()=>{_.page&&($.page=+_.page),V()}),_a(()=>{ce.value&&clearInterval(ce.value)}),(l,d)=>{const I=rt,te=Da,W=Fa,le=Sa,G=dt,Je=$a,Tt=Ma,ie=De,We=Te,Dt=be,Mt=za,Nt=Pa,de=Ua,pe=Ha,Xe=Ia,zt=Na,Ht=Vt,me=Re,Ze=ye,Ke=ne,Bt=Ba,Et=ft,jt=ra("copy");return a(),i("div",Ho,[e(Ht,{scrollbar:!1},{default:n(()=>[t("div",Bo,[t("div",Eo,[t("div",jo,[e(Je,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:n(()=>[e(le,{onClick:gt},{default:n(()=>[(a(),T(W,{key:1},{default:n(()=>[t("div",Vo,[e(te,{class:"title-block",gap:4},{default:n(()=>[e(I,{name:"doc-icon"}),Go]),_:1}),C.value.type==2?(a(),i("div",Ao," 上传本地 docx/csv/xlsx 等格式文件 ")):(a(),i("div",Qo," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),C.value.type!=2?(a(),T(W,{key:2},{default:n(()=>[t("div",Yo,[e(te,{class:"title-block",gap:4},{default:n(()=>[e(I,{name:"link-icon"}),Jo]),_:1}),Wo])]),_:1})):u("",!0),(a(),T(W,{key:3},{default:n(()=>[t("div",Xo,[e(te,{class:"title-block",gap:4},{default:n(()=>[e(I,{name:"cu-doc-icon"}),Zo]),_:1}),Ko])]),_:1}))]),_:1})]),default:n(()=>[e(G,{type:"primary"},{icon:n(()=>[e(R(qa))]),default:n(()=>[en]),_:1})]),_:1})]),Y.value?(a(),T(te,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:n(()=>[at(e(ma,{modelType:"LLM",onLoaded:s},null,512),[[ca,!1]]),tn,e(Tt,{checked:M.value,"onUpdate:checked":d[0]||(d[0]=m=>M.value=m),onChange:St,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):u("",!0)]),t("div",an,[C.value.type==0?(a(),i("div",on,[t("div",nn,[sn,t("div",ln,x(c.learned_count),1)]),t("div",un,[_n,t("div",rn,x(c.learned_wait_count),1)]),t("div",cn,[dn,t("div",pn,x(c.learned_err_count),1)])])):u("",!0),C.value.type==0?(a(),i("div",mn,[e(We,{value:$.status,"onUpdate:value":d[1]||(d[1]=m=>$.status=m),style:{width:"150px"},placeholder:"请选择",onChange:we},{default:n(()=>[(a(),i(B,null,re(K,m=>e(ie,{key:m.id,value:m.id},{default:n(()=>[r(x(m.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):u("",!0),t("div",fn,[e(Dt,{style:{width:"282px"},value:$.file_name,"onUpdate:value":d[2]||(d[2]=m=>$.file_name=m),placeholder:"请输入文档名称搜索",onChange:oe},{suffix:n(()=>[e(R(La),{onClick:oe,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),C.value.type==0?(a(),T(ka,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:n(()=>[vn]),_:1})):u("",!0),t("div",hn,[e(zt,{columns:ee.value,"data-source":N.value,scroll:{x:1e3},"row-key":"id",pagination:{current:$.page,total:$.total,pageSize:$.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:E},{bodyCell:n(({column:m,record:o})=>[m.key==="file_name"?(a(),i("div",gn,[o.doc_type==2?(a(),T(Mt,{key:0,title:null},{content:n(()=>[r(" 原链接："),t("a",{href:o.doc_url,target:"_blank"},x(o.doc_url),9,yn),at(e(R(Me),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[jt,`${o.doc_url}`]])]),default:n(()=>[t("a",{onClick:j=>se(o)},[["5","6","7"].includes(o.status)?(a(),i("span",bn,x(o.doc_url),1)):(a(),i("span",wn,x(o.file_name),1))],8,kn)]),_:2},1024)):(a(),i("a",{key:1,onClick:j=>se(o)},[["5","6","7"].includes(o.status)?(a(),i("span",xn,x(o.doc_url),1)):(a(),i("span",On,x(o.file_name),1))],8,Cn)),o.doc_type==2&&o.remark?(a(),i("div",$n," 备注："+x(o.remark),1)):u("",!0)])):u("",!0),m.key==="graph_entity_count"?(a(),i("a",{key:1,onClick:j=>Rt(o)},x(o.graph_entity_count),9,qn)):u("",!0),m.key==="status"?(a(),i(B,{key:2},[o.file_ext=="pdf"&&o.pdf_parse_type>=2?(a(),i(B,{key:0},[o.status==0?(a(),i("div",Sn,[t("div",Fn,[t("span",Ln,[e(R(Kt)),r("文档解析中")]),t("a",{onClick:j=>It(o)},"取消",8,Pn)]),t("div",Un,[e(Nt,{size:"small",class:"progress-bar-box",percent:parseInt(o.ocr_pdf_index/o.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),t("div",In,x(o.ocr_pdf_index)+" / "+x(o.ocr_pdf_total),1)])])):u("",!0)],64)):(a(),i(B,{key:1},[o.status==0?(a(),i("span",Rn,[e(de,{size:"small"}),r(" 转换中")])):u("",!0)],64)),o.status==1?(a(),i("span",Tn,[e(de,{size:"small"}),r(" 学习中")])):u("",!0),o.status==2?(a(),i("span",Dn,[e(R(Ce)),r(" 学习完成")])):u("",!0),o.status==3?(a(),T(pe,{key:4,placement:"top"},{title:n(()=>[t("span",null,x(o.errmsg),1)]),default:n(()=>[t("span",null,[t("span",Mn,[e(R(fe)),r(" 转换失败")]),C.value.type==2?(a(),i("a",{key:0,class:"ml8",onClick:j=>se(o)},"学习",8,Nn)):u("",!0)])]),_:2},1024)):u("",!0),o.status==8?(a(),T(pe,{key:5,placement:"top"},{title:n(()=>[t("span",null,x(o.errmsg),1)]),default:n(()=>[t("span",null,[t("span",zn,[e(R(fe)),r(" 转化异常")])])]),_:2},1024)):u("",!0),o.status==4?(a(),i(B,{key:6},[t("span",Hn,[e(R($e)),r(" 待学习")]),t("a",{class:"ml8",onClick:j=>se(o)},"学习",8,Bn)],64)):u("",!0),o.status==5?(a(),i("span",En,[e(R($e)),r(" 待获取")])):u("",!0),o.status==6?(a(),i("span",jn,[e(de,{size:"small"}),r(" 获取中")])):u("",!0),o.status==7?(a(),T(pe,{key:9,placement:"top"},{title:n(()=>[t("span",null,x(o.errmsg),1)]),default:n(()=>[t("span",Vn,[e(R(fe)),r(" 获取失败")])]),_:2},1024)):u("",!0),o.status==9?(a(),i("span",Gn,[e(R(ea)),r(" 取消解析")])):u("",!0),o.status==10?(a(),i("span",An,[e(de,{size:"small"}),r(" 正在分段 ")])):u("",!0)],64)):u("",!0),m.key==="graph_status"?(a(),i(B,{key:3},[o.graph_status==0?(a(),i(B,{key:0},[t("span",Qn,[e(R($e)),r(" 待生成")]),t("a",{class:"ml8",onClick:j=>Ae(o)},"生成",8,Yn)],64)):o.graph_status==1?(a(),i("span",Jn,[e(R(Ne)),r(" 排队中")])):o.graph_status==2?(a(),i("span",Wn,[e(R(Ce)),r(" 生成完成")])):o.graph_status==3?(a(),i(B,{key:3},[t("span",Xn,[e(R(fe)),r(" 生成失败")]),t("a",{class:"ml8",onClick:j=>Ae(o)},"生成",8,Zn),o.graph_err_msg?(a(),T(pe,{key:0,title:o.graph_err_msg},{default:n(()=>[t("div",Kn,"原因："+x(o.graph_err_msg),1)]),_:2},1032,["title"])):u("",!0)],64)):o.graph_status==4?(a(),i("span",es,[e(de,{size:"small"}),r(" 生成中")])):o.graph_status==5?(a(),i(B,{key:5},[t("span",ts,[e(R(Ce)),r(" 部分成功")]),t("div",as,[r(" 失败数："+x(o.graph_err_count||0)+" ",1),t("a",{class:"ml8",onClick:j=>se(o,{graph_status:3})},"详情",8,os)])],64)):u("",!0)],64)):u("",!0),m.key==="file_size"?(a(),i(B,{key:4},[o.doc_type==3?(a(),i("span",ns,"-")):(a(),i("span",ss,x(o.file_size_str),1))],64)):u("",!0),m.key==="doc_auto_renew_frequency"?(a(),i(B,{key:5},[o.doc_type==2?(a(),i("div",ls,[t("div",is,[o.doc_auto_renew_frequency==1?(a(),i("span",us,"不自动更新")):u("",!0),o.doc_auto_renew_frequency==2?(a(),i("span",_s,"每天")):u("",!0),o.doc_auto_renew_frequency==3?(a(),i("span",rs,"每3天")):u("",!0),o.doc_auto_renew_frequency==4?(a(),i("span",cs,"每7天")):u("",!0),o.doc_auto_renew_frequency==5?(a(),i("span",ds,"每30天")):u("",!0),o.doc_auto_renew_frequency>1&&o.doc_auto_renew_minute>0?(a(),i("span",ps,x(R(ge)(o.doc_auto_renew_minute)),1)):u("",!0),o.doc_auto_renew_frequency>1?(a(),i("span",ms,"更新")):u("",!0),t("a",{class:"ml4 btn-hover-block",onClick:j=>Ye(o)},"修改",8,fs)]),e(te,{align:"center"},{default:n(()=>[r(" 最近更新: "+x(o.doc_last_renew_time_desc)+" ",1),e(Xe,{title:"确认更新?",onConfirm:j=>Ut(o)},{default:n(()=>[vs]),_:2},1032,["onConfirm"])]),_:2},1024)])):(a(),i("div",hs,"--"))],64)):u("",!0),m.key==="paragraph_count"?(a(),i(B,{key:6},[o.status==0||o.status==1?(a(),i("span",gs,"-")):(a(),i("span",ys,x(o.paragraph_count),1))],64)):u("",!0),m.key==="action"?(a(),T(te,{key:7,gap:8},{default:n(()=>[e(pe,null,{title:n(()=>[r("重新分段")]),default:n(()=>[e(R(Ra),{class:"btn-hover-block",onClick:j=>qt(o)},null,8,["onClick"])]),_:2},1024),e(Je,null,{overlay:n(()=>[e(le,null,{default:n(()=>[o.doc_type==2?(a(),T(W,{key:0},{default:n(()=>[t("div",{onClick:j=>Ye(o)},"编辑",8,ks)]),_:2},1024)):u("",!0),e(W,{disabled:o.status==6||o.status==7||o.status==0},{default:n(()=>[t("div",{onClick:j=>se(o)},"预览",8,bs)]),_:2},1032,["disabled"]),e(W,null,{default:n(()=>[t("div",{onClick:j=>$t(o)},"重命名",8,ws)]),_:2},1024),e(W,null,{default:n(()=>[e(Xe,{title:"确定要删除吗?",onConfirm:j=>vt(o)},{default:n(()=>[Cs]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:n(()=>[t("div",{class:"table-btn",onClick:d[3]||(d[3]=Oe(()=>{},["prevent"]))},[e(R(Ta),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):u("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),e(Ke,{open:D.open,"onUpdate:open":d[5]||(d[5]=m=>D.open=m),"confirm-loading":D.confirmLoading,maskClosable:!1,title:"上传文档",onOk:Ot,onCancel:Ct,width:"740px"},{default:n(()=>[e(Ze,{class:"mt24"},{default:n(()=>[e(me,{required:"",label:""},{default:n(()=>[t("div",xs,[e(mt,{type:C.value.type,maxCount:20,value:D.fileList,"onUpdate:value":d[4]||(d[4]=m=>D.fileList=m),onChange:xt},null,8,["type","value"])])]),_:1}),je.value?(a(),T(me,{key:0,required:"",label:"PDF解析模式",class:"select-card-main"},{default:n(()=>[t("div",Os,[(a(),i(B,null,re(q,m=>t("div",{key:m.key,class:pt(["select-card-item",{active:D.pdf_parse_type==m.key},{disabled:m.key==4&&!L.value}]),onClick:Oe(o=>Lt(m),["stop"])},[e(I,{class:"check-arrow",name:"check-arrow-filled"}),t("div",qs,[e(I,{name:m.icon,style:{"font-size":"16px"}},null,8,["name"]),r(" "+x(m.title)+" ",1),m.key==4&&!L.value?(a(),i("div",Ss,"未开启")):u("",!0)]),t("div",Fs,x(m.desc),1),m.key==4&&!L.value?(a(),i("div",Ls,[r(" 未开启阿里云OCR "),t("div",{class:"card-switch-btn",onClick:Oe(Pt,["stop"])},"去开启")])):u("",!0)],10,$s)),64))])]),_:1})):u("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),e(Fo,{onOk:V,ref_key:"qaUploadModalRef",ref:Ve},null,512),e(Ke,{open:F.open,"onUpdate:open":d[9]||(d[9]=m=>F.open=m),"confirm-loading":F.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:kt,onCancel:bt},{default:n(()=>[e(Ze,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:Ee,model:F,rules:F.rules},{default:n(()=>[e(me,{name:"urls",label:"网页链接"},{default:n(()=>[e(Bt,{style:{height:"120px"},value:F.urls,"onUpdate:value":d[6]||(d[6]=m=>F.urls=m),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),e(me,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:n(()=>[e(We,{value:F.doc_auto_renew_frequency,"onUpdate:value":d[7]||(d[7]=m=>F.doc_auto_renew_frequency=m),style:{width:"100%"}},{default:n(()=>[e(ie,{value:1},{default:n(()=>[r("不自动更新")]),_:1}),e(ie,{value:2},{default:n(()=>[r("每天")]),_:1}),e(ie,{value:3},{default:n(()=>[r("每3天")]),_:1}),e(ie,{value:4},{default:n(()=>[r("每7天")]),_:1}),e(ie,{value:5},{default:n(()=>[r("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),F.doc_auto_renew_frequency>1?(a(),T(me,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:n(()=>[e(Et,{valueFormat:"HH:mm",value:F.doc_auto_renew_minute,"onUpdate:value":d[8]||(d[8]=m=>F.doc_auto_renew_minute=m),format:"HH:mm"},null,8,["value"])]),_:1})):u("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),e(to,{libraryInfo:C.value,onOk:oe,ref_key:"addCustomDocumentRef",ref:Be},null,8,["libraryInfo"]),e(ya,{onOk:oe,ref_key:"renameModalRef",ref:Ge},null,512),e(fa,{onOk:Ft,ref_key:"openGrapgModalRef",ref:U},null,512),e(No,{ref_key:"guideLearningTipsRef",ref:z},null,512),e(zo,{onOk:V,ref_key:"editOnlineDocRef",ref:Qe},null,512)])}}},Zl=ke(Ps,[["__scopeId","data-v-cb5e8606"]]);export{Zl as default};
