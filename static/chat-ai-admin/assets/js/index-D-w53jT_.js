import{a as u}from"./dayjs-CHX5mXCJ.js";import{e as D,B as z,x as F,w as M,M as s,N as n,W as f,k as i,S as w,F as Y,$ as T,u as k,Q as O,Y as h,Z as E,a5 as B,a7 as p,a1 as N,a2 as V}from"./vue-chunks-DkYK5AuX.js";import{a as L,_ as Q}from"./RadioButton-ouyuU7LQ.js";import{R as U}from"./dayjs-DS70I3cJ.js";import{g as q}from"./index-CGn0qoG1.js";import{b as R,f as H,L as P,bd as j,be as A}from"../../index-CuFzRDH0.js";import{C as J}from"./ClockCircleFilled-vGTbBwA5.js";import{a as W}from"./index-CaI5udhb.js";import{Q as Z}from"./QuestionCircleOutlined-DySDEe_b.js";import{_ as G}from"./index-B58k5Ecy.js";import{_ as K}from"./index-DVObnatt.js";import"./FormItemContext-CG4o3aCY.js";import"./Checkbox-CHV8yuJS.js";import"./index-DtO8wbUi.js";import"./index-_b6N6Mhe.js";import"./colors-TmzmwKXv.js";import"./CheckOutlined-Nu5wJEo2.js";import"./Trigger-qqJEyN1K.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./index-B9b8kVtF.js";import"./index-DpON8wvi.js";import"./slide--PTaLm6c.js";import"./index-CNYsll_x.js";import"./DownOutlined-xHwfZhzl.js";import"./SearchOutlined-2-sBVYkv.js";import"./move-CfeIRdjT.js";import"./shallowequal-CCVEH32S.js";import"./axios-Cm0UX6qg.js";import"./qs-g-qVsYXK.js";import"./crypto-js-CsNcoEfj.js";import"./index-D0OvhCrn.js";import"./useMaxLevel-iyEeLMuD.js";import"./collapseMotion-D38MKU2V.js";import"./CaretDownFilled-P6q1_Q4R.js";import"./index-DncdWYWk.js";import"./responsiveObserve-nm9aPAMw.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./index-YK7vZYdC.js";import"./LeftOutlined-BL6rtvtT.js";import"./RightOutlined-C7Gymx4e.js";import"./index-CvnBYLiG.js";import"./index-DmWi8Hkf.js";import"./dropdown-aM3tBgR4.js";import"./Dropdown-DNhcw7uk.js";import"./index-D2p2Kdi5.js";import"./index-NJlqtEGH.js";import"./CaretDownOutlined-BxctymRA.js";import"./index-5PrSJtCq.js";import"./Input-DlD3j6GW.js";import"./inputProps-CIG3Q6HA.js";import"./Search-BjDfM7wD.js";import"./isPlainObject-B3m2dvNk.js";import"./TextArea-DnYx9N6z.js";import"./Password-B-_rMC_p.js";const X={class:"zm-date"},tt={class:"date-btn"},et={class:"date-content"},at={__name:"date",props:{datekey:{type:String,default:""}},emits:["dateChange"],setup(m,{emit:I}){const y=m,l=D(1),o=I;let S=z([{label:"近7日",value:!0,key:2,start_date:u().subtract(6,"day"),end_date:u().subtract(0,"day")},{label:"近14日",value:!1,key:3,start_date:u().subtract(13,"day"),end_date:u().subtract(0,"day")},{label:"近30日",value:!1,key:4,start_date:u().subtract(29,"day"),end_date:u().subtract(0,"day")}]);const b=D(null),C=D(null),v=D([]),$=e=>e>=u().subtract(0,"day"),x=()=>{let e=l.value,t=null;S.forEach(d=>{d.key==e&&(t=d)}),v.value=[t.start_date,t.end_date],b.value=t.start_date.startOf("day").unix(),C.value=t.end_date.endOf("day").unix(),_()},a=(e,t)=>{b.value=e[0].startOf("day").unix(),C.value=e[1].endOf("day").unix(),l.value=1,_()},_=()=>{o("dateChange",{start_time:b.value,end_time:C.value})};return F(()=>{l.value=parseInt(y.datekey),x()}),M(()=>y.datekey,(e,t)=>{l.value=parseInt(y.datekey.split("-")[0]),x()}),(e,t)=>{const d=L,g=Q,r=U;return s(),n("div",X,[f("div",tt,[i(g,{value:l.value,"onUpdate:value":t[0]||(t[0]=c=>l.value=c),onChange:x},{default:w(()=>[(s(!0),n(Y,null,T(k(S),c=>(s(),O(d,{class:"date-btn-button",value:c.key,key:c.key},{default:w(()=>[h(E(c.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),f("div",et,[i(r,{value:v.value,"onUpdate:value":t[1]||(t[1]=c=>v.value=c),onChange:a,format:"YYYY-MM-DD",disabledDate:$,allowClear:!1},null,8,["value"])])])}}},st=m=>(N("data-v-12a3c570"),m=m(),V(),m),ot={class:"user-model-page"},nt=st(()=>f("div",{class:"page-title"},"导出记录",-1)),rt={class:"list-wrapper"},it={class:"content-wrapper"},lt={class:"search-block"},dt={key:0,class:"status-item status-0"},_t={key:1,class:"status-item status-1"},ct={key:2,class:"status-item status-2"},ut={key:3,class:"status-item status-3"},pt=["onClick"],mt={key:1},yt={__name:"index",setup(m){const I=H(),y=B().query,l=D([]),o=z({robot_id:y.id,page:1,size:10,total:0,start_time:"",end_time:""}),S=a=>{o.page=a.current,o.size=a.pageSize,v()},b=()=>{o.page=1,v()},C=a=>{o.start_time=a.start_time,o.end_time=a.end_time,b()},v=()=>{q({...o}).then(a=>{let _=a.data.list,e=a.data.map;_.forEach(t=>{var d;t.create_time_desc=u(t.create_time*1e3).format("YYYY/MM/DD HH:mm"),t.source_desc=(d=e.filter(g=>g.source==t.source)[0])==null?void 0:d.source_name,t.is_over_7_days=t.create_time<Date.now()/1e3-7*24*60*60}),l.value=_,o.total=+a.data.total})},$=a=>{let _=`/manage/downloadExportFile?id=${a.id}&robot_id=${y.id}&token=${I.getToken}`;var e=document.createElement("a");e.href=_,e.style.display="none",e.click()},x=[{title:"导出时间",dataIndex:"create_time_desc",key:"create_time_desc"},{title:"导出文件名称",dataIndex:"file_name",key:"file_name"},{title:"来源",key:"source_desc",dataIndex:"source_desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action"}];return(a,_)=>{const e=G,t=K,d=W;return s(),n("div",ot,[nt,f("div",rt,[f("div",it,[i(e,{"show-icon":"",message:"导出文件仅保留7天，7天后自动删除，请及时下载到本地"}),f("div",lt,[i(at,{datekey:"2",onDateChange:C})]),i(d,{class:"table-list",columns:x,"data-source":l.value,pagination:{current:o.page,total:o.total,pageSize:o.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:S},{bodyCell:w(({column:g,record:r})=>[g.key==="status"?(s(),n(Y,{key:0},[r.status==0?(s(),n("div",dt,[i(k(J)),h("等待导出 ")])):p("",!0),r.status==1?(s(),n("div",_t,[i(k(P)),h("导出中 ")])):p("",!0),r.status==2?(s(),n("div",ct,[i(k(j)),h("导出成功 ")])):p("",!0),r.status==3?(s(),n("div",ut,[i(k(A)),h("导出失败 "),r.err_msg?(s(),O(t,{key:0},{title:w(()=>[h(E(r.err_msg),1)]),default:w(()=>[i(k(Z))]),_:2},1024)):p("",!0)])):p("",!0)],64)):p("",!0),g.key==="action"?(s(),n(Y,{key:1},[r.is_over_7_days?(s(),n("span",mt,"--")):(s(),n("a",{key:0,onClick:c=>$(r)},"下载",8,pt))],64)):p("",!0)]),_:1},8,["data-source","pagination"])])])])}}},ge=R(yt,[["__scopeId","data-v-12a3c570"]]);export{ge as default};
