import{C as zt}from"./cu-scroll-BZhESYtD.js";import{aD as X,bi as Ht,aI as ue,aK as Xe,bj as _e,bk as Et,A as it,b as ke,k as Z,d as ut,M as oe,f as _t,B as rt,bl as he,e as jt,bg as Bt,n as Ze,L as At,b3 as we,T as fe,E as Vt}from"../../index-DQXF0oEW.js";import{f as Ke,e as k,k as e,a4 as qe,a5 as Se,B as K,M as o,N as i,S as a,W as t,V as Gt,u as U,a7 as c,Q as I,F as N,$ as re,a6 as ct,Z as S,aa as Oe,Y as p,a1 as Fe,a2 as Le,b as et,x as Qt,D as Yt,ai as Jt,G as tt,a0 as Wt,H as Xt}from"./vue-chunks-DWnFCQSz.js";import{j as ge,r as Zt,k as Kt,l as eo,m as to,n as oo,o as ao,p as no,q as so}from"./index-CpYnoGfS.js";import{U as dt}from"./upload-input-DuLiXowb.js";import{t as ot}from"./validate-8MtiUsxW.js";import{F as ye,_ as Pe}from"./index-DpzELZe5.js";import"./index-9760vytK.js";import{I as be}from"./Input-COJTivTx.js";import"./index-CGW9ahOu.js";import{R as lo,_ as io}from"./RadioButton-Br4fysJT.js";import{M as uo}from"./model-select-DLutQAFv.js";import{O as _o}from"./open-grapg-modal-DkD7GAL6.js";import{D as ro}from"./DownOutlined-Bq0bLGm4.js";import{U as co}from"./UpOutlined-DA6kJIik.js";import{_ as po}from"./index-EaNfDv4H.js";import{S as Ue,_ as Ie}from"./index-B-Rt9SA5.js";import{R as mo}from"./rename-modal-BEgLWR3N.js";import{_ as fo}from"./page-alert-DkwWaGNk.js";import{C as vo}from"./index-C791tQco.js";import{g as ho,c as at,d as go,r as yo,a as ko}from"./index-CXDAzciJ.js";import{u as nt}from"./FormItemContext-D4f_Sq6G.js";import{M as bo}from"./MoreOutlined-Bxk_qxvK.js";import{_ as wo,M as Co}from"./index-dYCqajUf.js";import"./index-D51vnI4K.js";import{D as xo}from"./dropdown-yjtk7CCy.js";import{a as $o}from"./index-RZ7sMF92.js";import{S as Oo}from"./index-BmqzJuQZ.js";import{_ as qo}from"./index-CvML6ywu.js";import{P as So}from"./PlusOutlined-CP-yUfey.js";import{S as Fo}from"./SearchOutlined-Eloz0Xgr.js";import{C as Ce}from"./ClockCircleFilled-DBQsFSrd.js";import{S as Lo}from"./SyncOutlined-DvqqncSp.js";import{_ as Po}from"./index-Dq7FbVld.js";import{_ as Uo}from"./index-BZQEdDUD.js";import{_ as Io}from"./index-C7aLRSyU.js";import{_ as To}from"./index-CUGUQ2OU.js";import{a as Do}from"./index-CGOpBClO.js";import{_ as Mo}from"./TextArea-Cc6YC843.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-De-rn6vz.js";import"./crypto-js-U6t3rvpm.js";import"./dayjs-BI1HIvBC.js";import"./index-DzhuYAPB.js";import"./InboxOutlined-D-3D9tOA.js";import"./Trigger-CC5n-pw8.js";import"./isPlainObject-DGw0gsC3.js";import"./responsiveObserve-D-e1nmNx.js";import"./collapseMotion-ByInPrfq.js";import"./QuestionCircleOutlined-DN9kmFuV.js";import"./index-J-L5YNWa.js";import"./Search-Cm7pOAiq.js";import"./inputProps-Bb0ocHOp.js";import"./Password-DAfpdhAR.js";import"./statusUtils-B7nMMwz3.js";import"./Checkbox-CPCCCpS7.js";import"./index-DaUzcbAM.js";import"./slide-DBTiAtg1.js";import"./index-DwY9A703.js";import"./CheckOutlined-BrtNruPW.js";import"./move-DQ5ZIRU6.js";import"./index-CEo7CTw2.js";import"./index-TPMWTn8a.js";import"./colors-CunZT9q_.js";import"./shallowequal-C0Ji8tJB.js";import"./Dropdown-Cb2ylcsA.js";import"./RightOutlined-Ctvc7W-t.js";import"./partition-D4Qmrw-1.js";import"./useRefs-CH9tJ50T.js";import"./index-C5rBiNWQ.js";import"./useMaxLevel-C0rdSqjh.js";import"./css-DbBMd65r.js";import"./fromPairs-Dx9PT-t0.js";import"./LeftOutlined-CbjqBZdV.js";import"./CaretDownOutlined-CbrsSkGN.js";const xe=()=>({format:String,showNow:_e(),showHour:_e(),showMinute:_e(),showSecond:_e(),use12Hours:_e(),hourStep:Number,minuteStep:Number,secondStep:Number,hideDisabledOptions:_e(),popupClassName:String,status:Et()});function Ro(d){const y=ho(d,X(X({},xe()),{order:{type:Boolean,default:!0}})),{TimePicker:b,RangePicker:F}=y,m=Ke({name:"ATimePicker",inheritAttrs:!1,props:X(X(X(X({},at()),go()),xe()),{addon:{type:Function}}),slots:Object,setup(L,M){let{slots:O,expose:q,emit:g,attrs:r}=M;const u=L,w=nt();Ht(!(O.addon||u.addon),"TimePicker","`addon` is deprecated. Please use `v-slot:renderExtraFooter` instead.");const T=k();q({focus:()=>{var s;(s=T.value)===null||s===void 0||s.focus()},blur:()=>{var s;(s=T.value)===null||s===void 0||s.blur()}});const R=(s,C)=>{g("update:value",s),g("change",s,C),w.onFieldChange()},z=s=>{g("update:open",s),g("openChange",s)},E=s=>{g("focus",s)},Y=s=>{g("blur",s),w.onFieldBlur()},v=s=>{g("ok",s)};return()=>{const{id:s=w.id.value}=u;return e(b,ue(ue(ue({},r),Xe(u,["onUpdate:value","onUpdate:open"])),{},{id:s,dropdownClassName:u.popupClassName,mode:void 0,ref:T,renderExtraFooter:u.addon||O.addon||u.renderExtraFooter||O.renderExtraFooter,onChange:R,onOpenChange:z,onFocus:E,onBlur:Y,onOk:v}),O)}}}),J=Ke({name:"ATimeRangePicker",inheritAttrs:!1,props:X(X(X(X({},at()),yo()),xe()),{order:{type:Boolean,default:!0}}),slots:Object,setup(L,M){let{slots:O,expose:q,emit:g,attrs:r}=M;const u=L,w=k(),T=nt();q({focus:()=>{var f;(f=w.value)===null||f===void 0||f.focus()},blur:()=>{var f;(f=w.value)===null||f===void 0||f.blur()}});const R=(f,B)=>{g("update:value",f),g("change",f,B),T.onFieldChange()},z=f=>{g("update:open",f),g("openChange",f)},E=f=>{g("focus",f)},Y=f=>{g("blur",f),T.onFieldBlur()},v=(f,B)=>{g("panelChange",f,B)},s=f=>{g("ok",f)},C=(f,B,ee)=>{g("calendarChange",f,B,ee)};return()=>{const{id:f=T.id.value}=u;return e(F,ue(ue(ue({},r),Xe(u,["onUpdate:open","onUpdate:value"])),{},{id:f,dropdownClassName:u.popupClassName,picker:"time",mode:void 0,ref:w,onChange:R,onOpenChange:z,onFocus:E,onBlur:Y,onPanelChange:v,onOk:s,onCalendarChange:C}),O)}}});return{TimePicker:m,TimeRangePicker:J}}const{TimePicker:ve,TimeRangePicker:$e}=Ro(ko),pt=X(ve,{TimePicker:ve,TimeRangePicker:$e,install:d=>(d.component(ve.name,ve),d.component($e.name,$e),d)});var No={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const zo=No;function st(d){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?Object(arguments[y]):{},F=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(F=F.concat(Object.getOwnPropertySymbols(b).filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable}))),F.forEach(function(m){Ho(d,m,b[m])})}return d}function Ho(d,y,b){return y in d?Object.defineProperty(d,y,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[y]=b,d}var Te=function(y,b){var F=st({},y,b.attrs);return e(it,st({},F,{icon:zo}),null)};Te.displayName="CopyOutlined";Te.inheritAttrs=!1;const Eo=Te;var jo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};const Bo=jo;function lt(d){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?Object(arguments[y]):{},F=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(F=F.concat(Object.getOwnPropertySymbols(b).filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable}))),F.forEach(function(m){Ao(d,m,b[m])})}return d}function Ao(d,y,b){return y in d?Object.defineProperty(d,y,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[y]=b,d}var De=function(y,b){var F=lt({},y,b.attrs);return e(it,lt({},F,{icon:Bo}),null)};De.displayName="HourglassFilled";De.inheritAttrs=!1;const Vo=De,Go={class:"form-box"},Qo={class:"upload-document-type-box"},Yo=["onClick"],Jo={class:"right-block"},Wo={class:"title-block"},Xo={class:"title-text"},Zo={class:"desc"},Ko={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(d,{expose:y,emit:b}){const F=qe(),m=Se(),J=ye.useForm,L=k(!1),M=k("添加自定义文档"),O=d,q=K({library_id:m.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),g=k([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),r=v=>{q.qa_index_type=v},u=K({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:w,validate:T,validateInfos:R}=J(q,u),z=()=>{L.value=!0,w(),q.file_name="",q.is_qa_doc=0,q.qa_index_type=1,O.libraryInfo.type==2&&(q.is_qa_doc=1)},E=k(!1),Y=()=>{T().then(()=>{let v={...Oe(q)};E.value=!0,ge(v).then(s=>{Z.success(`${M.value}成功`),L.value=!1,F.push("/library/preview?id="+s.data.file_ids[0])}).finally(()=>{E.value=!1})})};return y({add:z}),(v,s)=>{const C=be,f=Pe,B=lo,ee=io,ne=ut,x=ye,te=oe;return o(),i("div",null,[e(te,{open:L.value,"onUpdate:open":s[2]||(s[2]=H=>L.value=H),title:M.value,onOk:Y,width:"472px",confirmLoading:E.value},{default:a(()=>[t("div",Go,[e(x,{layout:"vertical"},{default:a(()=>[e(f,Gt({label:"文档名称"},U(R).file_name),{default:a(()=>[e(C,{type:"text",placeholder:"请输入文档名称",value:q.file_name,"onUpdate:value":s[0]||(s[0]=H=>q.file_name=H)},null,8,["value"])]),_:1},16),c("",!0),q.is_qa_doc==1?(o(),I(f,{key:1,label:"索引方式",required:""},{default:a(()=>[t("div",Qo,[(o(!0),i(N,null,re(g.value,H=>(o(),i("div",{class:ct(["type-item",{active:q.qa_index_type==H.value}]),key:H.value,onClick:Re=>r(H.value)},[t("div",Jo,[t("div",Wo,[e(ne,{name:q.qa_index_type==H.value?H.iconNameActive:H.iconName},null,8,["name"]),t("div",Xo,S(H.title),1)]),t("div",Zo,S(H.desc),1)]),q.qa_index_type==H.value?(o(),I(ne,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):c("",!0)],10,Yo))),128))])]),_:1})):c("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},ea=ke(Ko,[["__scopeId","data-v-0fbc9294"]]),ae=d=>(Fe("data-v-64d599b8"),d=d(),Le(),d),ta={class:"alert-box"},oa=ae(()=>t("div",null,[p(" 通过word或者EXce形式导入问答对，建议您参考"),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ导入模板.docx"},"word导入模板"),p("  "),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/template/FAQ 导入模板.xlsx"},"Excel导入模板"),p("创建导入文档 ")],-1)),aa=ae(()=>t("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)),na={class:"upload-file-box"},sa={key:0,class:"hight-set"},la={key:0,class:"set-box"},ia={class:"form-item"},ua=ae(()=>t("div",{class:"form-item-label"},"问题所在列：",-1)),_a={class:"form-item-body"},ra={class:"form-item"},ca=ae(()=>t("div",{class:"form-item-label"},"相似问法所在列：",-1)),da={class:"form-item-body"},pa={class:"form-item"},ma=ae(()=>t("div",{class:"form-item-label"},"答案所在列：",-1)),fa={class:"form-item-body"},va={key:1,class:"set-box"},ha={class:"form-item"},ga=ae(()=>t("div",{class:"form-item-label"},"问题开始标识符：",-1)),ya={class:"form-item-body"},ka={class:"form-item"},ba=ae(()=>t("div",{class:"form-item-label"},"相似问法开始标识符：",-1)),wa={class:"form-item-body"},Ca={class:"form-item"},xa=ae(()=>t("div",{class:"form-item-label"},"答案开始标识符：",-1)),$a={class:"form-item-body"},Oa={__name:"qa-upload-modal",emits:["ok"],setup(d,{expose:y,emit:b}){const F=qe(),J=Se().query,L=k(!1),M=k(!1),O=k([]),q=b,g=k([]),r=K({question_column:void 0,answer_column:void 0,similar_column:void 0,question_lable:"问题：",answer_lable:"答案：",similar_label:"相似问题："}),u=k(!0),w=()=>{L.value=!0},T=()=>{let v=new FormData;O.value.forEach(s=>{v.append("library_files",s)}),Zt(v).then(s=>{let C=[];for(let f in s.data)C.push({lable:s.data[f],value:f});g.value=C})},R=()=>{if(O.value.length==0){Z.error("请选择文件");return}M.value=!0;let v=new FormData;v.append("library_id",J.id);let s=!1;O.value.forEach(C=>{(C.name.includes(".xlsx")||C.name.includes(".csv"))&&(s=!0),v.append("library_files",C)}),s?(v.append("question_column",r.question_column),v.append("answer_column",r.answer_column),r.similar_column&&v.append("similar_column",r.similar_column)):(v.append("question_lable",r.question_lable),v.append("answer_lable",r.answer_lable),v.append("similar_label",r.similar_label)),v.append("is_qa_doc",1),ge(v).then(C=>{q("ok"),L.value=!1,O.value=[],M.value=!1,s&&F.push("/library/document-segmentation?document_id="+C.data.file_ids[0])}).catch(()=>{M.value=!1})},z=()=>{O.value=[]},E=k(1),Y=v=>{r.question_column=void 0,r.answer_column=void 0,r.similar_column=void 0,r.question_lable="问题：",r.answer_lable="答案：",r.similar_label="相似问题：",O.value=v,v&&v.length>0&&(v[0].type.includes(".document")?E.value=2:(E.value=1,T()))};return y({show:w}),(v,s)=>{const C=po,f=Ue,B=Ie,ee=be,ne=oe;return o(),i("div",null,[e(ne,{width:680,open:L.value,"onUpdate:open":s[8]||(s[8]=x=>L.value=x),"confirm-loading":M.value,maskClosable:!1,title:"上传文档",onOk:R,onCancel:z},{default:a(()=>[t("div",ta,[e(C,{"show-icon":""},{message:a(()=>[oa,aa]),_:1})]),t("div",na,[e(dt,{type:2,value:O.value,"onUpdate:value":s[0]||(s[0]=x=>O.value=x),onChange:Y},null,8,["value"])]),O.value.length>0?(o(),i("div",sa,[t("a",{onClick:s[1]||(s[1]=x=>u.value=!u.value)},[p("高级设置： "),u.value?(o(),I(U(co),{key:1})):(o(),I(U(ro),{key:0}))]),u.value?(o(),i(N,{key:0},[E.value==1?(o(),i("div",la,[t("div",ia,[ua,t("div",_a,[e(B,{value:r.question_column,"onUpdate:value":s[2]||(s[2]=x=>r.question_column=x),placeholder:"请选择列名",style:{width:"100%"}},{default:a(()=>[(o(!0),i(N,null,re(g.value,x=>(o(),I(f,{value:x.value,key:x.value},{default:a(()=>[p(S(x.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",ra,[ca,t("div",da,[e(B,{value:r.similar_column,"onUpdate:value":s[3]||(s[3]=x=>r.similar_column=x),placeholder:"请选择相似问题所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(N,null,re(g.value,x=>(o(),I(f,{value:x.value,key:x.value},{default:a(()=>[p(S(x.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",pa,[ma,t("div",fa,[e(B,{value:r.answer_column,"onUpdate:value":s[4]||(s[4]=x=>r.answer_column=x),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:a(()=>[(o(!0),i(N,null,re(g.value,x=>(o(),I(f,{value:x.value,key:x.value},{default:a(()=>[p(S(x.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):c("",!0),E.value==2?(o(),i("div",va,[t("div",ha,[ga,t("div",ya,[e(ee,{placeholder:"请输入标识符",value:r.question_lable,"onUpdate:value":s[5]||(s[5]=x=>r.question_lable=x)},null,8,["value"])])]),t("div",ka,[ba,t("div",wa,[e(ee,{placeholder:"请输入标识符",value:r.similar_label,"onUpdate:value":s[6]||(s[6]=x=>r.similar_label=x)},null,8,["value"])])]),t("div",Ca,[xa,t("div",$a,[e(ee,{placeholder:"请输入标识符",value:r.answer_lable,"onUpdate:value":s[7]||(s[7]=x=>r.answer_lable=x)},null,8,["value"])])])])):c("",!0)],64)):c("",!0)])):c("",!0)]),_:1},8,["open","confirm-loading"])])}}},qa=ke(Oa,[["__scopeId","data-v-64d599b8"]]),Sa="/assets/img/guide-image-DSu20zRj.png",Me=d=>(Fe("data-v-d94a3a33"),d=d(),Le(),d),Fa={class:"container"},La={class:"guide-content"},Pa=Me(()=>t("img",{src:Sa,alt:"操作引导",class:"guide-image"},null,-1)),Ua={class:"content-box"},Ia=Me(()=>t("div",{class:"content-info"},'单次上传多个文档，上传成功后，需要手动点击文档后面 "学习" 进行学习；如果文档学习失败，支持重新学习',-1)),Ta=Me(()=>t("div",{class:"content-check"},"不再显示此提示",-1)),Da={__name:"guide-learning-tips",setup(d,{expose:y}){const b=_t(),F=k(!1),m=k(!1),J=k(""),L=()=>{setTimeout(()=>{F.value=!0},500)},M=()=>{b.setGuideLearningTips(m.value),F.value=!1},O=()=>{b.setGuideLearningTips(m.value),F.value=!1};return y({show:L}),(q,g)=>{const r=vo,u=rt,w=oe;return o(),i("div",Fa,[e(w,{open:F.value,"onUpdate:open":g[1]||(g[1]=T=>F.value=T),title:J.value,onOk:M,onCancel:O,width:"472px"},{footer:a(()=>[e(u,{type:"primary",onClick:M},{default:a(()=>[p("我知道了")]),_:1})]),default:a(()=>[t("div",La,[Pa,t("div",Ua,[Ia,e(r,{checked:m.value,"onUpdate:checked":g[0]||(g[0]=T=>m.value=T)},{default:a(()=>[Ta]),_:1},8,["checked"])])])]),_:1},8,["open","title"])])}}},Ma=ke(Da,[["__scopeId","data-v-d94a3a33"]]),Ra={__name:"edit-online-doc",emits:["ok"],setup(d,{expose:y,emit:b}){const F=b,m=K({id:"",file_name:"",doc_auto_renew_frequency:1,doc_auto_renew_minute:""}),J=k({file_name:[{message:"请文档名称",required:!0}],doc_auto_renew_frequency:[{message:"请选择更新频率",required:!0}]}),L=k(!1),M=r=>{r=JSON.parse(JSON.stringify(r)),m.id=r.id||"",m.file_name=r.file_name||"",m.doc_auto_renew_frequency=+r.doc_auto_renew_frequency||1,r.doc_auto_renew_minute>0&&(m.doc_auto_renew_minute=he(r.doc_auto_renew_minute)),L.value=!0},O=k(!1),q=k(null),g=()=>{q.value.validate().then(()=>{O.value=!0,Kt({...m,doc_auto_renew_minute:m.doc_auto_renew_minute?he(m.doc_auto_renew_minute):0}).then(()=>{L.value=!1,O.value=!1,F("ok")})}).catch(()=>{O.value=!1})};return y({show:M}),(r,u)=>{const w=be,T=Pe,R=Ue,z=Ie,E=pt,Y=ye,v=oe;return o(),i("div",null,[e(v,{open:L.value,"onUpdate:open":u[3]||(u[3]=s=>L.value=s),"confirm-loading":O.value,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:g},{default:a(()=>[e(Y,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:q,model:m,rules:J.value},{default:a(()=>[e(T,{name:"file_name",label:"文件名称"},{default:a(()=>[e(w,{value:m.file_name,"onUpdate:value":u[0]||(u[0]=s=>m.file_name=s),placeholder:"请输入"},null,8,["value"])]),_:1}),e(T,{name:"doc_auto_renew_frequency",label:"更新频率"},{default:a(()=>[e(z,{value:m.doc_auto_renew_frequency,"onUpdate:value":u[1]||(u[1]=s=>m.doc_auto_renew_frequency=s),style:{width:"100%"}},{default:a(()=>[e(R,{value:1},{default:a(()=>[p("不自动更新")]),_:1}),e(R,{value:2},{default:a(()=>[p("每天")]),_:1}),e(R,{value:3},{default:a(()=>[p("每3天")]),_:1}),e(R,{value:4},{default:a(()=>[p("每7天")]),_:1}),e(R,{value:5},{default:a(()=>[p("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),m.doc_auto_renew_frequency>1?(o(),I(T,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(E,{valueFormat:"HH:mm",value:m.doc_auto_renew_minute,"onUpdate:value":u[2]||(u[2]=s=>m.doc_auto_renew_minute=s),format:"HH:mm"},null,8,["value"])]),_:1})):c("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"])])}}},V=d=>(Fe("data-v-98f8d439"),d=d(),Le(),d),Na={class:"details-library-page"},za={class:"list-tools"},Ha={class:"tools-items"},Ea={class:"tool-item"},ja={class:"dropdown-btn-menu"},Ba=V(()=>t("div",{class:"title"},"本地文档",-1)),Aa={key:0,class:"desc"},Va={key:1,class:"desc"},Ga={class:"dropdown-btn-menu"},Qa=V(()=>t("div",{class:"title"},"在线数据",-1)),Ya=V(()=>t("div",{class:"desc"},"获取在线网页内容",-1)),Ja={class:"dropdown-btn-menu"},Wa=V(()=>t("div",{class:"title"},"自定义文档",-1)),Xa=V(()=>t("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1)),Za=V(()=>t("span",null,"添加内容",-1)),Ka=V(()=>t("span",null,"嵌入模型：",-1)),en=V(()=>t("span",null,"生成知识图谱：",-1)),tn={class:"right-box"},on={key:0,class:"status-box"},an={class:"status-item"},nn=V(()=>t("div",{class:"status-label"},"已学习：",-1)),sn={class:"status-content"},ln={class:"status-item"},un=V(()=>t("div",{class:"status-label"},"，未学习：",-1)),_n={class:"status-content content-tip"},rn={class:"status-item"},cn=V(()=>t("div",{class:"status-label"},"，学习失败：",-1)),dn={class:"status-content content-tip"},pn={key:1,class:"status-select-box"},mn={class:"tool-item"},fn=V(()=>t("div",null,[t("p",null,' 1、如果单次上传一个文档，上传成功后，系统会自动学习；如果单次上传多个文档，上传成功后，需要手动点击文档后面"学习"进行学习；如果解析失败，支持重新学习。 '),t("p",null,"2、未学习的文档数据不会被检索到。")],-1)),vn={class:"list-content"},hn={key:0,class:"doc-name-td"},gn=["href"],yn=["onClick"],kn={key:0},bn={key:1},wn=["onClick"],Cn={key:0},xn={key:1},$n={key:2,class:"url-remark"},On={key:0,class:"pdf-progress-box"},qn={class:"progress-title"},Sn={class:"status-box"},Fn=["onClick"],Ln={class:"progress-bar"},Pn={class:"num-box"},Un={key:0,class:"status-tag running"},In={key:2,class:"status-tag running"},Tn={key:3,class:"status-tag complete"},Dn={class:"status-tag status-error"},Mn=["onClick"],Rn={class:"status-tag status-error"},Nn={class:"status-tag"},zn=["onClick"],Hn={key:7,class:"status-tag"},En={key:8,class:"status-tag running"},jn={class:"status-tag error"},Bn={key:10,class:"status-tag cancel"},An={class:"status-tag"},Vn=["onClick"],Gn={key:1,class:"status-tag running"},Qn={key:2,class:"status-tag complete"},Yn={class:"status-tag error"},Jn=["onClick"],Wn={class:"zm-line1 reason-text"},Xn={key:4,class:"status-tag running"},Zn={class:"status-tag warning"},Kn={class:"reason-text"},es=["onClick"],ts={key:0},os={key:1},as={key:0,class:"text-block"},ns={class:"time-content-box"},ss={key:0},ls={key:1},is={key:2},us={key:3},_s={key:4},rs={key:5,class:"ml4"},cs={key:6},ds=["onClick"],ps=V(()=>t("a",{class:"ml4 btn-hover-block"},"更新",-1)),ms={key:1},fs={key:0},vs={key:1},hs=["onClick"],gs=["onClick"],ys=["onClick"],ks=V(()=>t("span",null,"删除",-1)),bs={class:"upload-file-box"},ws={class:"select-card-box"},Cs=["onClick"],xs={class:"card-title"},$s={class:"card-desc"},Os={__name:"knowledge-document",setup(d){const y=jt(),b=et(()=>{var l;return((l=y.companyInfo)==null?void 0:l.neo4j_status)=="true"}),F=_t(),m=[{key:2,title:"图文OCR解析",icon:"pdf-ocr",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",icon:"pdf-text",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"},{key:3,title:"图文解析",icon:"pdf-img",desc:"提取PDF文档中的图片和文字"}],J=Se(),L=qe(),M=J.query,O=k(!1),q=k(null),g=k(null),r=k(!1),u=k({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0});K({selectedRowKeys:[]});const w=K({use_model:"",model_config_id:""}),T=(l,_)=>{let $=_.modelName,j=_.modelId;v.value.length>0?oe.confirm({title:`确定切换模型为${$}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){w.use_model=$,w.model_config_id=j,R()},onCancel(){}}):(w.use_model=$,w.model_config_id=j,R())},R=(l=!0,_=null)=>{to({...Oe(u.value),use_model:w.use_model,model_config_id:w.model_config_id}).then(()=>{u.value.use_model=w.use_model,u.value.model_config_id=w.model_config_id,typeof _=="function"&&_(),l&&Z.success("保存成功")})},z=k([]),E=l=>{z.value=l,Y()},Y=()=>{if(!u.value.id){setTimeout(()=>{Y()},100);return}if(z.value.length>0&&!u.value.use_model){let l=null,_=null;for(let $ of z.value)if($.model_define==="chatwiki"){l=$;for(let j of l.children)if(j.name==="text-embedding-v2"){_=j;break}break}l||(l=z.value[0],_=l.children[0]),l&&(w.use_model=_.name,w.model_config_id=_.model_config_id,R(!1))}},v=k([]),s=K({learned_err_count:0,learned_count:0,learned_wait_count:0}),C=K({library_id:M.id,file_name:void 0,status:"",page:1,size:10,total:0}),f=[{id:"",name:"全部"},{id:"4",name:"待学习"},{id:"8",name:"部分失败"},{id:"3",name:"全部失败"},{id:"2",name:"成功"}],B=k([]),ee=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"更新频率/时间",dataIndex:"doc_auto_renew_frequency",key:"doc_auto_renew_frequency",width:260},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"文档状态",dataIndex:"status",key:"status",width:200},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],ne=l=>{te()},x=l=>{C.page=l.current,C.size=l.pageSize,G()},te=()=>{C.page=1,G()};let H=!1;const Re=({id:l})=>{v.value.length==1&&(H=!0),oo({id:l}).then(()=>{H&&C.page>1&&C.page--,G(),Z.success("删除成功")})},se=(l,_={})=>{if(l.status=="4")return L.push({path:"/library/document-segmentation",query:{document_id:l.id}});if(l.status=="3"&&u.value.type!=2)return Z.error("学习失败,不可预览");if(l.status=="0")return Z.error("转换中,稍候可预览");if(l.status=="6")return Z.error("获取中,不可预览");if(l.status=="7")return Z.error("获取失败,不可预览");L.push({name:"libraryPreview",query:{id:l.id,..._}})},G=()=>{let l=Oe(C);l.status==0&&(l.status=""),O.value=!0,eo(l).then(_=>{let $=_.data.info;!w.use_model&&w.use_model!=$.use_model&&(w.use_model=$.use_model,w.model_config_id=$.model_config_id),u.value={...$},r.value=$.graph_switch==1,$.graph_switch=="0"||!b.value?B.value=ee.filter(Q=>!["graph_status","graph_entity_count"].includes(Q.key)):B.value=ee;let j=_.data.list||[],W=_.data.count_data||{};C.total=_.data.total,s.learned_count=W.learned_count,s.learned_err_count=W.learned_err_count,s.learned_wait_count=W.learned_wait_count;let le=!1;v.value=j.map(Q=>(["1","6","0","5","4"].includes(Q.status)&&(le=!0),Q.file_size_str=Bt(Q.file_size),Q.update_time=Ze(Q.update_time*1e3).format("YYYY-MM-DD HH:mm"),Q.doc_last_renew_time_desc=Q.doc_last_renew_time>0?Ze(Q.doc_last_renew_time*1e3).format("YYYY-MM-DD HH:mm"):"--",Q)),le&&mt(),!le&&clearInterval(ce.value)}).finally(()=>{O.value=!1})},ce=k(null),mt=()=>{clearInterval(ce.value),ce.value=setInterval(()=>{G()},1e3*5)},Ne=k(null),ft=l=>{if(z.value.length==0){oe.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){L.push({path:"/user/model"})}});return}let{key:_}=l;_==1&&yt(),_==2&&vt(),_==3&&Ne.value.add()},P=K({open:!1,urls:"",library_id:M.id,doc_auto_renew_frequency:1,confirmLoading:!1,doc_auto_renew_minute:"",rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(l,_)=>ot(_)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),vt=()=>{P.open=!0,P.confirmLoading=!1,P.urls="",P.doc_auto_renew_minute="02:00",P.doc_auto_renew_frequency=1},ze=k(null),ht=()=>{ze.value.validate().then(()=>{P.confirmLoading=!0,ge({library_id:P.library_id,urls:JSON.stringify(ot(P.urls)),doc_auto_renew_frequency:P.doc_auto_renew_frequency,doc_auto_renew_minute:he(P.doc_auto_renew_minute),doc_type:2}).then(()=>{P.open=!1,P.confirmLoading=!1,te()})}).catch(()=>{P.confirmLoading=!1})},gt=()=>{P.open=!1},D=K({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),He=et(()=>D.fileList.filter(l=>l.type==="application/pdf").length>0),Ee=k(null),yt=()=>{if(u.value.type==2){Ee.value.show();return}D.fileList=[],D.open=!0},kt=()=>{D.fileList=[]},bt=l=>{D.fileList=l},wt=()=>{if(q.value&&!F.getGuideLearningTips&&D.fileList.length>1&&q.value.show(),D.fileList.length==0){Z.error("请选择文件");return}D.confirmLoading=!0;let l=new FormData;l.append("library_id",C.library_id);let _=!1;D.fileList.forEach($=>{($.name.includes(".xlsx")||$.name.includes(".csv"))&&(_=!0),l.append("library_files",$)}),He.value&&l.append("pdf_parse_type",D.pdf_parse_type),ge(l).then($=>{G(),D.open=!1,D.fileList=[],D.confirmLoading=!1,_&&$.data.file_ids.length==1&&L.push("/library/document-segmentation?document_id="+$.data.file_ids[0])}).catch(()=>{D.confirmLoading=!1})},je=k(null),Ct=l=>{je.value.show(l)},xt=l=>{L.push({path:"/library/document-segmentation",query:{document_id:l.id}})},Be=l=>{ao({id:l.id}).then(()=>{G()})},$t=()=>{if(r.value){r.value=!1;let l={graph_model_config_id:u.value.graph_model_config_id,graph_use_model:u.value.graph_use_model};if((!l.graph_model_config_id||!l.graph_use_model)&&z.value.length>0){let $=z.value[0].children[0];l.graph_use_model=$.name,l.graph_model_config_id=$.model_config_id}g.value.show(l)}else u.value.graph_switch=0,R(!1,()=>{G()})},Ot=l=>{r.value=!0,u.value.graph_switch=1,u.value.graph_model_config_id=l.graph_model_config_id,u.value.graph_use_model=l.graph_use_model,R(!1,()=>{G()})},qt=l=>{D.pdf_parse_type=l.key},Ae=k(null),Ve=l=>{Ae.value.show({...l})},St=l=>{no({id:l.id}).then(_=>{Z.success("更新成功"),G()})},Ft=l=>{oe.confirm({title:"取消确认？",content:"确认取消该文档解析",okText:"确定",onOk(){so({id:l.id}).then(_=>{Z.success("取消成功"),G()})}})};return Qt(()=>{G()}),Yt(()=>{ce.value&&clearInterval(ce.value)}),(l,_)=>{const $=ut,j=Po,W=wo,le=Co,Q=rt,Ge=xo,Lt=Uo,ie=Ue,Qe=Ie,Pt=be,Ut=Io,It=$o,me=Oo,de=To,Ye=qo,Tt=Do,Dt=zt,pe=Pe,Je=ye,We=oe,Mt=Mo,Rt=pt,Nt=Jt("copy");return o(),i("div",Na,[e(Dt,{scrollbar:!1},{default:a(()=>[t("div",za,[t("div",Ha,[t("div",Ea,[e(Ge,{trigger:["hover"],overlayClassName:"add-dropdown-btn"},{overlay:a(()=>[e(le,{onClick:ft},{default:a(()=>[(o(),I(W,{key:1},{default:a(()=>[t("div",ja,[e(j,{class:"title-block",gap:4},{default:a(()=>[e($,{name:"doc-icon"}),Ba]),_:1}),u.value.type==2?(o(),i("div",Aa," 上传本地 docx/csv/xlsx 等格式文件 ")):(o(),i("div",Va," 上传本地 pdf/docx/txt/md/xlsx/csv/html 等格式文件 "))])]),_:1})),u.value.type!=2?(o(),I(W,{key:2},{default:a(()=>[t("div",Ga,[e(j,{class:"title-block",gap:4},{default:a(()=>[e($,{name:"link-icon"}),Qa]),_:1}),Ya])]),_:1})):c("",!0),(o(),I(W,{key:3},{default:a(()=>[t("div",Ja,[e(j,{class:"title-block",gap:4},{default:a(()=>[e($,{name:"cu-doc-icon"}),Wa]),_:1}),Xa])]),_:1}))]),_:1})]),default:a(()=>[e(Q,{type:"primary"},{icon:a(()=>[e(U(So))]),default:a(()=>[Za]),_:1})]),_:1})]),tt(e(j,{align:"center",class:"tool-item custom-select-box"},{default:a(()=>[Ka,e(uo,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:w.use_model,modeId:w.model_config_id,style:{width:"240px"},onChange:T,onLoaded:E},null,8,["modeName","modeId"])]),_:1},512),[[Xt,!1]]),b.value?(o(),I(j,{key:0,align:"center",class:"tool-item custom-select-box pd-5-8"},{default:a(()=>[en,e(Lt,{checked:r.value,"onUpdate:checked":_[0]||(_[0]=h=>r.value=h),onChange:$t,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):c("",!0)]),t("div",tn,[u.value.type==0?(o(),i("div",on,[t("div",an,[nn,t("div",sn,S(s.learned_count),1)]),t("div",ln,[un,t("div",_n,S(s.learned_wait_count),1)]),t("div",rn,[cn,t("div",dn,S(s.learned_err_count),1)])])):c("",!0),u.value.type==0?(o(),i("div",pn,[e(Qe,{value:C.status,"onUpdate:value":_[1]||(_[1]=h=>C.status=h),style:{width:"150px"},placeholder:"请选择",onChange:ne},{default:a(()=>[(o(),i(N,null,re(f,h=>e(ie,{key:h.id,value:h.id},{default:a(()=>[p(S(h.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])])):c("",!0),t("div",mn,[e(Pt,{style:{width:"282px"},value:C.file_name,"onUpdate:value":_[2]||(_[2]=h=>C.file_name=h),placeholder:"请输入文档名称搜索",onChange:te},{suffix:a(()=>[e(U(Fo),{onClick:te,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),u.value.type==0?(o(),I(fo,{key:0,style:{"margin-bottom":"16px"},title:"使用说明"},{default:a(()=>[fn]),_:1})):c("",!0),t("div",vn,[e(Tt,{columns:B.value,"data-source":v.value,scroll:{x:1e3},"row-key":"id",pagination:{current:C.page,total:C.total,pageSize:C.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:x},{bodyCell:a(({column:h,record:n})=>[h.key==="file_name"?(o(),i("div",hn,[n.doc_type==2?(o(),I(Ut,{key:0,title:null},{content:a(()=>[p(" 原链接："),t("a",{href:n.doc_url,target:"_blank"},S(n.doc_url),9,gn),tt(e(U(Eo),{style:{"margin-left":"4px",cursor:"pointer"}},null,512),[[Nt,`${n.doc_url}`]])]),default:a(()=>[t("a",{onClick:A=>se(n)},[["5","6","7"].includes(n.status)?(o(),i("span",kn,S(n.doc_url),1)):(o(),i("span",bn,S(n.file_name),1))],8,yn)]),_:2},1024)):(o(),i("a",{key:1,onClick:A=>se(n)},[["5","6","7"].includes(n.status)?(o(),i("span",Cn,S(n.doc_url),1)):(o(),i("span",xn,S(n.file_name),1))],8,wn)),n.doc_type==2&&n.remark?(o(),i("div",$n," 备注："+S(n.remark),1)):c("",!0)])):c("",!0),h.key==="status"?(o(),i(N,{key:1},[n.file_ext=="pdf"&&n.pdf_parse_type>=2?(o(),i(N,{key:0},[n.status==0?(o(),i("div",On,[t("div",qn,[t("span",Sn,[e(U(At)),p("文档解析中")]),t("a",{onClick:A=>Ft(n)},"取消",8,Fn)]),t("div",Ln,[e(It,{size:"small",class:"progress-bar-box",percent:parseInt(n.ocr_pdf_index/n.ocr_pdf_total*100),"show-info":!1},null,8,["percent"]),t("div",Pn,S(n.ocr_pdf_index)+" / "+S(n.ocr_pdf_total),1)])])):c("",!0)],64)):(o(),i(N,{key:1},[n.status==0?(o(),i("span",Un,[e(me,{size:"small"}),p(" 转换中")])):c("",!0)],64)),n.status==1?(o(),i("span",In,[e(me,{size:"small"}),p(" 学习中")])):c("",!0),n.status==2?(o(),i("span",Tn,[e(U(we)),p(" 学习完成")])):c("",!0),n.status==3?(o(),I(de,{key:4,placement:"top"},{title:a(()=>[t("span",null,S(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",Dn,[e(U(fe)),p(" 转换失败")]),u.value.type==2?(o(),i("a",{key:0,class:"ml8",onClick:A=>se(n)},"学习",8,Mn)):c("",!0)])]),_:2},1024)):c("",!0),n.status==8?(o(),I(de,{key:5,placement:"top"},{title:a(()=>[t("span",null,S(n.errmsg),1)]),default:a(()=>[t("span",null,[t("span",Rn,[e(U(fe)),p(" 转化异常")])])]),_:2},1024)):c("",!0),n.status==4?(o(),i(N,{key:6},[t("span",Nn,[e(U(Ce)),p(" 待学习")]),t("a",{class:"ml8",onClick:A=>se(n)},"学习",8,zn)],64)):c("",!0),n.status==5?(o(),i("span",Hn,[e(U(Ce)),p(" 待获取")])):c("",!0),n.status==6?(o(),i("span",En,[e(me,{size:"small"}),p(" 获取中")])):c("",!0),n.status==7?(o(),I(de,{key:9,placement:"top"},{title:a(()=>[t("span",null,S(n.errmsg),1)]),default:a(()=>[t("span",jn,[e(U(fe)),p(" 获取失败")])]),_:2},1024)):c("",!0),n.status==9?(o(),i("span",Bn,[e(U(Vt)),p(" 取消解析")])):c("",!0)],64)):c("",!0),h.key==="graph_status"?(o(),i(N,{key:2},[n.graph_status==0?(o(),i(N,{key:0},[t("span",An,[e(U(Ce)),p(" 待生成")]),t("a",{class:"ml8",onClick:A=>Be(n)},"生成",8,Vn)],64)):n.graph_status==1?(o(),i("span",Gn,[e(U(Vo)),p(" 排队中")])):n.graph_status==2?(o(),i("span",Qn,[e(U(we)),p(" 生成完成")])):n.graph_status==3?(o(),i(N,{key:3},[t("span",Yn,[e(U(fe)),p(" 生成失败")]),t("a",{class:"ml8",onClick:A=>Be(n)},"生成",8,Jn),n.graph_err_msg?(o(),I(de,{key:0,title:n.graph_err_msg},{default:a(()=>[t("div",Wn,"原因："+S(n.graph_err_msg),1)]),_:2},1032,["title"])):c("",!0)],64)):n.graph_status==4?(o(),i("span",Xn,[e(me,{size:"small"}),p(" 生成中")])):n.graph_status==5?(o(),i(N,{key:5},[t("span",Zn,[e(U(we)),p(" 部分成功")]),t("div",Kn,[p(" 失败数："+S(n.graph_err_count||0)+" ",1),t("a",{class:"ml8",onClick:A=>se(n,{graph_status:3})},"详情",8,es)])],64)):c("",!0)],64)):c("",!0),h.key==="file_size"?(o(),i(N,{key:3},[n.doc_type==3?(o(),i("span",ts,"-")):(o(),i("span",os,S(n.file_size_str),1))],64)):c("",!0),h.key==="doc_auto_renew_frequency"?(o(),i(N,{key:4},[n.doc_type==2?(o(),i("div",as,[t("div",ns,[n.doc_auto_renew_frequency==1?(o(),i("span",ss,"不自动更新")):c("",!0),n.doc_auto_renew_frequency==2?(o(),i("span",ls,"每天")):c("",!0),n.doc_auto_renew_frequency==3?(o(),i("span",is,"每3天")):c("",!0),n.doc_auto_renew_frequency==4?(o(),i("span",us,"每7天")):c("",!0),n.doc_auto_renew_frequency==5?(o(),i("span",_s,"每30天")):c("",!0),n.doc_auto_renew_frequency>1&&n.doc_auto_renew_minute>0?(o(),i("span",rs,S(U(he)(n.doc_auto_renew_minute)),1)):c("",!0),n.doc_auto_renew_frequency>1?(o(),i("span",cs,"更新")):c("",!0),t("a",{class:"ml4 btn-hover-block",onClick:A=>Ve(n)},"修改",8,ds)]),e(j,{align:"center"},{default:a(()=>[p(" 最近更新: "+S(n.doc_last_renew_time_desc)+" ",1),e(Ye,{title:"确认更新?",onConfirm:A=>St(n)},{default:a(()=>[ps]),_:2},1032,["onConfirm"])]),_:2},1024)])):(o(),i("div",ms,"--"))],64)):c("",!0),h.key==="paragraph_count"?(o(),i(N,{key:5},[n.status==0||n.status==1?(o(),i("span",fs,"-")):(o(),i("span",vs,S(n.paragraph_count),1))],64)):c("",!0),h.key==="action"?(o(),I(j,{key:6,gap:8},{default:a(()=>[e(de,null,{title:a(()=>[p("重新分段")]),default:a(()=>[e(U(Lo),{class:"btn-hover-block",onClick:A=>xt(n)},null,8,["onClick"])]),_:2},1024),e(Ge,null,{overlay:a(()=>[e(le,null,{default:a(()=>[n.doc_type==2?(o(),I(W,{key:0},{default:a(()=>[t("div",{onClick:A=>Ve(n)},"编辑",8,hs)]),_:2},1024)):c("",!0),e(W,{disabled:n.status==6||n.status==7||n.status==0},{default:a(()=>[t("div",{onClick:A=>se(n)},"预览",8,gs)]),_:2},1032,["disabled"]),e(W,null,{default:a(()=>[t("div",{onClick:A=>Ct(n)},"重命名",8,ys)]),_:2},1024),e(W,null,{default:a(()=>[e(Ye,{title:"确定要删除吗?",onConfirm:A=>Re(n)},{default:a(()=>[ks]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:a(()=>[t("div",{class:"table-btn",onClick:_[3]||(_[3]=Wt(()=>{},["prevent"]))},[e(U(bo),{class:"btn-hover-block"})])]),_:2},1024)]),_:2},1024)):c("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),e(We,{open:D.open,"onUpdate:open":_[5]||(_[5]=h=>D.open=h),"confirm-loading":D.confirmLoading,maskClosable:!1,title:"上传文档",onOk:wt,onCancel:kt,width:"740px"},{default:a(()=>[e(Je,{class:"mt24","label-col":{span:4},"wrapper-col":{span:20}},{default:a(()=>[e(pe,{required:"",label:"上传文档"},{default:a(()=>[t("div",bs,[e(dt,{type:u.value.type,maxCount:20,value:D.fileList,"onUpdate:value":_[4]||(_[4]=h=>D.fileList=h),onChange:bt},null,8,["type","value"])])]),_:1}),He.value?(o(),I(pe,{key:0,required:"",label:"PDF解析模式"},{default:a(()=>[t("div",ws,[(o(),i(N,null,re(m,h=>t("div",{key:h.key,class:ct(["select-card-item",{active:D.pdf_parse_type==h.key}]),onClick:n=>qt(h)},[e($,{class:"check-arrow",name:"check-arrow-filled"}),t("div",xs,[e($,{name:h.icon,style:{"font-size":"16px"}},null,8,["name"]),p(" "+S(h.title),1)]),t("div",$s,S(h.desc),1)],10,Cs)),64))])]),_:1})):c("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),e(qa,{onOk:G,ref_key:"qaUploadModalRef",ref:Ee},null,512),e(We,{open:P.open,"onUpdate:open":_[9]||(_[9]=h=>P.open=h),"confirm-loading":P.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:ht,onCancel:gt},{default:a(()=>[e(Je,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:ze,model:P,rules:P.rules},{default:a(()=>[e(pe,{name:"urls",label:"网页链接"},{default:a(()=>[e(Mt,{style:{height:"120px"},value:P.urls,"onUpdate:value":_[6]||(_[6]=h=>P.urls=h),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),e(pe,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:a(()=>[e(Qe,{value:P.doc_auto_renew_frequency,"onUpdate:value":_[7]||(_[7]=h=>P.doc_auto_renew_frequency=h),style:{width:"100%"}},{default:a(()=>[e(ie,{value:1},{default:a(()=>[p("不自动更新")]),_:1}),e(ie,{value:2},{default:a(()=>[p("每天")]),_:1}),e(ie,{value:3},{default:a(()=>[p("每3天")]),_:1}),e(ie,{value:4},{default:a(()=>[p("每7天")]),_:1}),e(ie,{value:5},{default:a(()=>[p("每30天")]),_:1})]),_:1},8,["value"])]),_:1}),P.doc_auto_renew_frequency>1?(o(),I(pe,{key:0,name:"doc_auto_renew_minute",label:"更新时间"},{default:a(()=>[e(Rt,{valueFormat:"HH:mm",value:P.doc_auto_renew_minute,"onUpdate:value":_[8]||(_[8]=h=>P.doc_auto_renew_minute=h),format:"HH:mm"},null,8,["value"])]),_:1})):c("",!0)]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),e(ea,{libraryInfo:u.value,onOk:te,ref_key:"addCustomDocumentRef",ref:Ne},null,8,["libraryInfo"]),e(mo,{onOk:te,ref_key:"renameModalRef",ref:je},null,512),e(_o,{onOk:Ot,ref_key:"openGrapgModalRef",ref:g},null,512),e(Ma,{ref_key:"guideLearningTipsRef",ref:q},null,512),e(Ra,{onOk:G,ref_key:"editOnlineDocRef",ref:Ae},null,512)])}}},Wl=ke(Os,[["__scopeId","data-v-98f8d439"]]);export{Wl as default};
