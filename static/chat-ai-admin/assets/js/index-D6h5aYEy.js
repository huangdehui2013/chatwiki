import{_ as ot}from"./cu-scroll-D6a75u1K.js";import{I as St,M as F,ak as Ct,k as T,b as Z,B as X,al as jt,am as Ot,an as wt,E as ct,ao as tt,d as pt,ap as Lt,aq as It,ar as Pt,as as Ut,at as Mt,au as At}from"../../index-BYXP5-K6.js";import{k as e,B as K,e as f,M as p,N as a,S as n,W as t,Y as P,l as et,u as g,F as A,a0 as H,a6 as Dt,a7 as G,Q as R,Z as l,$ as Nt,a4 as Et,z as Gt,a1 as st,a2 as nt}from"./vue-chunks-DKljrDvA.js";import{F as dt,_ as ut}from"./index-DvGRcWf4.js";import"./index-CcC8Vz_q.js";import{I as lt}from"./Input-Bfzy8tJK.js";import{_ as _t}from"./TextArea-Dnm7usWJ.js";import{P as rt}from"./PlusOutlined-wIhQX_dJ.js";import{E as mt,M as vt,_ as ht}from"./index-DcQhmA5K.js";import"./index-CYLnLfoe.js";import{D as ft}from"./dropdown-QXBOTlLU.js";import{_ as bt}from"./index-C9HKvTtP.js";import{M as Tt}from"./model-select-BWeN9_sj.js";import{T as Ht}from"./index-DE8nMz1m.js";import{S as gt}from"./index-B7oz8JPj.js";import{S as kt,a as yt}from"./index-ChLzCBr1.js";import{D as Rt}from"./DownOutlined-BfzuAtqc.js";import{U as zt}from"./UpOutlined-D0s-TDxk.js";import{E as Bt}from"./EditOutlined-dNgwfcTz.js";import{_ as Vt}from"./index-BYK9MO85.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-BZ84_VUH.js";import"./qs-DB0tj3pA.js";import"./crypto-js-fJpLWOEv.js";import"./dayjs-BpZi_McX.js";import"./Trigger-DAizGHX4.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-BRAWLrZZ.js";import"./responsiveObserve-DRuL2_me.js";import"./collapseMotion-CxHtxgWr.js";import"./QuestionCircleOutlined-DYrN9KdY.js";import"./FormItemContext-BbeLgxF6.js";import"./index-DxTO0j69.js";import"./Search-1aGcXLAr.js";import"./SearchOutlined-BAHqMa3J.js";import"./inputProps-B3PFVydJ.js";import"./Password-CPQYqxS0.js";import"./index-2d7y8GiQ.js";import"./shallowequal-CthuG9FU.js";import"./slide-C8pAsQDb.js";import"./RightOutlined-D_XHCIbp.js";import"./move-BNsvENtF.js";import"./colors-BsGfXzR0.js";import"./index-C4xOveJ8.js";import"./index-ifJinQLe.js";import"./CheckOutlined-tNTNjiBd.js";var qt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};function it(m){for(var b=1;b<arguments.length;b++){var k=arguments[b]!=null?Object(arguments[b]):{},y=Object.keys(k);typeof Object.getOwnPropertySymbols=="function"&&(y=y.concat(Object.getOwnPropertySymbols(k).filter(function(u){return Object.getOwnPropertyDescriptor(k,u).enumerable}))),y.forEach(function(u){Jt(m,u,k[u])})}return m}function Jt(m,b,k){return b in m?Object.defineProperty(m,b,{value:k,enumerable:!0,configurable:!0,writable:!0}):m[b]=k,m}var at=function(b,k){var y=it({},b,k.attrs);return e(St,it({},y,{icon:qt}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const Ft={__name:"add-group",emits:["ok"],setup(m,{expose:b,emit:k}){const y=k,u=K({id:"",group_name:"",group_desc:""}),$=f(!1),L=f("新建分组"),s=f(!1),j=f(null),D=(x={})=>{j.value&&j.value.resetFields(),u.group_name=x.group_name||"",u.group_desc=x.group_desc||"",u.id=x.id||"",L.value=x.id?"编辑分组":"新建分组",s.value=!0},v=()=>{j.value.validate().then(()=>{Ct({...u}).then(()=>{y("ok"),T.success(`${L.value}成功`),s.value=!1})})};return b({show:D}),(x,S)=>{const U=lt,i=ut,E=_t,M=dt,h=F;return a(),p("div",null,[e(h,{open:s.value,"onUpdate:open":S[2]||(S[2]=I=>s.value=I),"confirm-loading":$.value,title:L.value,width:"476px",onOk:v},{default:n(()=>[e(M,{style:{"margin-top":"24px"},layout:"vertical",ref_key:"formRef",ref:j,model:u},{default:n(()=>[e(i,{name:"group_name",label:"分组名称",rules:[{required:!0,message:"请输入分组名称"}]},{default:n(()=>[e(U,{value:u.group_name,"onUpdate:value":S[0]||(S[0]=I=>u.group_name=I),placeholder:"请输入，最多10个字",maxLength:10},null,8,["value"])]),_:1}),e(i,{name:"group_desc",label:"分组描述"},{default:n(()=>[e(E,{style:{height:"80px"},maxLength:100,value:u.group_desc,"onUpdate:value":S[1]||(S[1]=I=>u.group_desc=I),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading","title"])])}}},Wt={class:"group-wrapper"},Qt={class:"group-box"},Yt=["onClick"],Zt={class:"group-name"},Xt={class:"name-text"},Kt={class:"hover-btn-box"},te=["onClick"],ee=["onClick"],oe={__name:"group-list",emits:["change","load"],setup(m,{emit:b}){const k=b,y=f(-1),u=f([]),$=()=>{Ot().then(v=>{u.value=[{id:-1,group_name:"全部"},{id:0,group_name:"默认分组"},...v.data],k("load",u.value)})};$();const L=v=>{y.value=v.id,k("change",v)},s=f(null),j=v=>{s.value.show({...v})},D=v=>{F.confirm({title:"删除确认",icon:et(ct),content:`确定要删除分组【${v.group_name}】吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk(){wt({id:v.id}).then(x=>{v.id==y.value&&L(u.value[0]),$(),T.success("删除成功")})},onCancel(){}})};return(v,x)=>{const S=X,U=bt,i=ht,E=vt,M=ft;return a(),p(A,null,[t("div",Wt,[t("div",null,[e(S,{onClick:x[0]||(x[0]=h=>j({})),icon:et(g(rt)),block:""},{default:n(()=>[P("添加分组")]),_:1},8,["icon"])]),t("div",Qt,[(a(!0),p(A,null,H(u.value,h=>(a(),p("div",{class:Dt(["group-list",{active:h.id==y.value}]),onClick:I=>L(h),key:h.id},[t("div",Zt,[t("div",Xt,l(h.group_name),1),h.group_desc?(a(),R(U,{key:0},{title:n(()=>[P(l(h.group_desc),1)]),default:n(()=>[e(g(jt))]),_:2},1024)):G("",!0)]),h.id>0?(a(),p("div",{key:0,class:"right-block",onClick:x[1]||(x[1]=Nt(()=>{},["stop"]))},[e(M,null,{overlay:n(()=>[e(E,null,{default:n(()=>[e(i,null,{default:n(()=>[t("div",{onClick:I=>j(h)},"编 辑",8,te)]),_:2},1024),e(i,null,{default:n(()=>[t("div",{style:{color:"#fb363f"},onClick:I=>D(h)},"删 除",8,ee)]),_:2},1024)]),_:2},1024)]),default:n(()=>[t("div",Kt,[e(g(mt))])]),_:2},1024)])):G("",!0)],10,Yt))),128))])]),e(Ft,{ref_key:"addGroupRef",ref:s,onOk:$},null,512)],64)}}},se=Z(oe,[["__scopeId","data-v-c78b9626"]]),$t=m=>(st("data-v-8630646c"),m=m(),nt(),m),ne={class:"ai-create-box"},le={class:"input-box"},re={class:"input-box"},ae=$t(()=>t("span",null,"生成",-1)),ie={class:"quick-tags-box"},ce=$t(()=>t("div",{class:"quick-label"},"快捷生成：",-1)),pe={class:"ai-list-box"},de={key:0,class:"loading-box"},ue={key:0,class:"prompt-list-box"},_e={class:"prompt-list"},me={class:"prompt-header"},ve={class:"prompt-title"},he={class:"prompt-content"},fe={class:"prompt-list"},be={class:"prompt-header"},ge={class:"prompt-title"},ke={class:"prompt-content"},ye={class:"prompt-list"},$e={class:"prompt-header"},xe={class:"prompt-title"},Se={class:"prompt-content"},Ce={class:"prompt-list"},je={class:"prompt-header"},Oe={class:"prompt-title"},we={class:"prompt-content"},Le={class:"prompt-list"},Ie={class:"prompt-header"},Pe={class:"prompt-title"},Ue={class:"prompt-content"},Me={class:"prompt-list"},Ae={class:"prompt-header"},De={class:"prompt-title"},Ne={class:"prompt-content"},Ee={class:"prompt-header"},Ge={class:"prompt-title"},Te={class:"prompt-content"},He={key:1,class:"empty-box"},Re={__name:"ai-create-prompt",emits:["handleAiSave"],setup(m,{expose:b,emit:k}){const y=tt.PRESENTED_IMAGE_SIMPLE,u=f(!1),$=f(!1);Et().query;const L=k,s=f(""),j=f(!1),D=[{title:"创建一个电商行业售后客服"},{title:"创建一个英语教育机构官网售前机器人"}],v=f("在上方输入框输入要求，点击生成提示词"),x=()=>{S.value=!1,i.promptStruct=U,s.value="",v.value="在上方输入框输入要求，点击生成提示词",u.value=!0},S=f(!1),U={role:{subject:"",describe:""},task:{subject:"",describe:""},constraints:{subject:"",describe:""},skill:{subject:"",describe:""},output:{subject:"",describe:""},tone:{subject:"",describe:""},custom:[]},i=K({promptStruct:U,use_model:"",model_config_id:""}),E=d=>{s.value=d},M=()=>{if(!s.value)return T.error("请输入AI 生成提示词");if(j.value)return T.error("正在生成中...");j.value=!0,Lt({demand:s.value,use_model:i.use_model,model_config_id:i.model_config_id}).then(d=>{i.promptStruct=JSON.parse(d.data.promptStruct),S.value=!0}).finally(()=>{j.value=!1}).catch(d=>{S.value=!1,v.value=d.msg})},h=d=>{Gt(()=>{var o,_,O;i.model_config_id=(o=d[0])==null?void 0:o.model_config_id,i.use_model=(O=(_=d[0])==null?void 0:_.children[0])==null?void 0:O.name})},I=()=>{if(!S.value)return T.error("请先生成提示词");L("handleAiSave",i.promptStruct),u.value=!1};return b({show:x}),(d,o)=>{const _=X,O=Tt,z=lt,B=pt,w=Ht,V=gt,q=tt,W=ot,Q=F;return a(),p("div",null,[e(Q,{open:u.value,"onUpdate:open":o[3]||(o[3]=C=>u.value=C),title:"AI 生成提示词",width:746},{footer:n(()=>[e(_,{type:"primary",loading:$.value,onClick:I},{default:n(()=>[P("使用该提示")]),_:1},8,["loading"])]),default:n(()=>[t("div",ne,[t("div",le,[e(O,{modelType:"LLM",modeName:i.use_model,"onUpdate:modeName":o[0]||(o[0]=C=>i.use_model=C),modeId:i.model_config_id,"onUpdate:modeId":o[1]||(o[1]=C=>i.model_config_id=C),style:{width:"300px"},onLoaded:h},null,8,["modeName","modeId"])]),t("div",re,[e(z,{style:{width:"100%"},value:s.value,"onUpdate:value":o[2]||(o[2]=C=>s.value=C),size:"large",onPressEnter:M,placeholder:"请输入AI 生成提示词例如：创建一个电商行业售后客服"},null,8,["value"]),t("div",{class:"btn-box",onClick:M},[e(B,{name:"ai-mark"}),ae])]),t("div",ie,[ce,(a(),p(A,null,H(D,C=>e(w,{key:C.title,onClick:c=>E(C.title),color:"blue"},{default:n(()=>[P(l(C.title),1)]),_:2},1032,["onClick"])),64))]),t("div",pe,[e(W,{style:{height:"100%"}},{default:n(()=>[j.value?(a(),p("div",de,[e(V,{tip:"正在生成中..."})])):(a(),p(A,{key:1},[S.value?(a(),p("div",ue,[t("div",_e,[t("div",me,[t("div",ve,l(i.promptStruct.role.subject),1)]),t("div",he,l(i.promptStruct.role.describe),1)]),t("div",fe,[t("div",be,[t("div",ge,l(i.promptStruct.task.subject),1)]),t("div",ke,l(i.promptStruct.task.describe),1)]),t("div",ye,[t("div",$e,[t("div",xe,l(i.promptStruct.constraints.subject),1)]),t("div",Se,l(i.promptStruct.constraints.describe),1)]),t("div",Ce,[t("div",je,[t("div",Oe,l(i.promptStruct.skill.subject),1)]),t("div",we,l(i.promptStruct.skill.describe),1)]),t("div",Le,[t("div",Ie,[t("div",Pe,l(i.promptStruct.output.subject),1)]),t("div",Ue,l(i.promptStruct.output.describe),1)]),t("div",Me,[t("div",Ae,[t("div",De,l(i.promptStruct.tone.subject),1)]),t("div",Ne,l(i.promptStruct.tone.describe),1)]),(a(!0),p(A,null,H(i.promptStruct.custom,(C,c)=>(a(),p("div",{class:"prompt-list",key:c+C.key?C.key:""},[t("div",Ee,[t("div",Ge,l(C.subject),1)]),t("div",Te,l(C.describe),1)]))),128))])):(a(),p("div",He,[e(q,{image:g(y),description:v.value},null,8,["image","description"])]))],64))]),_:1})])])]),_:1},8,["open"])])}}},ze=Z(Re,[["__scopeId","data-v-8630646c"]]),Be=m=>(st("data-v-fdd5b513"),m=m(),nt(),m),Ve={key:1,class:"prompt-list-box"},qe={class:"header-box"},Je=Be(()=>t("div",{class:"header-left"},"提示词",-1)),Fe={class:"prompt-list"},We={class:"prompt-header"},Qe={class:"prompt-title"},Ye={class:"prompt-content"},Ze={class:"prompt-list"},Xe={class:"prompt-header"},Ke={class:"prompt-title"},to={class:"prompt-content"},eo={class:"prompt-list"},oo={class:"prompt-header"},so={class:"prompt-title"},no={class:"prompt-content"},lo={class:"prompt-list"},ro={class:"prompt-header"},ao={class:"prompt-title"},io={class:"prompt-content"},co={class:"prompt-list"},po={class:"prompt-header"},uo={class:"prompt-title"},_o={class:"prompt-content"},mo={class:"prompt-list"},vo={class:"prompt-header"},ho={class:"prompt-title"},fo={class:"prompt-content"},bo={class:"prompt-header"},go={class:"prompt-title",style:{flex:"1"}},ko={class:"btn-wrapper-box"},yo=["onClick"],$o={class:"prompt-content"},xo={class:"add-theme-block"},So={__name:"add-diy-prompt",props:{groupList:{type:Array,default:()=>[]}},emits:["ok"],setup(m,{expose:b,emit:k}){const y=k,u=m;let $={role:"请输入，告知大模型要扮演的身份、职责、沟通风格等，比如“你扮演一名经验丰富的电商行业售后客服AI助手，具备良好的沟通能力和解决问题的能力。”",task:"请输入，比如“根据提供的知识库资料，找到对应的售后知识（每个知识点之间使用⧼-split_line-⧽进行分割），快速准确回答用户的问题。”",constraints:"请输入对大模型在回复时的要求，比如“你的回答应该使用自然的对话方式，简单直接地回答，不要解释你的答案；当用户问题没有找到相关知识点时，直接告诉用户问题暂时无法回答，不能胡编乱造，否则你将受到惩罚。”",output:"请输入对大模型输出格式的要求，比如“请使用markdown格式输出”",tone:"请告知语言风格要求，比如“专业而不失亲切，适当使用emoji增强可读性”",skill:"请输入"},L={role:{subject:"角色",describe:""},task:{subject:"任务",describe:""},constraints:{subject:"要求",describe:""},skill:{subject:"技能",describe:""},output:{subject:"输出格式",describe:""},tone:{subject:"风格语气",describe:""},custom:[]};const s=K({id:"",title:"",group_id:0,prompt_type:0,prompt:"",prompt_struct:JSON.parse(JSON.stringify(L))}),j=f(!1),D=f(""),v=f(!1),x=f(null),S=(d={},o)=>{x.value&&x.value.resetFields(),s.title=d.title||"",s.group_id=d.group_id>0?d.group_id:0,s.id=o=="copy"?"":d.id||"",s.prompt_type=d.prompt_type,s.prompt=d.prompt||"",s.prompt_struct=d.prompt_struct||JSON.parse(JSON.stringify(L)),D.value=`${d.id?"编辑":"新建"}${d.prompt_type==0?"自定义":"结构化"}提示词`,v.value=!0},U=()=>{x.value.validate().then(()=>{let d={...s};s.prompt_type==0?delete d.prompt_struct:d.prompt_struct=JSON.stringify(s.prompt_struct),Pt({...d}).then(()=>{y("ok"),T.success(`${D.value}成功`),v.value=!1})})},i=f(null),E=()=>{i.value.show()},M=d=>{s.prompt_struct=d},h=()=>{s.prompt_struct.custom.push({subject:"",describe:"",key:Math.random()*1e4})},I=d=>{s.prompt_struct.custom.splice(d,1)};return b({show:S}),(d,o)=>{const _=lt,O=ut,z=yt,B=kt,w=_t,V=pt,q=X,W=dt,Q=ot,C=F;return a(),p("div",null,[e(C,{open:v.value,"onUpdate:open":o[9]||(o[9]=c=>v.value=c),"confirm-loading":j.value,title:D.value,width:"766px",onOk:U},{default:n(()=>[e(Q,{style:{"max-height":"600px","margin-top":"24px"}},{default:n(()=>[e(W,{"label-col":{span:3},"wrapper-col":{span:21},ref_key:"formRef",ref:x,model:s},{default:n(()=>[e(O,{name:"title",label:"提示词标题",rules:[{required:!0,message:"请输入提示词标题"}]},{default:n(()=>[e(_,{value:s.title,"onUpdate:value":o[0]||(o[0]=c=>s.title=c),placeholder:"请输入提示词标题",maxLength:10},null,8,["value"])]),_:1}),e(O,{name:"group_id",label:"分组"},{default:n(()=>[e(B,{value:s.group_id,"onUpdate:value":o[1]||(o[1]=c=>s.group_id=c),style:{width:"100%"}},{default:n(()=>[(a(!0),p(A,null,H(u.groupList,c=>(a(),R(z,{value:c.id},{default:n(()=>[P(l(c.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),s.prompt_type==0?(a(),R(O,{key:0,name:"prompt",label:"提示词",rules:[{required:!0,message:"请输入提示词"}]},{default:n(()=>[e(w,{style:{height:"280px"},value:s.prompt,"onUpdate:value":o[2]||(o[2]=c=>s.prompt=c),placeholder:"请输入"},null,8,["value"])]),_:1})):(a(),p("div",Ve,[t("div",qe,[Je,t("div",{class:"ai-mark-box",onClick:E},[e(V,{name:"ai-mark"}),P(" AI自动生成 ")])]),t("div",Fe,[t("div",We,[t("div",Qe,l(s.prompt_struct.role.subject),1)]),t("div",Ye,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.role.describe,"onUpdate:value":o[3]||(o[3]=c=>s.prompt_struct.role.describe=c),placeholder:g($).role},null,8,["value","placeholder"])])]),t("div",Ze,[t("div",Xe,[t("div",Ke,l(s.prompt_struct.task.subject),1)]),t("div",to,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.task.describe,"onUpdate:value":o[4]||(o[4]=c=>s.prompt_struct.task.describe=c),placeholder:g($).task},null,8,["value","placeholder"])])]),t("div",eo,[t("div",oo,[t("div",so,l(s.prompt_struct.constraints.subject),1)]),t("div",no,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.constraints.describe,"onUpdate:value":o[5]||(o[5]=c=>s.prompt_struct.constraints.describe=c),placeholder:g($).constraints},null,8,["value","placeholder"])])]),t("div",lo,[t("div",ro,[t("div",ao,l(s.prompt_struct.skill.subject),1)]),t("div",io,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.skill.describe,"onUpdate:value":o[6]||(o[6]=c=>s.prompt_struct.skill.describe=c),placeholder:g($).skill},null,8,["value","placeholder"])])]),t("div",co,[t("div",po,[t("div",uo,l(s.prompt_struct.output.subject),1)]),t("div",_o,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.output.describe,"onUpdate:value":o[7]||(o[7]=c=>s.prompt_struct.output.describe=c),placeholder:g($).output},null,8,["value","placeholder"])])]),t("div",mo,[t("div",vo,[t("div",ho,l(s.prompt_struct.tone.subject),1)]),t("div",fo,[e(w,{style:{height:"80px"},bordered:!1,value:s.prompt_struct.tone.describe,"onUpdate:value":o[8]||(o[8]=c=>s.prompt_struct.tone.describe=c),placeholder:g($).tone},null,8,["value","placeholder"])])]),(a(!0),p(A,null,H(s.prompt_struct.custom,(c,Y)=>(a(),p("div",{class:"prompt-list",key:Y+c.key?c.key:""},[t("div",bo,[t("div",go,[e(_,{bordered:!1,style:{width:"100%"},value:c.subject,"onUpdate:value":J=>c.subject=J,placeholder:"请输入主题"},null,8,["value","onUpdate:value"])]),t("div",ko,[t("div",{class:"hover-btn-box",onClick:J=>I(Y)},[e(g(It))],8,yo)])]),t("div",$o,[e(w,{style:{height:"80px"},bordered:!1,value:c.describe,"onUpdate:value":J=>c.describe=J,placeholder:"请输入"},null,8,["value","onUpdate:value"])])]))),128)),t("div",xo,[e(q,{onClick:h,block:"",icon:et(g(rt))},{default:n(()=>[P("添加主题")]),_:1},8,["icon"])])]))]),_:1},8,["model"])]),_:1})]),_:1},8,["open","confirm-loading","title"]),e(ze,{onHandleAiSave:M,ref_key:"aiCreatePromptRef",ref:i},null,512)])}}},Co=Z(So,[["__scopeId","data-v-fdd5b513"]]),xt=m=>(st("data-v-74401bff"),m=m(),nt(),m),jo={class:"user-model-page"},Oo={class:"page-title"},wo=xt(()=>t("div",{class:"desc"}," 添加提示词模板，在应用配置和工作流的AI对话节点，可以从提示词模板库选择提示词并应用 ",-1)),Lo={class:"list-wrapper"},Io={class:"left-group"},Po={class:"right-cotnetn"},Uo={class:"content-box"},Mo={class:"btn-block"},Ao={key:0,class:"loading-box"},Do={class:"prompt-list-box"},No={class:"prompt-header"},Eo={class:"prompt-title"},Go={key:0,class:"prompt-type diy"},To={key:1,class:"prompt-type"},Ho={class:"title"},Ro={class:"right-btn-box"},zo=["onClick"],Bo=["onClick"],Vo={class:"hover-btn-box"},qo=["onClick"],Jo=["onClick"],Fo=["onClick"],Wo={class:"prompt-content-box"},Qo={key:0,class:"prompt-content"},Yo=["onClick"],Zo={key:1,class:"structure-list-box"},Xo={class:"structure-list"},Ko={class:"structure-title"},ts={class:"structure-content"},es={class:"structure-list"},os={class:"structure-title"},ss={class:"structure-content"},ns=["onClick"],ls={class:"structure-list"},rs={class:"structure-title"},as={class:"structure-content"},is={class:"structure-list"},cs={class:"structure-title"},ps={class:"structure-content"},ds={class:"structure-list"},us={class:"structure-title"},_s={class:"structure-content"},ms={class:"structure-list"},vs={class:"structure-title"},hs={class:"structure-content"},fs={class:"structure-title"},bs={class:"structure-content"},gs={class:"move-group-box"},ks=xt(()=>t("div",{class:"label-text"},"修改分组为",-1)),ys={__name:"index",setup(m){let b=-1;const k=o=>{b=o.id,s()};let y=f([]);const u=o=>{y.value=o.filter(_=>_.id>=0)},$=f([]),L=f(!1),s=()=>{L.value=!0,Ut({group_id:b,page:1,size:9999}).then(o=>{let _=o.data.list||[];_=_.map(O=>({...O,isHide:!0,prompt_struct:O.prompt_struct?JSON.parse(O.prompt_struct):{}})),$.value=_}).finally(()=>{L.value=!1})};s();const j=f(null),D=o=>{j.value.show({group_id:b==-1?0:b,prompt_type:o})},v=(o,_)=>{j.value.show({...o},_)};function x(o){var _;return(_=y.value.filter(O=>O.id==o)[0])==null?void 0:_.group_name}const S=o=>{o.isHide=!o.isHide},U=f(!0),i=()=>{U.value=!U.value,$.value=$.value.map(o=>({...o,isHide:U.value}))},E=o=>{F.confirm({title:"删除确认",icon:e(ct),content:`确定要删除提示词[${o.title}]吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk(){Mt({id:o.id}).then(_=>{T.success("删除成功"),s()})},onCancel(){}})},M=f(!1);let h=K({id:"",group_id:0});const I=o=>{o={...o},h.id=o.id,h.group_id=o.group_id>0?o.group_id:0,M.value=!0},d=()=>{if(h.id<0)return T.error("请选择要移动的分组");At({id:h.id,group_id:h.group_id}).then(()=>{T.success("移动成功"),M.value=!1,s()})};return(o,_)=>{const O=Vt,z=ot,B=X,w=ht,V=vt,q=ft,W=gt,Q=bt,C=tt,c=yt,Y=kt,J=F;return a(),p("div",jo,[t("div",Oo,[P(" 提示词模板库 "),e(O,{type:"vertical"}),wo]),t("div",Lo,[t("div",Io,[e(z,null,{default:n(()=>[e(se,{onChange:k,onLoad:u})]),_:1})]),t("div",Po,[e(z,null,{default:n(()=>[t("div",Uo,[t("div",Mo,[e(q,null,{overlay:n(()=>[e(V,null,{default:n(()=>[e(w,null,{default:n(()=>[t("div",{onClick:_[0]||(_[0]=r=>D(1))},"添加结构化提示词")]),_:1}),e(w,null,{default:n(()=>[t("div",{onClick:_[1]||(_[1]=r=>D(0))},"添加自定义提示词")]),_:1})]),_:1})]),default:n(()=>[e(B,{type:"primary",icon:e(g(rt))},{default:n(()=>[P("提示词")]),_:1},8,["icon"])]),_:1}),e(B,{onClick:i,icon:e(g(at))},{default:n(()=>[P(l(U.value?"全部展开":"全部收起"),1)]),_:1},8,["icon"])]),L.value?(a(),p("div",Ao,[e(W)])):G("",!0),t("div",Do,[(a(!0),p(A,null,H($.value,r=>(a(),p("div",{class:"prompt-list",key:r.id},[t("div",No,[t("div",Eo,[r.prompt_type==0?(a(),p("div",Go,"自定义")):G("",!0),r.prompt_type==1?(a(),p("div",To,"结构化")):G("",!0),t("div",Ho,l(r.title),1),e(O,{type:"vertical"}),t("div",null,l(x(r.group_id)),1)]),t("div",Ro,[e(Q,{title:r.isHide?"展开":"收起"},{default:n(()=>[t("div",{class:"hover-btn-box",onClick:N=>S(r)},[r.isHide?(a(),R(g(Rt),{key:0})):(a(),R(g(zt),{key:1}))],8,zo)]),_:2},1032,["title"]),t("div",{class:"hover-btn-box",onClick:N=>v(r)},[e(g(Bt))],8,Bo),e(q,null,{overlay:n(()=>[e(V,null,{default:n(()=>[e(w,null,{default:n(()=>[t("div",{onClick:N=>v(r,"copy")},"复制",8,qo)]),_:2},1024),e(w,null,{default:n(()=>[t("div",{onClick:N=>I(r)},"修改分组",8,Jo)]),_:2},1024),e(w,null,{default:n(()=>[t("div",{onClick:N=>E(r)},"删除",8,Fo)]),_:2},1024)]),_:2},1024)]),default:n(()=>[t("div",Vo,[e(g(mt))])]),_:2},1024)])]),t("div",Wo,[r.prompt_type==0?(a(),p("div",Qo,[r.isHide?(a(),p(A,{key:0},[P(l(r.prompt.slice(0,200))+" ",1),r.prompt.length>200?(a(),p("span",{key:0,onClick:N=>S(r),style:{cursor:"pointer"}},"...",8,Yo)):G("",!0)],64)):(a(),p(A,{key:1},[P(l(r.prompt),1)],64))])):(a(),p("div",Zo,[t("div",Xo,[t("div",Ko,l(r.prompt_struct.role.subject),1),t("div",ts,l(r.prompt_struct.role.describe),1)]),t("div",es,[t("div",os,l(r.prompt_struct.task.subject),1),t("div",ss,[P(l(r.prompt_struct.task.describe)+" ",1),r.isHide?(a(),p("span",{key:0,onClick:N=>S(r),style:{cursor:"pointer"}},"...",8,ns)):G("",!0)])]),r.isHide?G("",!0):(a(),p(A,{key:0},[t("div",ls,[t("div",rs,l(r.prompt_struct.constraints.subject),1),t("div",as,l(r.prompt_struct.constraints.describe),1)]),t("div",is,[t("div",cs,l(r.prompt_struct.skill.subject),1),t("div",ps,l(r.prompt_struct.skill.describe),1)]),t("div",ds,[t("div",us,l(r.prompt_struct.output.subject),1),t("div",_s,l(r.prompt_struct.output.describe),1)]),t("div",ms,[t("div",vs,l(r.prompt_struct.tone.subject),1),t("div",hs,l(r.prompt_struct.tone.describe),1)]),(a(!0),p(A,null,H(r.prompt_struct.custom,N=>(a(),p("div",{class:"structure-list",key:N.subject},[t("div",fs,l(N.subject),1),t("div",bs,l(N.describe),1)]))),128))],64))]))])]))),128))])]),$.value.length==0?(a(),R(C,{key:0,style:{"padding-top":"100px"}})):G("",!0)]),_:1})])]),e(Co,{groupList:g(y),onOk:s,ref_key:"addDiyPromptRef",ref:j},null,8,["groupList"]),e(J,{open:M.value,"onUpdate:open":_[3]||(_[3]=r=>M.value=r),title:"修改分组",onOk:d},{default:n(()=>[t("div",gs,[ks,e(Y,{value:g(h).group_id,"onUpdate:value":_[2]||(_[2]=r=>g(h).group_id=r),style:{width:"100%"}},{default:n(()=>[(a(!0),p(A,null,H(g(y),r=>(a(),R(c,{value:r.id},{default:n(()=>[P(l(r.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])]),_:1},8,["open"])])}}},hn=Z(ys,[["__scopeId","data-v-74401bff"]]);export{hn as default};
