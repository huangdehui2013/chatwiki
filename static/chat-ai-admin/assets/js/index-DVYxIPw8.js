import{b as L,dh as E,al as v,B as J,M as R,bZ as U,k as q}from"../../index-G9f-mAi5.js";import{d as z,a4 as A,e as r,B as F,x as j,M as G,k as l,W as w,S as n,N as i,Q as D,a7 as b,Y as d,u as C,aa as P}from"./vue-chunks-DKljrDvA.js";import{C as Q}from"./config-page-menu-kx-ynnDB.js";import{C as M}from"./index-Dp8MfakO.js";import{F as W,_ as X}from"./index-9rMTI6VT.js";import{_ as Y}from"./index-CsKJU3Dz.js";import{_ as Z}from"./index-iB9ppu1z.js";import"./axios-BZ84_VUH.js";import"./qs-DB0tj3pA.js";import"./crypto-js-fJpLWOEv.js";import"./dayjs-BpZi_McX.js";import"./index-BZceli48.js";import"./shallowequal-CthuG9FU.js";import"./Trigger-BW7irFFi.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-CxHtxgWr.js";import"./slide-WaU3Tqer.js";import"./index-BGI9PV4t.js";import"./index-BMQPDzC_.js";import"./isPlainObject-CaOV5tQi.js";import"./responsiveObserve-BUPVP-R1.js";import"./QuestionCircleOutlined-nxul5uCX.js";import"./FormItemContext-BeRgkpjf.js";import"./colors-6QtHC0k-.js";const $={class:"ai-config-page"},H={class:"page-container"},K={class:"ai-config-form"},ee={__name:"index",setup(ae){const V=A(),x=z(()=>V.query.library_id),u=r(),s=r(!1);let _={};const a=F({library_name:"",library_intro:"",ai_summary:"",ai_summary_model:"",access_rights:"",model_config_id:"",use_model:"",use_model_icon:"",use_model_name:"",use_model_switch:"",statistics_set:"",summary_model_icon:"",summary_model_name:"",summary_model_config_id:""}),c=["azure","ollama","xinference","openaiAgent"],p=["azure"],f=r(""),y=r(""),N=e=>{a.use_model=c.includes(e.rawData.model_define)&&e.rawData.deployment_name?e.rawData.deployment_name:e.rawData.name,a.use_model_icon=e.icon,a.use_model_name=e.use_model_name,a.model_config_id=e.rawData.id,f.value=e.rawData.model_define},O=e=>{a.ai_summary_model=c.includes(e.rawData.model_define)&&e.rawData.deployment_name?e.rawData.deployment_name:e.rawData.name,a.summary_model_icon=e.icon,a.summary_model_name=e.summary_model_name,a.summary_model_config_id=e.rawData.id,y.value=e.rawData.model_define},S=async()=>{try{await u.value.validate(),_.use_model!=a.use_model?R.confirm({title:"确定切换模型为"+a.use_model+"吗？",content:"切换模型后，文档会重新向量化，会消耗token",okText:"确定",cancelText:"取消",onOk(){g()}}):g()}catch(e){console.error("表单验证失败:",e)}},g=()=>{let e={...P(a)};p.indexOf(f.value)>-1&&(e.use_model="默认"),p.indexOf(y.value)>-1&&(e.ai_summary_model="默认"),s.value=!0,U(e).then(()=>{q.success("保存成功"),s.value=!1,_=JSON.parse(JSON.stringify(e))}).catch(()=>{s.value=!1})},B=()=>{E({id:x.value}).then(e=>{let o=e.data||{};o.use_model=o.use_model||void 0,o.ai_summary_model=o.ai_summary_model||void 0,_=JSON.parse(JSON.stringify(o)),Object.assign(a,o)})};return j(()=>{B()}),(e,o)=>{const h=Z,k=Y,m=X,T=J,I=W;return i(),G("div",$,[l(Q),w("div",H,[w("div",K,[l(I,{ref_key:"formRef",ref:u,model:a,"label-col":{span:2},"wrapper-col":{span:8}},{default:n(()=>[l(m,null,{label:n(()=>[d(" 嵌入  "),l(h,null,{title:n(()=>[d("开启嵌入功能后，才能在机器人中关联本知识库。")]),default:n(()=>[l(C(v))]),_:1})]),default:n(()=>[l(k,{checked:a.use_model_switch,"onUpdate:checked":o[0]||(o[0]=t=>a.use_model_switch=t),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),a.use_model_switch==1?(i(),D(m,{key:0,label:"嵌入模型",name:"use_model",rules:[{required:!0,message:"请选择嵌入模型"}]},{default:n(()=>[l(M,{modelValue:a.use_model,"onUpdate:modelValue":o[1]||(o[1]=t=>a.use_model=t),placeholder:"请选择嵌入模型","label-key":"use_model_name","value-key":"value",modelType:"TEXT EMBEDDING","model-config-id":a.model_config_id,onChange:N},null,8,["modelValue","model-config-id"])]),_:1})):b("",!0),l(m,null,{label:n(()=>[d(" AI智能总结  "),l(h,null,{title:n(()=>[d("开启后，搜索知识库时，由大模型自动总结文档，并给出总结后的结果")]),default:n(()=>[l(C(v))]),_:1})]),default:n(()=>[l(k,{checked:a.ai_summary,"onUpdate:checked":o[2]||(o[2]=t=>a.ai_summary=t),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),a.ai_summary==1?(i(),D(m,{key:1,label:"总结模型",name:"ai_summary_model",rules:[{required:!0,message:"请选择总结模型"}]},{default:n(()=>[l(M,{modelValue:a.ai_summary_model,"onUpdate:modelValue":o[3]||(o[3]=t=>a.ai_summary_model=t),placeholder:"请选择总结模型","label-key":"summary_model_name","value-key":"value",modelType:"LLM","model-config-id":a.summary_model_config_id,onChange:O},null,8,["modelValue","model-config-id"])]),_:1})):b("",!0),l(m,{"wrapper-col":{offset:2,span:8}},{default:n(()=>[l(T,{type:"primary",loading:s.value,onClick:S},{default:n(()=>[d("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])])}}},Ve=L(ee,[["__scopeId","data-v-ed2f1b7c"]]);export{Ve as default};
