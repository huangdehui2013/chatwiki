import{C as ot}from"./cu-scroll-8SQNC6_m.js";import{A as St,V as Ct,k as H,M as F,b as Z,W as Ot,X as jt,E as ct,Y as Lt,B as X,Z as tt,$ as wt,d as pt,a0 as It,a1 as Pt,a2 as Ut,a3 as At,a4 as Dt}from"../../index-CuFzRDH0.js";import{k as e,B as K,e as f,M as r,N as i,S as l,W as t,Y as I,l as et,u as g,F as A,$ as R,a6 as Mt,Z as a,Q as z,a7 as G,a0 as Nt,a5 as Et,z as Gt,a1 as st,a2 as nt}from"./vue-chunks-DkYK5AuX.js";import"./index-5PrSJtCq.js";import{I as lt}from"./Input-DlD3j6GW.js";import{_ as dt,F as ut}from"./index-CKa8nflF.js";import{_ as _t}from"./TextArea-DnYx9N6z.js";import{E as mt,_ as vt,M as ht}from"./index-D2p2Kdi5.js";import"./index-DmWi8Hkf.js";import{D as ft}from"./dropdown-aM3tBgR4.js";import{P as rt}from"./PlusOutlined-C1-JNsax.js";import{_ as bt}from"./index-DVObnatt.js";import{M as Ht}from"./model-select-CidLVLk0.js";import{_ as Tt}from"./index-_b6N6Mhe.js";import{S as gt}from"./index-YK7vZYdC.js";import{S as yt,_ as kt}from"./index-B9b8kVtF.js";import{_ as Rt}from"./index-B3CceHui.js";import{D as zt}from"./DownOutlined-xHwfZhzl.js";import{U as Vt}from"./UpOutlined-CmeybyPL.js";import{E as Bt}from"./EditOutlined-C_areslC.js";import{_ as qt}from"./index-DYBz5Hw_.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-g-qVsYXK.js";import"./crypto-js-CsNcoEfj.js";import"./dayjs-CHX5mXCJ.js";import"./FormItemContext-CG4o3aCY.js";import"./index-DpON8wvi.js";import"./Search-BjDfM7wD.js";import"./SearchOutlined-2-sBVYkv.js";import"./isPlainObject-B3m2dvNk.js";import"./inputProps-CIG3Q6HA.js";import"./Password-B-_rMC_p.js";import"./Trigger-qqJEyN1K.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./responsiveObserve-nm9aPAMw.js";import"./collapseMotion-D38MKU2V.js";import"./QuestionCircleOutlined-DySDEe_b.js";import"./index-CNYsll_x.js";import"./shallowequal-CCVEH32S.js";import"./slide--PTaLm6c.js";import"./Dropdown-DNhcw7uk.js";import"./RightOutlined-C7Gymx4e.js";import"./move-CfeIRdjT.js";import"./colors-TmzmwKXv.js";import"./index-njT3lQ6A.js";import"./CheckOutlined-Nu5wJEo2.js";var Jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Ft=Jt;function it(_){for(var b=1;b<arguments.length;b++){var y=arguments[b]!=null?Object(arguments[b]):{},k=Object.keys(y);typeof Object.getOwnPropertySymbols=="function"&&(k=k.concat(Object.getOwnPropertySymbols(y).filter(function(u){return Object.getOwnPropertyDescriptor(y,u).enumerable}))),k.forEach(function(u){Wt(_,u,y[u])})}return _}function Wt(_,b,y){return b in _?Object.defineProperty(_,b,{value:y,enumerable:!0,configurable:!0,writable:!0}):_[b]=y,_}var at=function(b,y){var k=it({},b,y.attrs);return e(St,it({},k,{icon:Ft}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const Qt=at,Yt={__name:"add-group",emits:["ok"],setup(_,{expose:b,emit:y}){const k=y,u=K({id:"",group_name:"",group_desc:""}),C=f(!1),L=f("新建分组"),o=f(!1),O=f(null),D=($={})=>{O.value&&O.value.resetFields(),u.group_name=$.group_name||"",u.group_desc=$.group_desc||"",u.id=$.id||"",L.value=$.id?"编辑分组":"新建分组",o.value=!0},v=()=>{O.value.validate().then(()=>{Ct({...u}).then(()=>{k("ok"),H.success(`${L.value}成功`),o.value=!1})})};return b({show:D}),($,x)=>{const P=lt,c=dt,N=_t,U=ut,h=F;return r(),i("div",null,[e(h,{open:o.value,"onUpdate:open":x[2]||(x[2]=w=>o.value=w),"confirm-loading":C.value,title:L.value,width:"476px",onOk:v},{default:l(()=>[e(U,{style:{"margin-top":"24px"},layout:"vertical",ref_key:"formRef",ref:O,model:u},{default:l(()=>[e(c,{name:"group_name",label:"分组名称",rules:[{required:!0,message:"请输入分组名称"}]},{default:l(()=>[e(P,{value:u.group_name,"onUpdate:value":x[0]||(x[0]=w=>u.group_name=w),placeholder:"请输入，最多10个字",maxLength:10},null,8,["value"])]),_:1}),e(c,{name:"group_desc",label:"分组描述"},{default:l(()=>[e(N,{style:{height:"80px"},maxLength:100,value:u.group_desc,"onUpdate:value":x[1]||(x[1]=w=>u.group_desc=w),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading","title"])])}}},Zt={class:"group-wrapper"},Xt={class:"group-box"},Kt=["onClick"],te={class:"group-name"},ee={class:"name-text"},oe={class:"hover-btn-box"},se=["onClick"],ne=["onClick"],le={__name:"group-list",emits:["change","load"],setup(_,{emit:b}){const y=b,k=f(-1),u=f([]),C=()=>{jt().then(v=>{u.value=[{id:-1,group_name:"全部"},{id:0,group_name:"默认分组"},...v.data],y("load",u.value)})};C();const L=v=>{k.value=v.id,y("change",v)},o=f(null),O=v=>{o.value.show({...v})},D=v=>{F.confirm({title:"删除确认",icon:et(ct),content:`确定要删除分组【${v.group_name}】吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk(){Lt({id:v.id}).then($=>{v.id==k.value&&L(u.value[0]),C(),H.success("删除成功")})},onCancel(){}})};return(v,$)=>{const x=X,P=bt,c=vt,N=ht,U=ft;return r(),i(A,null,[t("div",Zt,[t("div",null,[e(x,{onClick:$[0]||($[0]=h=>O({})),icon:et(g(rt)),block:""},{default:l(()=>[I("添加分组")]),_:1},8,["icon"])]),t("div",Xt,[(r(!0),i(A,null,R(u.value,h=>(r(),i("div",{class:Mt(["group-list",{active:h.id==k.value}]),onClick:w=>L(h),key:h.id},[t("div",te,[t("div",ee,a(h.group_name),1),h.group_desc?(r(),z(P,{key:0},{title:l(()=>[I(a(h.group_desc),1)]),default:l(()=>[e(g(Ot))]),_:2},1024)):G("",!0)]),h.id>0?(r(),i("div",{key:0,class:"right-block",onClick:$[1]||($[1]=Nt(()=>{},["stop"]))},[e(U,null,{overlay:l(()=>[e(N,null,{default:l(()=>[e(c,null,{default:l(()=>[t("div",{onClick:w=>O(h)},"编 辑",8,se)]),_:2},1024),e(c,null,{default:l(()=>[t("div",{style:{color:"#fb363f"},onClick:w=>D(h)},"删 除",8,ne)]),_:2},1024)]),_:2},1024)]),default:l(()=>[t("div",oe,[e(g(mt))])]),_:2},1024)])):G("",!0)],10,Kt))),128))])]),e(Yt,{ref_key:"addGroupRef",ref:o,onOk:C},null,512)],64)}}},re=Z(le,[["__scopeId","data-v-2b90ce82"]]),$t=_=>(st("data-v-c64803b5"),_=_(),nt(),_),ae={class:"ai-create-box"},ie={class:"input-box"},ce={class:"input-box"},pe=$t(()=>t("span",null,"生成",-1)),de={class:"quick-tags-box"},ue=$t(()=>t("div",{class:"quick-label"},"快捷生成：",-1)),_e={class:"ai-list-box"},me={key:0,class:"loading-box"},ve={key:0,class:"prompt-list-box"},he={class:"prompt-list"},fe={class:"prompt-header"},be={class:"prompt-title"},ge={class:"prompt-content"},ye={class:"prompt-list"},ke={class:"prompt-header"},$e={class:"prompt-title"},xe={class:"prompt-content"},Se={class:"prompt-list"},Ce={class:"prompt-header"},Oe={class:"prompt-title"},je={class:"prompt-content"},Le={class:"prompt-list"},we={class:"prompt-header"},Ie={class:"prompt-title"},Pe={class:"prompt-content"},Ue={class:"prompt-list"},Ae={class:"prompt-header"},De={class:"prompt-title"},Me={class:"prompt-content"},Ne={class:"prompt-header"},Ee={class:"prompt-title"},Ge={class:"prompt-content"},He={key:1,class:"empty-box"},Te={__name:"ai-create-prompt",emits:["handleAiSave"],setup(_,{expose:b,emit:y}){const k=tt.PRESENTED_IMAGE_SIMPLE,u=f(!1),C=f(!1);Et().query;const L=y,o=f(""),O=f(!1),D=[{title:"创建一个电商行业售后客服"},{title:"创建一个英语教育机构官网售前机器人"}],v=f("在上方输入框输入要求，点击生成提示词"),$=()=>{x.value=!1,c.promptStruct=P,o.value="",v.value="在上方输入框输入要求，点击生成提示词",u.value=!0},x=f(!1),P={role:{subject:"",describe:""},task:{subject:"",describe:""},constraints:{subject:"",describe:""},output:{subject:"",describe:""},tone:{subject:"",describe:""},custom:[]},c=K({promptStruct:P,use_model:"",model_config_id:""}),N=p=>{o.value=p},U=()=>{if(!o.value)return H.error("请输入AI 生成提示词");if(O.value)return H.error("正在生成中...");O.value=!0,wt({demand:o.value,use_model:c.use_model,model_config_id:c.model_config_id}).then(p=>{c.promptStruct=JSON.parse(p.data.promptStruct),x.value=!0}).finally(()=>{O.value=!1}).catch(p=>{x.value=!1,v.value=p.msg})},h=p=>{Gt(()=>{var s,m,j;c.model_config_id=(s=p[0])==null?void 0:s.model_config_id,c.use_model=(j=(m=p[0])==null?void 0:m.children[0])==null?void 0:j.name})},w=()=>{if(!x.value)return H.error("请先生成提示词");L("handleAiSave",c.promptStruct),u.value=!1};return b({show:$}),(p,s)=>{const m=X,j=Ht,V=lt,B=pt,T=Tt,M=gt,q=tt,W=ot,Q=F;return r(),i("div",null,[e(Q,{open:u.value,"onUpdate:open":s[3]||(s[3]=S=>u.value=S),title:"AI 生成提示词",width:746},{footer:l(()=>[e(m,{type:"primary",loading:C.value,onClick:w},{default:l(()=>[I("使用该提示")]),_:1},8,["loading"])]),default:l(()=>[t("div",ae,[t("div",ie,[e(j,{modelType:"LLM",modeName:c.use_model,"onUpdate:modeName":s[0]||(s[0]=S=>c.use_model=S),modeId:c.model_config_id,"onUpdate:modeId":s[1]||(s[1]=S=>c.model_config_id=S),style:{width:"300px"},onLoaded:h},null,8,["modeName","modeId"])]),t("div",ce,[e(V,{style:{width:"100%"},value:o.value,"onUpdate:value":s[2]||(s[2]=S=>o.value=S),size:"large",onPressEnter:U,placeholder:"请输入AI 生成提示词例如：创建一个电商行业售后客服"},null,8,["value"]),t("div",{class:"btn-box",onClick:U},[e(B,{name:"ai-mark"}),pe])]),t("div",de,[ue,(r(),i(A,null,R(D,S=>e(T,{key:S.title,onClick:J=>N(S.title),color:"blue"},{default:l(()=>[I(a(S.title),1)]),_:2},1032,["onClick"])),64))]),t("div",_e,[e(W,{style:{height:"100%"}},{default:l(()=>[O.value?(r(),i("div",me,[e(M,{tip:"正在生成中..."})])):(r(),i(A,{key:1},[x.value?(r(),i("div",ve,[t("div",he,[t("div",fe,[t("div",be,a(c.promptStruct.role.subject),1)]),t("div",ge,a(c.promptStruct.role.describe),1)]),t("div",ye,[t("div",ke,[t("div",$e,a(c.promptStruct.task.subject),1)]),t("div",xe,a(c.promptStruct.task.describe),1)]),t("div",Se,[t("div",Ce,[t("div",Oe,a(c.promptStruct.constraints.subject),1)]),t("div",je,a(c.promptStruct.constraints.describe),1)]),t("div",Le,[t("div",we,[t("div",Ie,a(c.promptStruct.output.subject),1)]),t("div",Pe,a(c.promptStruct.output.describe),1)]),t("div",Ue,[t("div",Ae,[t("div",De,a(c.promptStruct.tone.subject),1)]),t("div",Me,a(c.promptStruct.tone.describe),1)]),(r(!0),i(A,null,R(c.promptStruct.custom,(S,J)=>(r(),i("div",{class:"prompt-list",key:J+S.key?S.key:""},[t("div",Ne,[t("div",Ee,a(S.subject),1)]),t("div",Ge,a(S.describe),1)]))),128))])):(r(),i("div",He,[e(q,{image:g(k),description:v.value},null,8,["image","description"])]))],64))]),_:1})])])]),_:1},8,["open"])])}}},Re=Z(Te,[["__scopeId","data-v-c64803b5"]]),ze=_=>(st("data-v-87e67f62"),_=_(),nt(),_),Ve={style:{flex:"1"}},Be={style:{flex:"1"}},qe={key:1,class:"prompt-list-box"},Je={class:"header-box"},Fe=ze(()=>t("div",{class:"header-left"},"提示词",-1)),We={class:"prompt-list"},Qe={class:"prompt-header"},Ye={class:"prompt-title"},Ze={class:"prompt-content"},Xe={class:"prompt-list"},Ke={class:"prompt-header"},to={class:"prompt-title"},eo={class:"prompt-content"},oo={class:"prompt-list"},so={class:"prompt-header"},no={class:"prompt-title"},lo={class:"prompt-content"},ro={class:"prompt-list"},ao={class:"prompt-header"},io={class:"prompt-title"},co={class:"prompt-content"},po={class:"prompt-list"},uo={class:"prompt-header"},_o={class:"prompt-title"},mo={class:"prompt-content"},vo={class:"prompt-header"},ho={class:"prompt-title",style:{flex:"1"}},fo={class:"btn-wrapper-box"},bo=["onClick"],go={class:"prompt-content"},yo={class:"add-theme-block"},ko={__name:"add-diy-prompt",props:{groupList:{type:Array,default:()=>[]}},emits:["ok"],setup(_,{expose:b,emit:y}){const k=y,u=_;let C={role:"请输入，告知大模型要扮演的身份、职责、沟通风格等，比如“你扮演一名经验丰富的电商行业售后客服AI助手，具备良好的沟通能力和解决问题的能力。”",task:"请输入，比如“根据提供的知识库资料，找到对应的售后知识（每个知识点之间使用⧼-split_line-⧽进行分割），快速准确回答用户的问题。”",constraints:"请输入对大模型在回复时的要求，比如“你的回答应该使用自然的对话方式，简单直接地回答，不要解释你的答案；当用户问题没有找到相关知识点时，直接告诉用户问题暂时无法回答，不能胡编乱造，否则你将受到惩罚。”",output:"请输入对大模型输出格式的要求，比如“请使用markdown格式输出”",tone:"请告知语言风格要求，比如“专业而不失亲切，适当使用emoji增强可读性”"},L={role:{subject:"",describe:""},task:{subject:"",describe:""},constraints:{subject:"",describe:""},output:{subject:"",describe:""},tone:{subject:"",describe:""},custom:[]};const o=K({id:"",title:"",group_id:0,prompt_type:0,prompt:"",prompt_struct:JSON.parse(JSON.stringify(L))}),O=f(!1),D=f(""),v=f(!1),$=f(null),x=(p={})=>{$.value&&$.value.resetFields(),o.title=p.title||"",o.group_id=p.group_id||0,o.id=p.id||"",o.prompt_type=p.prompt_type,o.prompt=p.prompt||"",o.prompt_struct=p.prompt_struct||JSON.parse(JSON.stringify(L)),D.value=`${p.id?"编辑":"新建"}${p.prompt_type==0?"自定义":"结构化"}提示词`,o.prompt_struct,v.value=!0},P=()=>{$.value.validate().then(()=>{let p={...o};o.prompt_type==0?delete p.prompt_struct:p.prompt_struct=JSON.stringify(o.prompt_struct),Pt({...p}).then(()=>{k("ok"),H.success(`${D.value}成功`),v.value=!1})})},c=f(null),N=()=>{c.value.show()},U=p=>{o.prompt_struct=p},h=()=>{o.prompt_struct.custom.push({subject:"",describe:"",key:Math.random()*1e4})},w=p=>{o.prompt_struct.custom.splice(p,1)};return b({show:x}),(p,s)=>{const m=lt,j=dt,V=yt,B=kt,T=Rt,M=_t,q=pt,W=X,Q=ut,S=ot,J=F;return r(),i("div",null,[e(J,{open:v.value,"onUpdate:open":s[8]||(s[8]=d=>v.value=d),"confirm-loading":O.value,title:D.value,width:"746px",onOk:P},{default:l(()=>[e(S,{style:{"max-height":"600px"}},{default:l(()=>[e(Q,{style:{"margin-top":"24px"},layout:"vertical",ref_key:"formRef",ref:$,model:o},{default:l(()=>[e(T,{gap:24},{default:l(()=>[t("div",Ve,[e(j,{name:"title",label:"提示词标题",rules:[{required:!0,message:"请输入提示词标题"}]},{default:l(()=>[e(m,{value:o.title,"onUpdate:value":s[0]||(s[0]=d=>o.title=d),placeholder:"请输入提示词标题",maxLength:10},null,8,["value"])]),_:1})]),t("div",Be,[e(j,{name:"group_id",label:"分组"},{default:l(()=>[e(B,{value:o.group_id,"onUpdate:value":s[1]||(s[1]=d=>o.group_id=d),style:{width:"100%"}},{default:l(()=>[(r(!0),i(A,null,R(u.groupList,d=>(r(),z(V,{value:d.id},{default:l(()=>[I(a(d.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1})])]),_:1}),o.prompt_type==0?(r(),z(j,{key:0,name:"prompt",label:"提示词",rules:[{required:!0,message:"请输入提示词"}]},{default:l(()=>[e(M,{style:{height:"280px"},value:o.prompt,"onUpdate:value":s[2]||(s[2]=d=>o.prompt=d),placeholder:"请输入"},null,8,["value"])]),_:1})):(r(),i("div",qe,[t("div",Je,[Fe,t("div",{class:"ai-mark-box",onClick:N},[e(q,{name:"ai-mark"}),I(" AI自动生成 ")])]),t("div",We,[t("div",Qe,[t("div",Ye,a(o.prompt_struct.role.subject),1)]),t("div",Ze,[e(M,{style:{height:"80px"},bordered:!1,value:o.prompt_struct.role.describe,"onUpdate:value":s[3]||(s[3]=d=>o.prompt_struct.role.describe=d),placeholder:g(C).role},null,8,["value","placeholder"])])]),t("div",Xe,[t("div",Ke,[t("div",to,a(o.prompt_struct.task.subject),1)]),t("div",eo,[e(M,{style:{height:"80px"},bordered:!1,value:o.prompt_struct.task.describe,"onUpdate:value":s[4]||(s[4]=d=>o.prompt_struct.task.describe=d),placeholder:g(C).task},null,8,["value","placeholder"])])]),t("div",oo,[t("div",so,[t("div",no,a(o.prompt_struct.constraints.subject),1)]),t("div",lo,[e(M,{style:{height:"80px"},bordered:!1,value:o.prompt_struct.constraints.describe,"onUpdate:value":s[5]||(s[5]=d=>o.prompt_struct.constraints.describe=d),placeholder:g(C).constraints},null,8,["value","placeholder"])])]),t("div",ro,[t("div",ao,[t("div",io,a(o.prompt_struct.output.subject),1)]),t("div",co,[e(M,{style:{height:"80px"},bordered:!1,value:o.prompt_struct.output.describe,"onUpdate:value":s[6]||(s[6]=d=>o.prompt_struct.output.describe=d),placeholder:g(C).output},null,8,["value","placeholder"])])]),t("div",po,[t("div",uo,[t("div",_o,a(o.prompt_struct.tone.subject),1)]),t("div",mo,[e(M,{style:{height:"80px"},bordered:!1,value:o.prompt_struct.tone.describe,"onUpdate:value":s[7]||(s[7]=d=>o.prompt_struct.tone.describe=d),placeholder:g(C).tone},null,8,["value","placeholder"])])]),(r(!0),i(A,null,R(o.prompt_struct.custom,(d,Y)=>(r(),i("div",{class:"prompt-list",key:Y+d.key?d.key:""},[t("div",vo,[t("div",ho,[e(m,{bordered:!1,style:{width:"100%"},value:d.subject,"onUpdate:value":n=>d.subject=n,placeholder:"请输入主题"},null,8,["value","onUpdate:value"])]),t("div",fo,[t("div",{class:"hover-btn-box",onClick:n=>w(Y)},[e(g(It))],8,bo)])]),t("div",go,[e(M,{style:{height:"80px"},bordered:!1,value:d.describe,"onUpdate:value":n=>d.describe=n,placeholder:"请输入"},null,8,["value","onUpdate:value"])])]))),128)),t("div",yo,[e(W,{onClick:h,block:"",icon:et(g(rt))},{default:l(()=>[I("添加主题")]),_:1},8,["icon"])])]))]),_:1},8,["model"])]),_:1})]),_:1},8,["open","confirm-loading","title"]),e(Re,{onHandleAiSave:U,ref_key:"aiCreatePromptRef",ref:c},null,512)])}}},$o=Z(ko,[["__scopeId","data-v-87e67f62"]]),xt=_=>(st("data-v-14e56f4b"),_=_(),nt(),_),xo={class:"user-model-page"},So={class:"page-title"},Co=xt(()=>t("div",{class:"desc"}," 添加提示词模板，在应用配置和工作流的AI对话节点，可以从提示词模板库选择提示词并应用 ",-1)),Oo={class:"list-wrapper"},jo={class:"left-group"},Lo={class:"right-cotnetn"},wo={class:"content-box"},Io={class:"btn-block"},Po={key:0,class:"loading-box"},Uo={class:"prompt-list-box"},Ao={class:"prompt-header"},Do={class:"prompt-title"},Mo={key:0,class:"prompt-type diy"},No={key:1,class:"prompt-type"},Eo={class:"title"},Go={class:"right-btn-box"},Ho=["onClick"],To=["onClick"],Ro={class:"hover-btn-box"},zo=["onClick"],Vo=["onClick"],Bo={class:"prompt-content-box"},qo={key:0,class:"prompt-content"},Jo=["onClick"],Fo={key:1,class:"structure-list-box"},Wo={class:"structure-list"},Qo={class:"structure-title"},Yo={class:"structure-content"},Zo={class:"structure-list"},Xo={class:"structure-title"},Ko={class:"structure-content"},ts=["onClick"],es={class:"structure-list"},os={class:"structure-title"},ss={class:"structure-content"},ns={class:"structure-list"},ls={class:"structure-title"},rs={class:"structure-content"},as={class:"structure-list"},is={class:"structure-title"},cs={class:"structure-content"},ps={class:"structure-title"},ds={class:"structure-content"},us={class:"move-group-box"},_s=xt(()=>t("div",{class:"label-text"},"修改分组为",-1)),ms={__name:"index",setup(_){let b=-1;const y=s=>{b=s.id,o()};let k=f([]);const u=s=>{k.value=s.filter(m=>m.id>=0)},C=f([]),L=f(!1),o=()=>{L.value=!0,Ut({group_id:b,page:1,size:9999}).then(s=>{let m=s.data.list||[];m=m.map(j=>({...j,isHide:!0,prompt_struct:j.prompt_struct?JSON.parse(j.prompt_struct):{}})),C.value=m}).finally(()=>{L.value=!1})};o();const O=f(null),D=s=>{O.value.show({group_id:b==-1?0:b,prompt_type:s})},v=s=>{O.value.show({...s})};function $(s){var m;return(m=k.value.filter(j=>j.id==s)[0])==null?void 0:m.group_name}const x=s=>{s.isHide=!s.isHide},P=f(!0),c=()=>{P.value=!P.value,C.value=C.value.map(s=>({...s,isHide:P.value}))},N=s=>{F.confirm({title:"删除确认",icon:e(ct),content:`确定要删除提示词[${s.title}]吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk(){Dt({id:s.id}).then(m=>{H.success("删除成功"),o()})},onCancel(){}})},U=f(!1);let h=K({id:"",group_id:0});const w=s=>{s={...s},h.id=s.id,h.group_id=s.group_id>0?s.group_id:0,U.value=!0},p=()=>{if(h.id<0)return H.error("请选择要移动的分组");At({id:h.id,group_id:h.group_id}).then(()=>{H.success("移动成功"),U.value=!1,o()})};return(s,m)=>{const j=qt,V=ot,B=X,T=vt,M=ht,q=ft,W=gt,Q=bt,S=tt,J=yt,d=kt,Y=F;return r(),i("div",xo,[t("div",So,[I(" 提示词模板库 "),e(j,{type:"vertical"}),Co]),t("div",Oo,[t("div",jo,[e(V,null,{default:l(()=>[e(re,{onChange:y,onLoad:u})]),_:1})]),t("div",Lo,[e(V,null,{default:l(()=>[t("div",wo,[t("div",Io,[e(q,null,{overlay:l(()=>[e(M,null,{default:l(()=>[e(T,null,{default:l(()=>[t("div",{onClick:m[0]||(m[0]=n=>D(1))},"添加结构化提示词")]),_:1}),e(T,null,{default:l(()=>[t("div",{onClick:m[1]||(m[1]=n=>D(0))},"添加自定义提示词")]),_:1})]),_:1})]),default:l(()=>[e(B,{type:"primary",icon:e(g(rt))},{default:l(()=>[I("提示词")]),_:1},8,["icon"])]),_:1}),e(B,{onClick:c,icon:e(g(Qt))},{default:l(()=>[I(a(P.value?"全部展开":"全部收起"),1)]),_:1},8,["icon"])]),L.value?(r(),i("div",Po,[e(W)])):G("",!0),t("div",Uo,[(r(!0),i(A,null,R(C.value,n=>(r(),i("div",{class:"prompt-list",key:n.id},[t("div",Ao,[t("div",Do,[n.prompt_type==0?(r(),i("div",Mo,"自定义")):G("",!0),n.prompt_type==1?(r(),i("div",No,"结构化")):G("",!0),t("div",Eo,a(n.title),1),e(j,{type:"vertical"}),t("div",null,a($(n.group_id)),1)]),t("div",Go,[e(Q,{title:n.isHide?"展开":"收起"},{default:l(()=>[t("div",{class:"hover-btn-box",onClick:E=>x(n)},[n.isHide?(r(),z(g(zt),{key:0})):(r(),z(g(Vt),{key:1}))],8,Ho)]),_:2},1032,["title"]),t("div",{class:"hover-btn-box",onClick:E=>v(n)},[e(g(Bt))],8,To),e(q,null,{overlay:l(()=>[e(M,null,{default:l(()=>[e(T,null,{default:l(()=>[t("div",{onClick:E=>N(n)},"删除",8,zo)]),_:2},1024),e(T,null,{default:l(()=>[t("div",{onClick:E=>w(n)},"修改分组",8,Vo)]),_:2},1024)]),_:2},1024)]),default:l(()=>[t("div",Ro,[e(g(mt))])]),_:2},1024)])]),t("div",Bo,[n.prompt_type==0?(r(),i("div",qo,[n.isHide?(r(),i(A,{key:0},[I(a(n.prompt.slice(0,200))+" ",1),n.prompt.length>200?(r(),i("span",{key:0,onClick:E=>x(n),style:{cursor:"pointer"}},"...",8,Jo)):G("",!0)],64)):(r(),i(A,{key:1},[I(a(n.prompt),1)],64))])):(r(),i("div",Fo,[t("div",Wo,[t("div",Qo,a(n.prompt_struct.role.subject),1),t("div",Yo,a(n.prompt_struct.role.describe),1)]),t("div",Zo,[t("div",Xo,a(n.prompt_struct.task.subject),1),t("div",Ko,[I(a(n.prompt_struct.task.describe)+" ",1),n.isHide?(r(),i("span",{key:0,onClick:E=>x(n),style:{cursor:"pointer"}},"...",8,ts)):G("",!0)])]),n.isHide?G("",!0):(r(),i(A,{key:0},[t("div",es,[t("div",os,a(n.prompt_struct.constraints.subject),1),t("div",ss,a(n.prompt_struct.constraints.describe),1)]),t("div",ns,[t("div",ls,a(n.prompt_struct.output.subject),1),t("div",rs,a(n.prompt_struct.output.describe),1)]),t("div",as,[t("div",is,a(n.prompt_struct.tone.subject),1),t("div",cs,a(n.prompt_struct.tone.describe),1)]),(r(!0),i(A,null,R(n.prompt_struct.custom,E=>(r(),i("div",{class:"structure-list",key:E.subject},[t("div",ps,a(E.subject),1),t("div",ds,a(E.describe),1)]))),128))],64))]))])]))),128))])]),C.value.length==0?(r(),z(S,{key:0,style:{"padding-top":"100px"}})):G("",!0)]),_:1})])]),e($o,{groupList:g(k),onOk:o,ref_key:"addDiyPromptRef",ref:O},null,8,["groupList"]),e(Y,{open:U.value,"onUpdate:open":m[3]||(m[3]=n=>U.value=n),title:"修改分组",onOk:p},{default:l(()=>[t("div",us,[_s,e(d,{value:g(h).group_id,"onUpdate:value":m[2]||(m[2]=n=>g(h).group_id=n),style:{width:"100%"}},{default:l(()=>[(r(!0),i(A,null,R(g(k),n=>(r(),z(J,{value:n.id},{default:l(()=>[I(a(n.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])]),_:1},8,["open"])])}}},pn=Z(ms,[["__scopeId","data-v-14e56f4b"]]);export{pn as default};
