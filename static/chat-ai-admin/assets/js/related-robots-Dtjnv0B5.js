import{_ as P}from"./cu-scroll-D0dESsq_.js";import{_ as V}from"./empty-DkpCLaix.js";import{e as p,Q as w,N as n,S as u,M as d,a7 as A,W as e,k as m,Z as v,F as $,a0 as x,u as E,a4 as D,x as F,B as O,Y as j,a1 as q,a2 as G}from"./vue-chunks-DKljrDvA.js";import{b as N,ao as B,f as K,M as Q,h as W,di as Y,B as Z,dj as z,k as H}from"../../index-G9f-mAi5.js";import{C as J,_ as X}from"./index-BuE78FY1.js";import{g as tt}from"./index-C9szxrK8.js";import{P as et}from"./PlusOutlined-7esb8SyJ.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-BZ84_VUH.js";import"./qs-DB0tj3pA.js";import"./crypto-js-fJpLWOEv.js";import"./dayjs-BpZi_McX.js";import"./Checkbox-CnXf9eOC.js";import"./FormItemContext-BeRgkpjf.js";import"./index-nYxAdijE.js";const ot={key:0,class:"form-wrapper"},st={class:"select"},at={class:"tools-wrapper"},lt=["src"],nt={class:"item-name"},it={key:1,class:"form-wrapper"},rt={class:"select"},ct={class:"tools-wrapper"},dt={class:"item-name"},_t={key:2,class:"form-wrapper"},ut={class:"select"},vt={class:"tools-wrapper"},pt={class:"item-name"},mt={key:3,class:"empty-box"},ft={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null},currentTitle:{type:String,default:"关联机器人"}},emits:["save"],setup(f,{expose:L,emit:g}){const k=B.PRESENTED_IMAGE_SIMPLE,C=g,b=f,o=p([]),c=p(""),{t:S}=K(),h=p(!1),_=p([]),y=r=>{const t=[];return r.map(l=>{t.push(l.id)}),t},I=(r,t,l)=>{o.value=[],c.value=r,c.value==="robot"?(_.value=b.robotList,t&&t==="edit"&&l&&(o.value=y(l.managed_robot_list))):c.value==="library"?(_.value=b.libraryList,t&&t==="edit"&&l&&(o.value=y(l.managed_library_list))):c.value==="form"&&(_.value=b.formList,t&&t==="edit"&&l&&(o.value=y(l.managed_form_list))),h.value=!0},R=()=>{h.value=!1,_.value.length&&C("save",o.value)},i=()=>{};return L({open:I}),(r,t)=>{const l=J,a=X,M=B,U=Q;return n(),w(U,{class:"add-model-alert",width:"800px",open:h.value,"onUpdate:open":t[3]||(t[3]=s=>h.value=s),title:f.currentTitle,onOk:R,onCancel:i},{default:u(()=>[c.value==="robot"?(n(),d("div",ot,[e("div",st," 已选择("+v(o.value.length)+") ",1),m(a,{class:"list-box",value:o.value,"onUpdate:value":t[0]||(t[0]=s=>o.value=s)},{default:u(()=>[(n(!0),d($,null,x(_.value,s=>(n(),w(l,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",at,[e("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,lt),e("div",nt,v(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="library"?(n(),d("div",it,[e("div",rt," 已选择("+v(o.value.length)+") ",1),m(a,{class:"list-box",value:o.value,"onUpdate:value":t[1]||(t[1]=s=>o.value=s)},{default:u(()=>[(n(!0),d($,null,x(_.value,s=>(n(),w(l,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",ct,[e("div",dt,v(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="form"?(n(),d("div",_t,[e("div",ut," 已选择("+v(o.value.length)+") ",1),m(a,{class:"list-box",value:o.value,"onUpdate:value":t[2]||(t[2]=s=>o.value=s)},{default:u(()=>[(n(!0),d($,null,x(_.value,s=>(n(),w(l,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",vt,[e("div",pt,v(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):A("",!0),_.value.length?A("",!0):(n(),d("div",mt,[m(M,{image:E(k)},null,8,["image"])]))]),_:1},8,["open","title"])}}},bt=N(ft,[["__scopeId","data-v-a5d4de58"]]),T=f=>(q("data-v-bd91d8b6"),f=f(),G(),f),ht={class:"robot-page"},yt={class:"associated-robot"},gt={class:"associated-robot-title"},kt={class:"list-box"},wt=["onClick"],$t={class:"list-item"},xt={class:"robot-info"},Lt=["src"],St={class:"robot-info-content"},It={class:"robot-name"},Rt={class:"robot-type-tag"},At={class:"robot-desc"},Ct={key:0,class:"empty-box"},Mt=T(()=>e("img",{src:V,alt:""},null,-1)),Bt=T(()=>e("div",{class:"title"},"暂无数据",-1)),Et=[Mt,Bt],Nt={__name:"related-robots",setup(f){const L=W(),g=p(null),k=p([]),b=D().query,o=p([]),c=p(!1),S=()=>{c.value=!0,Y({id:b.id}).then(i=>{o.value=i.data||[],L.setRobotNums(o.value.length)}).finally(()=>{c.value=!1})};F(()=>{S()}),O({managed_robot_list:[]});const h=async()=>{await y(),g.value.open("robot")},_=(i,r)=>{const t=new Set(r.map(a=>a.id));return i.filter(a=>a.application_type==="0").filter(a=>!t.has(a.id))},y=async()=>{await tt().then(i=>{k.value=_(i.data,o.value)}).catch(()=>{})},I=i=>{let r={library_id:b.id,robot_ids:i.join(",")};z(r).then(t=>{H.success("操作成功"),S()}).catch(()=>{})},R=({id:i,robot_key:r,application_type:t})=>{t==0?window.open(`#/robot/config/basic-config?id=${i}&robot_key=${r}`):window.open(`#/robot/config/workflow?id=${i}&robot_key=${r}`)};return(i,r)=>{const t=Z,l=P;return n(),d("div",ht,[m(l,null,{default:u(()=>[e("div",yt,[e("div",gt,"已关联机器人 ("+v(o.value.length)+")",1),m(t,{type:"primary",onClick:h},{icon:u(()=>[m(E(et))]),default:u(()=>[j(" 关联机器人 ")]),_:1})]),e("div",kt,[(n(!0),d($,null,x(o.value,a=>(n(),d("div",{class:"list-item-wrapper",key:a.id,onClick:M=>R(a)},[e("div",$t,[e("div",xt,[e("img",{class:"robot-avatar",src:a.robot_avatar,alt:""},null,8,Lt),e("div",St,[e("div",It,v(a.robot_name),1),e("div",Rt,v(a.application_type==0?"聊天机器人":"工作流"),1)])]),e("div",At,v(a.robot_intro),1)])],8,wt))),128))]),o.value.length==0&&!c.value?(n(),d("div",Ct,Et)):A("",!0)]),_:1}),m(bt,{ref_key:"seeModelAlertRef",ref:g,currentTitle:"关联机器人",robotList:k.value,onSave:I},null,8,["robotList"])])}}},Ht=N(Nt,[["__scopeId","data-v-bd91d8b6"]]);export{Ht as default};
