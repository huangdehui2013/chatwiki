import{C as U}from"./cu-scroll-8SQNC6_m.js";import{_ as P}from"./empty-DkpCLaix.js";import{e as v,M as n,Q as $,S as u,N as c,W as e,Z as _,k as p,F as w,$ as x,a7 as R,u as E,a5 as V,x as D,B as F,Y as O,a1 as q,a2 as Z}from"./vue-chunks-DkYK5AuX.js";import{b as N,Z as B,h as j,M as G,f as K,db as Q,dc as W,k as Y,B as z}from"../../index-CuFzRDH0.js";import{C as H,_ as J}from"./index-CvnBYLiG.js";import{g as X}from"./index-aParrWES.js";import{P as tt}from"./PlusOutlined-C1-JNsax.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-g-qVsYXK.js";import"./crypto-js-CsNcoEfj.js";import"./dayjs-CHX5mXCJ.js";import"./Checkbox-CHV8yuJS.js";import"./FormItemContext-CG4o3aCY.js";import"./index-DncdWYWk.js";const et={key:0,class:"form-wrapper"},ot={class:"select"},st={class:"tools-wrapper"},at=["src"],lt={class:"item-name"},nt={key:1,class:"form-wrapper"},it={class:"select"},rt={class:"tools-wrapper"},ct={class:"item-name"},dt={key:2,class:"form-wrapper"},ut={class:"select"},_t={class:"tools-wrapper"},vt={class:"item-name"},pt={key:3,class:"empty-box"},mt={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null},currentTitle:{type:String,default:"关联机器人"}},emits:["save"],setup(m,{expose:L,emit:g}){const k=B.PRESENTED_IMAGE_SIMPLE,A=g,b=m,o=v([]),r=v("");j();const f=v(!1),d=v([]),y=l=>{const t=[];return l.map(a=>{t.push(a.id)}),t},S=(l,t,a)=>{o.value=[],r.value=l,r.value==="robot"?(d.value=b.robotList,t&&t==="edit"&&a&&(o.value=y(a.managed_robot_list))):r.value==="library"?(d.value=b.libraryList,t&&t==="edit"&&a&&(o.value=y(a.managed_library_list))):r.value==="form"&&(d.value=b.formList,t&&t==="edit"&&a&&(o.value=y(a.managed_form_list))),f.value=!0},I=()=>{f.value=!1,d.value.length&&A("save",o.value)},C=()=>{};return L({open:S}),(l,t)=>{const a=H,h=J,i=B,M=G;return n(),$(M,{class:"add-model-alert",width:"800px",open:f.value,"onUpdate:open":t[3]||(t[3]=s=>f.value=s),title:m.currentTitle,onOk:I,onCancel:C},{default:u(()=>[r.value==="robot"?(n(),c("div",et,[e("div",ot," 已选择("+_(o.value.length)+") ",1),p(h,{class:"list-box",value:o.value,"onUpdate:value":t[0]||(t[0]=s=>o.value=s)},{default:u(()=>[(n(!0),c(w,null,x(d.value,s=>(n(),$(a,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",st,[e("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,at),e("div",lt,_(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):r.value==="library"?(n(),c("div",nt,[e("div",it," 已选择("+_(o.value.length)+") ",1),p(h,{class:"list-box",value:o.value,"onUpdate:value":t[1]||(t[1]=s=>o.value=s)},{default:u(()=>[(n(!0),c(w,null,x(d.value,s=>(n(),$(a,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",rt,[e("div",ct,_(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):r.value==="form"?(n(),c("div",dt,[e("div",ut," 已选择("+_(o.value.length)+") ",1),p(h,{class:"list-box",value:o.value,"onUpdate:value":t[2]||(t[2]=s=>o.value=s)},{default:u(()=>[(n(!0),c(w,null,x(d.value,s=>(n(),$(a,{class:"list-item",key:s.id,value:s.id},{default:u(()=>[e("div",_t,[e("div",vt,_(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):R("",!0),d.value.length?R("",!0):(n(),c("div",pt,[p(i,{image:E(k)},null,8,["image"])]))]),_:1},8,["open","title"])}}},ft=N(mt,[["__scopeId","data-v-a5d4de58"]]),T=m=>(q("data-v-bd91d8b6"),m=m(),Z(),m),bt={class:"robot-page"},ht={class:"associated-robot"},yt={class:"associated-robot-title"},gt={class:"list-box"},kt=["onClick"],$t={class:"list-item"},wt={class:"robot-info"},xt=["src"],Lt={class:"robot-info-content"},St={class:"robot-name"},It={class:"robot-type-tag"},Ct={class:"robot-desc"},Rt={key:0,class:"empty-box"},At=T(()=>e("img",{src:P,alt:""},null,-1)),Mt=T(()=>e("div",{class:"title"},"暂无数据",-1)),Bt=[At,Mt],Et={__name:"related-robots",setup(m){const L=K(),g=v(null),k=v([]),b=V().query,o=v([]),r=v(!1),f=()=>{r.value=!0,Q({id:b.id}).then(l=>{o.value=l.data||[],L.setRobotNums(o.value.length)}).finally(()=>{r.value=!1})};D(()=>{f()}),F({managed_robot_list:[]});const d=async()=>{await S(),g.value.open("robot")},y=(l,t)=>{const a=new Set(t.map(i=>i.id));return l.filter(i=>i.application_type==="0").filter(i=>!a.has(i.id))},S=async()=>{await X().then(l=>{k.value=y(l.data,o.value)}).catch(()=>{})},I=l=>{let t={library_id:b.id,robot_ids:l.join(",")};W(t).then(a=>{Y.success("操作成功"),f()}).catch(()=>{})},C=({id:l,robot_key:t,application_type:a})=>{a==0?window.open(`#/robot/config/basic-config?id=${l}&robot_key=${t}`):window.open(`#/robot/config/workflow?id=${l}&robot_key=${t}`)};return(l,t)=>{const a=z,h=U;return n(),c("div",bt,[p(h,null,{default:u(()=>[e("div",ht,[e("div",yt,"已关联机器人 ("+_(o.value.length)+")",1),p(a,{type:"primary",onClick:d},{icon:u(()=>[p(E(tt))]),default:u(()=>[O(" 关联机器人 ")]),_:1})]),e("div",gt,[(n(!0),c(w,null,x(o.value,i=>(n(),c("div",{class:"list-item-wrapper",key:i.id,onClick:M=>C(i)},[e("div",$t,[e("div",wt,[e("img",{class:"robot-avatar",src:i.robot_avatar,alt:""},null,8,xt),e("div",Lt,[e("div",St,_(i.robot_name),1),e("div",It,_(i.application_type==0?"聊天机器人":"工作流"),1)])]),e("div",Ct,_(i.robot_intro),1)])],8,kt))),128))]),o.value.length==0&&!r.value?(n(),c("div",Rt,Bt)):R("",!0)]),_:1}),p(ft,{ref_key:"seeModelAlertRef",ref:g,currentTitle:"关联机器人",robotList:k.value,onSave:I},null,8,["robotList"])])}}},zt=N(Et,[["__scopeId","data-v-bd91d8b6"]]);export{zt as default};
